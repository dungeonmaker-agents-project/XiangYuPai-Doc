# 🌳 粉丝与关注页 结构指导文档

> **页面名称：** 粉丝与关注页
> **所属模块：** User (用户模块)
> **页面类型：** 列表页（带Tab切换 + 搜索功能）

---

## 📋 STEP 1: 页面数据模型

### 设计理念

```
页面功能：展示用户的关注列表和粉丝列表，支持Tab切换、搜索和关注/取消关注操作
数据流向：
┌─────────────────────────────────────────────────────────────────┐
│  进入页面 → [API:getFollowList] → 渲染列表                        │
│  Tab切换 → [API:getFollowList(type)] → 替换列表                   │
│  搜索 → [API:searchUser] → 显示搜索结果                           │
│  关注操作 → [API:toggleFollow] → 更新按钮状态                     │
└─────────────────────────────────────────────────────────────────┘
```

### PageModel

```json
{
  "模型信息": {
    "页面名称": "粉丝与关注页",
    "页面标识": "FollowFansPage",
    "所属模块": "User",
    "页面类型": "列表页"
  },

  "数据依赖图": "{TabData} + {ListData} → 渲染页面 → 用户操作 → {ActionResult}",

  "PageModel": {
    "_说明": "页面级数据模型 [L1]",

    "HeaderData": {
      "_说明": "头部导航数据 → [→HeaderArea]",
      "showBack": "Boolean - 是否显示返回按钮 - [UI:HeaderArea.返回按钮] - 固定true"
    },

    "TabData": {
      "_说明": "Tab切换数据 → [→TabArea]",
      "tabs": "Array<TabItem> - Tab列表 - [UI:TabArea]",
      "currentTab": "String(following|fans) - 当前选中Tab - [状态:控制列表筛选]"
    },

    "ListData": {
      "_说明": "用户列表数据 → [→ContentArea]",
      "list": "Array<UserItem> - 用户列表 - [UI:ContentArea]",
      "hasMore": "Boolean - 是否有更多 - [控制:加载更多/到底提示]",
      "total": "Number? - 总数 - [可选]"
    },

    "SearchData": {
      "_说明": "搜索相关数据 → [→SearchArea]",
      "isSearchMode": "Boolean - 是否搜索模式 - [状态:控制显示搜索区域]",
      "keyword": "String - 搜索关键词 - [UI:SearchArea.输入框]",
      "searchResults": "Array<UserItem> - 搜索结果 - [UI:SearchArea.结果列表]"
    },

    "PageState": {
      "_说明": "页面状态数据",
      "isLoading": "Boolean - 加载中 - [状态:骨架屏/Loading]",
      "isRefreshing": "Boolean - 刷新中 - [状态:下拉刷新指示器]",
      "isSearching": "Boolean - 搜索中 - [状态:搜索Loading]",
      "isEmpty": "Boolean - 列表为空 - [状态:空状态]",
      "isError": "Boolean - 加载失败 - [状态:错误提示]",
      "errorMessage": "String? - 错误信息 - [UI:错误提示文案]"
    }
  }
}
```

### AreaModel

```json
{
  "AreaModel": {
    "_说明": "区域级数据模型 [L2]",

    "TabArea": {
      "tabs": "Array<TabItem> - Tab列表",
      "TabItem": {
        "key": "String(following|fans) - Tab标识 - [用于:筛选参数]",
        "label": "String - Tab文案 - [UI:Tab.文字] - 关注/粉丝",
        "isActive": "Boolean - 是否选中 - [状态:选中样式-紫色+下划线]"
      }
    },

    "SearchArea": {
      "placeholder": "String - 搜索提示文案 - [UI:搜索框.占位符] - '搜索用户名称'",
      "keyword": "String - 搜索关键词 - [UI:搜索框.输入值]",
      "showCancel": "Boolean - 显示取消按钮 - [UI:取消按钮] - 固定true"
    },

    "ContentArea": {
      "list": "Array<UserItem> - 用户列表",
      "layoutType": "String(list) - 布局类型 - 垂直列表"
    }
  }
}
```

### ItemModel

```json
{
  "ItemModel": {
    "_说明": "列表项数据模型 [L3]",

    "UserItem": {
      "_说明": "用户卡片数据 → [→UserItemComponent]",

      "userId": "String - 用户ID - [用于:跳转用户主页、操作参数]",

      "avatarData": {
        "_说明": "头像区域 → [→UserItem.头像区]",
        "avatarUrl": "String - 头像URL - [UI:卡片.头像] [样式:80x80圆形]"
      },

      "basicInfo": {
        "_说明": "基础信息区域 → [→UserItem.信息区]",
        "nickname": "String - 昵称 - [UI:卡片.昵称] [样式:16sp#333333粗体]",
        "gender": "String(male|female) - 性别 - [UI:卡片.性别图标] [male=♂蓝色,female=♀粉色]",
        "age": "Number - 年龄 - [UI:卡片.年龄] [格式:与性别组合显示]",
        "isVerified": "Boolean - 是否实名认证 - [UI:卡片.认证标签] [条件:true时显示'实名认证'标签]",
        "signature": "String? - 个性签名 - [UI:卡片.签名] [可选] [样式:14sp#999999,单行省略]"
      },

      "relationData": {
        "_说明": "关系状态 → [→UserItem.操作区]",
        "relationStatus": "String(none|following|followed|mutual) - 关系状态",
        "_statusMap": {
          "none": "未关注 - [UI:关注按钮-紫色实心'关注']",
          "following": "已关注对方 - [UI:已关注按钮-淡紫色'已关注']",
          "followed": "对方关注我 - [UI:关注按钮-紫色实心'关注']",
          "mutual": "互相关注 - [UI:互关按钮-淡紫色边框'互相关注']"
        }
      }
    }
  }
}
```

### SharedModel

```json
{
  "SharedModel": {
    "_说明": "跨页面复用的数据模型 [L4]",

    "PaginationInfo": {
      "_说明": "分页信息",
      "page": "Number - 当前页码 - 默认1",
      "pageSize": "Number - 每页数量 - 默认20",
      "hasMore": "Boolean - 是否有更多",
      "total": "Number? - 总数"
    },

    "ActionResult": {
      "_说明": "操作结果",
      "success": "Boolean - 是否成功",
      "message": "String? - 提示信息",
      "newRelationStatus": "String? - 新的关系状态"
    }
  }
}
```

### 数据模型汇总表

| 模型名 | 层级 | 对应组件 | 说明 |
|--------|------|----------|------|
| PageModel | L1 | FollowFansPage | 页面级数据，组合所有区域数据 |
| TabData | L2 | TabArea | Tab切换数据 |
| ListData | L2 | ContentArea | 用户列表数据 |
| SearchData | L2 | SearchArea | 搜索相关数据 |
| UserItem | L3 | UserItemComponent | 单个用户卡片数据 |
| PaginationInfo | L4 | - | 分页信息（复用） |
| ActionResult | L4 | - | 操作结果（复用） |

---

## 🔄 STEP 2: 流程图

### 页面初始化流程

```
开始
 ↓
【进入粉丝与关注页】
 ├─→ 路由跳转: /user/follow-fans
 ├─→ 传入参数: { initialTab?: 'following' | 'fans' }
 └─→ 默认Tab: following（关注）
 ↓
【页面初始化】
 │
 ├─→ 设置当前Tab [状态:TabArea]
 │    └─→ currentTab = initialTab || 'following'
 │
 └─→ 调用 [API:getFollowList] (type=currentTab, page=1)
      ├─→ 显示Loading [状态:ContentArea]
      ├─→ 成功 → 渲染 [→ContentArea] 用户列表
      └─→ 失败 → 显示错误提示 → 点击重试
 ↓
用户操作
 │
 ├─→ 【TabArea Tab切换】
 │    └─→ 点击{TabItem} [触发:TabArea]
 │         ├─→ 更新选中态 [状态:TabArea]
 │         ├─→ 清空列表 [状态:ContentArea]
 │         ├─→ 调用 [API:getFollowList] (type={tabKey}, page=1)
 │         └─→ 替换内容 [状态:ContentArea]
 │
 ├─→ 【ContentArea 列表交互】
 │    │
 │    ├─→ 下拉刷新 [触发:ContentArea]
 │    │    ├─→ 调用 [API:getFollowList] (type=currentTab, page=1)
 │    │    └─→ 清空重置 [状态:ContentArea]
 │    │
 │    ├─→ 上拉加载 [触发:ContentArea]
 │    │    ├─→ 调用 [API:getFollowList] (type=currentTab, page+1)
 │    │    └─→ 追加数据 [状态:ContentArea]
 │    │
 │    └─→ 滚动浏览 → 图片懒加载
 │
 ├─→ 【UserItem 单项操作】
 │    │
 │    ├─→ 点击用户卡片 [触发:UserItem]
 │    │    └─→ 跳转 → 【用户主页】(携带 userId)
 │    │
 │    └─→ 点击关注/取关按钮 [触发:UserItem.ActionButton]
 │         ├─→ 乐观更新 [状态:UserItem.relationStatus]
 │         ├─→ 调用 [API:toggleFollow] (targetUserId, action)
 │         ├─→ 成功 → 保持状态
 │         └─→ 失败 → 回滚状态 + Toast提示
 │
 ├─→ 【HeaderArea 搜索入口】
 │    └─→ 点击搜索图标 [触发:HeaderArea]
 │         └─→ 进入搜索模式 [状态:isSearchMode=true]
 │              └─→ 显示 [→SearchArea]
 │
 ├─→ 【SearchArea 搜索交互】
 │    │
 │    ├─→ 输入关键词 [触发:SearchArea.输入框]
 │    │    ├─→ 实时更新 keyword
 │    │    ├─→ 防抖300ms后调用 [API:searchUser]
 │    │    └─→ 显示搜索结果 [状态:SearchArea]
 │    │
 │    └─→ 点击取消 [触发:SearchArea.取消按钮]
 │         └─→ 退出搜索模式 [状态:isSearchMode=false]
 │              └─→ 恢复列表显示
 │
 └─→ 【HeaderArea 导航返回】
      └─→ 点击返回 [触发:HeaderArea]
           └─→ 返回上一页
 ↓
【状态管理】 [状态:ContentArea]
 ├─→ isLoading && page=1 → 显示骨架屏
 ├─→ isLoading && page>1 → 显示底部Loading
 ├─→ isSearching → 显示搜索Loading
 ├─→ isError → 显示错误提示 → 点击重试
 ├─→ list.length=0 → 显示空状态
 └─→ hasMore=false → 显示"没有更多啦~"
 ↓
结束
```

### 搜索流程详情

```
【搜索模式】
 │
 ├─→ 进入搜索 [触发:HeaderArea.搜索图标]
 │    ├─→ 隐藏 TabArea
 │    ├─→ 隐藏 ContentArea（列表）
 │    └─→ 显示 SearchArea
 │
 ├─→ 输入搜索 [触发:SearchArea.输入框]
 │    ├─→ keyword为空 → 显示空白区域（带占位符）
 │    └─→ keyword不为空 → 防抖后调用 [API:searchUser]
 │         ├─→ 显示搜索Loading
 │         ├─→ 成功 → 显示搜索结果列表
 │         └─→ 无结果 → 显示"未找到相关用户"
 │
 └─→ 退出搜索 [触发:SearchArea.取消按钮]
      ├─→ 清空搜索关键词
      ├─→ 清空搜索结果
      ├─→ 隐藏 SearchArea
      └─→ 恢复 TabArea + ContentArea
```

### 关注操作状态流转

```
关注按钮状态流转：

【关注Tab下】
 ├─→ 已关注 (following)
 │    └─→ 点击 → [API:toggleFollow(unfollow)] → 从列表移除
 │
 └─→ 互相关注 (mutual)
      └─→ 点击 → [API:toggleFollow(unfollow)] → 从列表移除

【粉丝Tab下】
 ├─→ 关注 (followed - 对方关注我，我未关注)
 │    └─→ 点击 → [API:toggleFollow(follow)] → 变为"互相关注"
 │
 ├─→ 互相关注 (mutual)
 │    └─→ 点击 → [API:toggleFollow(unfollow)] → 变为"关注"
 │
 └─→ 已关注 (following - 在粉丝列表看到我关注的人)
      └─→ 点击 → [API:toggleFollow(unfollow)] → 变为"关注"
```

### 流程-组件关联表

| 流程节点 | 触发组件 | 调用接口 | 影响组件 | 状态变化 |
|----------|----------|----------|----------|----------|
| 页面初始化 | - | getFollowList | TabArea, ContentArea | loading→loaded |
| Tab切换 | TabArea | getFollowList(type) | TabArea, ContentArea | 内容替换 |
| 下拉刷新 | ContentArea | getFollowList(page=1) | ContentArea | refreshing→loaded |
| 上拉加载 | ContentArea | getFollowList(page+1) | ContentArea | loadingMore→loaded |
| 点击用户 | UserItem | - | - | 跳转用户主页 |
| 关注/取关 | UserItem | toggleFollow | UserItem | 关系状态切换 |
| 进入搜索 | HeaderArea | - | SearchArea | 显示搜索模式 |
| 搜索输入 | SearchArea | searchUser | SearchArea | 显示搜索结果 |
| 取消搜索 | SearchArea | - | TabArea, ContentArea | 恢复列表模式 |
| 返回 | HeaderArea | - | - | 返回上一页 |

---

## 🌳 STEP 3: 树状图

```
【User模块】★★★
│
├── 【粉丝与关注页】📱 [L1] [拆分:5个L2]
│   │   文件: FollowFansPage/index.tsx
│   │   路由: /user/follow-fans
│   │
│   ├── 📍 HeaderArea [L2] [固定顶部] [条件:非搜索模式显示]
│   │   │   文件: HeaderArea.tsx
│   │   │   布局: flex-row, space-between, 高度44px
│   │   │
│   │   ├── 《BackButton》[L3] [位置:TL]
│   │   │   └── ← 返回图标 [样式:24x24]
│   │   │       └── 点击 → 返回上一页
│   │   │
│   │   ├── 《TabNav》[L3] [位置:TC]
│   │   │   │   布局: flex-row, center, gap-40px
│   │   │   │
│   │   │   └── 《TabItem》[1模板x2实例] [data:TabData.tabs]
│   │   │       ├── "关注" [data:tabs[0].label]
│   │   │       │   └── [状态:isActive] → 紫色+下划线 / 灰色
│   │   │       └── "粉丝" [data:tabs[1].label]
│   │   │           └── [状态:isActive] → 紫色+下划线 / 灰色
│   │   │
│   │   └── 《SearchButton》[L3] [位置:TR]
│   │       └── 🔍 搜索图标 [样式:24x24]
│   │           └── 点击 → 进入搜索模式
│   │
│   ├── 📍 SearchArea [L2] [固定顶部] [条件:搜索模式显示]
│   │   │   文件: SearchArea.tsx
│   │   │   布局: flex-row, 高度44px, padding:12px
│   │   │
│   │   ├── 《SearchInput》[L3] [位置:ML] [flex:1]
│   │   │   │   布局: flex-row, center
│   │   │   │   样式: 灰色背景+圆角20px
│   │   │   │
│   │   │   ├── 🔍 搜索图标 [位置:左侧] [样式:16x16灰色]
│   │   │   └── Input输入框 [flex:1]
│   │   │       ├── placeholder: "搜索用户名称" [data:SearchData.placeholder]
│   │   │       └── value: [data:SearchData.keyword]
│   │   │
│   │   └── 《CancelButton》[L3] [位置:MR]
│   │       └── "取消" [样式:16sp紫色]
│   │           └── 点击 → 退出搜索模式
│   │
│   ├── 🏷️ ContentArea [L2] [flex:1, 可滚动]
│   │   │   文件: ContentArea/
│   │   │   ├── index.tsx
│   │   │   ├── types.ts
│   │   │   └── useContentArea.ts
│   │   │   布局: flex-col, scroll-y
│   │   │
│   │   ├── 📋 UserList [布局:flex-col]
│   │   │   │
│   │   │   └── 《UserItem》[L3] [1模板xN实例] [data:ListData.list]
│   │   │       │   文件: ContentArea/UserItem/
│   │   │       │   │   ├── index.tsx
│   │   │       │   │   └── types.ts
│   │   │       │   布局: flex-row, padding:16px, gap-12px
│   │   │       │   样式: 白色背景, 底部分隔线1px#F5F5F5
│   │   │       │
│   │   │       ├── 《Avatar》[L4] [位置:左侧] [固定80px]
│   │   │       │   └── 头像图片 [data:UserItem.avatarData.avatarUrl]
│   │   │       │       └── [样式:80x80圆形]
│   │   │       │
│   │   │       ├── 《UserInfo》[L4] [位置:中间] [flex:1]
│   │   │       │   │   布局: flex-col, gap-4px
│   │   │       │   │
│   │   │       │   ├── R1: 昵称+性别年龄
│   │   │       │   │   │   布局: flex-row, items-center, gap-8px
│   │   │       │   │   │
│   │   │       │   │   ├── 昵称 [data:UserItem.basicInfo.nickname]
│   │   │       │   │   │   └── [样式:16sp#333333粗体]
│   │   │       │   │   │
│   │   │       │   │   └── 《GenderAgeBadge》[L5]
│   │   │       │   │       │   [data:UserItem.basicInfo.gender, age]
│   │   │       │   │       └── [样式:圆角标签, 蓝色/粉色背景]
│   │   │       │   │           └── "♂ 19" / "♀ 19"
│   │   │       │   │
│   │   │       │   ├── R2: 认证标签 [条件:isVerified=true]
│   │   │       │   │   │   [data:UserItem.basicInfo.isVerified]
│   │   │       │   │   │
│   │   │       │   │   └── 《VerifiedBadge》[L5]
│   │   │       │   │       └── ✓ "实名认证"
│   │   │       │   │           └── [样式:蓝色背景+白字, 圆角12px]
│   │   │       │   │
│   │   │       │   └── R3: 个性签名 [条件:signature存在]
│   │   │       │       │   [data:UserItem.basicInfo.signature]
│   │   │       │       └── "这里是个性签名"
│   │   │       │           └── [样式:14sp#999999, 单行省略]
│   │   │       │
│   │   │       └── 《FollowButton》[L4] [位置:右侧] [固定宽度]
│   │   │           │   [data:UserItem.relationData.relationStatus]
│   │   │           │
│   │   │           ├── [none/followed] → "关注"
│   │   │           │   └── [样式:紫色实心按钮, 白字]
│   │   │           │
│   │   │           ├── [following] → "已关注"
│   │   │           │   └── [样式:淡紫色背景, 紫字]
│   │   │           │
│   │   │           └── [mutual] → "互相关注"
│   │   │               └── [样式:淡紫色边框, 紫字]
│   │   │
│   │   ├── 《LoadingMore》[L3] [条件:isLoading且page>1]
│   │   │   └── Loading指示器
│   │   │
│   │   └── 《EndTip》[L3] [条件:hasMore=false]
│   │       └── "没有更多啦~" [样式:14sp#CCCCCC, 居中]
│   │
│   ├── 🏷️ SearchResultArea [L2] [条件:搜索模式且有结果]
│   │   │   布局: 复用ContentArea结构
│   │   │
│   │   └── 《UserItem》[L3] [1模板xN实例] [data:SearchData.searchResults]
│   │       └── ← 复用ContentArea.UserItem
│   │
│   └── 🏷️ EmptyState [L2] [条件:列表为空]
│       │   文件: EmptyState.tsx
│       │
│       ├── [Tab关注-空] → "暂无关注的用户"
│       ├── [Tab粉丝-空] → "暂无粉丝"
│       └── [搜索-空] → "未找到相关用户"
│
└── 🔧 服务层（对应 STEP 6 的接口）
    ├── 📡 GET /api/user/follow/list         → 关注/粉丝列表 [→ PageModel.ListData]
    ├── 📡 GET /api/user/follow/search       → 搜索用户 [→ PageModel.SearchData]
    └── 📡 POST /api/user/follow/toggle      → 关注/取关操作 [→ SharedModel.ActionResult]
```

### 列表控制

```
🔄 ListControl [适用于 ContentArea]
├── 加载更多: 上滑 [距底100px] → 调用列表接口(page+1)
├── 下拉刷新: [阈值60px] → 调用列表接口(page=1)
├── 骨架屏: [条件:isLoading且page=1] 显示占位
├── 加载指示: [条件:isLoading且page>1] 显示底部loading
├── 空状态: [条件:list.length=0] 显示空状态插画
└── 到底提示: [条件:hasMore=false] "没有更多啦~"
```

### 组件复用关系

```
组件复用：
├── UserItem           → 关注列表、粉丝列表、搜索结果 共用
├── FollowButton       → UserItem内复用，不同状态显示不同样式
├── GenderAgeBadge     → 可跨页面复用（用户相关页面）
├── VerifiedBadge      → 可跨页面复用（实名认证标识）
└── EmptyState         → 模块内复用，传入不同文案
```

---

## 📍 STEP 4: 布局定位

### 页面整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│  📱 FollowFansPage [L1]                                          │
│  布局: flex-col | 全屏                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  HeaderArea [L2] | 固定顶部 | 高度:44px                   │    │
│  │  ┌────┐      ┌──────┬──────┐           ┌────┐          │    │
│  │  │ ← │      │ 关注 │ 粉丝 │           │ 🔍 │          │    │
│  │  └────┘      │ ━━━ │      │           └────┘          │    │
│  │  [TL]        └──────┴──────┘            [TR]           │    │
│  │                  [TC]                                   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  ContentArea [L2] | flex:1 | scroll-y                    │    │
│  │                                                          │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │  UserItem [L3]                                   │    │    │
│  │  │  ┌──────┐  ┌─────────────────────┐  ┌────────┐ │    │    │
│  │  │  │      │  │ 昵称123    ♂19     │  │ 已关注 │ │    │    │
│  │  │  │ 头像 │  │ ✓实名认证          │  │        │ │    │    │
│  │  │  │      │  │ 这里是个性签名      │  └────────┘ │    │    │
│  │  │  └──────┘  └─────────────────────┘              │    │    │
│  │  │  [固定80px]    [flex:1]          [固定宽度]     │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │  ─────────────────────────────────────────────────────  │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │  UserItem [L3] ... x N                          │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │  ─────────────────────────────────────────────────────  │    │
│  │                                                          │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │            没有更多啦~                           │    │    │
│  │  │               [BC]                              │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │                                                          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 搜索模式布局

```
┌─────────────────────────────────────────────────────────────────┐
│  📱 FollowFansPage [搜索模式]                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  SearchArea [L2] | 固定顶部 | 高度:44px                   │    │
│  │  ┌───────────────────────────────────────┐  ┌──────┐    │    │
│  │  │ 🔍 搜索用户名称                        │  │ 取消 │    │    │
│  │  │    (输入框)                            │  │      │    │    │
│  │  └───────────────────────────────────────┘  └──────┘    │    │
│  │           [flex:1, 灰色圆角背景]            [紫色文字]   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  SearchResultArea [L2] | flex:1                          │    │
│  │                                                          │    │
│  │  [有关键词无结果] → 空白区域 / "未找到相关用户"           │    │
│  │  [有搜索结果] → UserItem列表（复用样式）                  │    │
│  │                                                          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### HeaderArea 布局详图

```
┌─────────────────────────────────────────────────────────────────┐
│  HeaderArea [L2]                                                 │
│  布局: flex-row, space-between, items-center                     │
│  高度: 44px | padding: 0 16px                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌────────┐          ┌─────────────────┐          ┌────────┐   │
│  │   ←    │          │   关注  │  粉丝  │          │   🔍   │   │
│  │ 24x24  │          │   ━━━  │       │          │ 24x24  │   │
│  └────────┘          └─────────────────┘          └────────┘   │
│    [TL]                    [TC]                      [TR]       │
│  固定44px              flex-row,gap-40px            固定44px    │
│                                                                  │
│  Tab选中样式: 紫色文字 #8B5CF6 + 下划线2px                       │
│  Tab默认样式: 灰色文字 #999999                                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### UserItem 布局详图

```
┌─────────────────────────────────────────────────────────────────┐
│  UserItem [L3]                                                   │
│  布局: flex-row, items-center                                    │
│  高度: auto | padding: 16px | gap: 12px                          │
│  底部: 分隔线 1px #F5F5F5                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────┐  ┌────────────────────────────┐  ┌──────────────┐ │
│  │          │  │ R1: 昵称123  ┌────────┐   │  │              │ │
│  │          │  │              │ ♂ 19   │   │  │   已关注     │ │
│  │  Avatar  │  │              └────────┘   │  │              │ │
│  │  80x80   │  ├────────────────────────────┤  │  或 关注     │ │
│  │  圆形    │  │ R2: ✓ 实名认证             │  │  或 互相关注 │ │
│  │          │  ├────────────────────────────┤  │              │ │
│  │          │  │ R3: 这里是个性签名...      │  │   80x32px    │ │
│  └──────────┘  └────────────────────────────┘  └──────────────┘ │
│   [固定80px]          [flex:1]                   [固定宽度]      │
│                                                                  │
│  UserInfo 内部布局: flex-col, gap-4px                            │
│  R1布局: flex-row, items-center, gap-8px                         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 关注按钮状态样式

```
┌─────────────────────────────────────────────────────────────────┐
│  FollowButton 状态样式                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  【关注】(none/followed状态)                                     │
│  ┌────────────────┐                                             │
│  │     关注       │  背景: #8B5CF6 (紫色实心)                   │
│  │                │  文字: #FFFFFF (白色)                       │
│  └────────────────┘  尺寸: 80x32px, 圆角16px                    │
│                                                                  │
│  【已关注】(following状态)                                       │
│  ┌────────────────┐                                             │
│  │    已关注      │  背景: #F3E8FF (淡紫色)                     │
│  │                │  文字: #8B5CF6 (紫色)                       │
│  └────────────────┘  尺寸: 80x32px, 圆角16px                    │
│                                                                  │
│  【互相关注】(mutual状态)                                        │
│  ┌────────────────┐                                             │
│  │   互相关注     │  背景: 透明                                 │
│  │                │  边框: 1px #F3E8FF (淡紫色)                 │
│  └────────────────┘  文字: #8B5CF6 (紫色)                       │
│                      尺寸: 80x32px, 圆角16px                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### SearchArea 布局详图

```
┌─────────────────────────────────────────────────────────────────┐
│  SearchArea [L2]                                                 │
│  布局: flex-row, items-center                                    │
│  高度: 44px | padding: 8px 16px | gap: 12px                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────┐  ┌────────────┐   │
│  │ 🔍  搜索用户名称 / 输入内容             │  │    取消    │   │
│  │     [placeholder / value]               │  │            │   │
│  └─────────────────────────────────────────┘  └────────────┘   │
│           [flex:1]                              [固定48px]      │
│   背景: #F5F5F5, 圆角20px                      文字: #8B5CF6    │
│   内部padding: 0 16px                          16sp            │
│   高度: 36px                                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📁 STEP 5: 代码结构

```
src/modules/
│
├─ User/                                    # 用户模块
│   │
│   ├─ api/                                 # 模块级API
│   │   ├─ apiGetFollowList.ts              # 获取关注/粉丝列表
│   │   ├─ apiSearchUser.ts                 # 搜索用户
│   │   └─ apiToggleFollow.ts               # 关注/取关操作
│   │
│   ├─ stores/                              # 模块级状态
│   │   └─ useFollowStore.ts                # 关注相关状态管理
│   │
│   ├─ hooks/                               # 模块级Hooks
│   │   └─ useUserRelation.ts               # 用户关系判断Hook
│   │
│   │   ┌─────────────────────────────────────────────────────────────┐
│   │   │  📱 页面 [L1] - FollowFansPage/index.tsx                     │
│   │   ├─────────────────────────────────────────────────────────────┤
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  HeaderArea [L2] (非搜索模式)                        │   │ 固定
│   │   │  └─────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  SearchArea [L2] (搜索模式)                          │   │ 固定
│   │   │  └─────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  ContentArea [L2]                                   │   │
│   │   │  │    └── UserItem [L3] x N                            │   │ flex:1
│   │   │  └─────────────────────────────────────────────────────┘   │ 可滚动
│   │   │  布局: flex-col | 条件渲染Header/SearchArea                 │
│   │   └─────────────────────────────────────────────────────────────┘
│   │
│   ├─ FollowFansPage/                      # 粉丝与关注页面
│   │   │
│   │   ├─ index.tsx                        # 页面主文件 [L1]
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  页面职责:                                               │
│   │   │   │  - 组合区域组件                                          │
│   │   │   │  - 管理搜索模式状态                                       │
│   │   │   │  - 处理Tab切换逻辑                                        │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ types.ts                         # 页面类型定义
│   │   ├─ constants.ts                     # 常量定义 (Tab配置等)
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🟢 简单区域 [L2] - HeaderArea.tsx                       │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌────┐      ┌──────┬──────┐      ┌────┐              │
│   │   │   │  │ ← │      │ 关注 │ 粉丝 │      │ 🔍 │              │
│   │   │   │  └────┘      │ ━━━ │      │      └────┘              │
│   │   │   │  [TL]        └──────┴──────┘       [TR]               │
│   │   │   │  布局: flex-row, space-between | 高度: 44px             │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ HeaderArea.tsx                   # 🟢 头部区域（单文件）
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🟢 简单区域 [L2] - SearchArea.tsx                       │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌────────────────────────────────┐  ┌────────┐        │
│   │   │   │  │ 🔍 搜索用户名称                │  │  取消  │        │
│   │   │   │  └────────────────────────────────┘  └────────┘        │
│   │   │   │       [flex:1, 灰色背景圆角]          [紫色文字]        │
│   │   │   │  布局: flex-row, gap-12px | 高度: 44px                  │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ SearchArea.tsx                   # 🟢 搜索区域（单文件）
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🔵 复杂区域 [L2] - ContentArea/                         │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌─────────────────────────────────────────────────┐   │
│   │   │   │  │  ┌──────┐  ┌────────────────┐  ┌──────────┐    │   │
│   │   │   │  │  │ 头像 │  │ 昵称 ♂19      │  │  已关注  │    │   │
│   │   │   │  │  │      │  │ ✓实名认证     │  │          │    │   │
│   │   │   │  │  │      │  │ 个性签名      │  └──────────┘    │   │
│   │   │   │  │  └──────┘  └────────────────┘                  │   │
│   │   │   │  └─────────────────────────────────────────────────┘   │
│   │   │   │       UserItem [L3] x N                                 │
│   │   │   │  布局: flex-col | 滚动: scroll-y                        │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   └─ ContentArea/                     # 🔵 内容区域（文件夹）
│   │       │
│   │       ├─ index.tsx                    # 区域主文件
│   │       ├─ types.ts                     # 类型定义
│   │       ├─ useContentArea.ts            # 状态管理Hook
│   │       │
│   │       │   ┌─────────────────────────────────────────────────────┐
│   │       │   │  🧩 子组件 [L3] - UserItem/                          │
│   │       │   ├─────────────────────────────────────────────────────┤
│   │       │   │  ┌──────────────────────────────────────────────┐  │
│   │       │   │  │ ┌────┐ ┌────────────────────┐ ┌──────────┐  │  │
│   │       │   │  │ │头像│ │ 昵称    性别年龄   │ │ 关注按钮 │  │  │
│   │       │   │  │ │    │ │ 认证标签          │ │          │  │  │
│   │       │   │  │ │    │ │ 个性签名          │ └──────────┘  │  │
│   │       │   │  │ └────┘ └────────────────────┘               │  │
│   │       │   │  └──────────────────────────────────────────────┘  │
│   │       │   │  布局: flex-row, gap-12px | 复用: 1模板 x N实例      │
│   │       │   └─────────────────────────────────────────────────────┘
│   │       │
│   │       └─ UserItem/                    # 用户项组件 [L3]
│   │           ├─ index.tsx                # 组件主文件
│   │           ├─ types.ts                 # 类型定义
│   │           └─ FollowButton.tsx         # 关注按钮子组件 [L4]
│   │
│   ├─ SharedComponents/                    # 模块共享组件 [L4]
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🔄 GenderAgeBadge/ [L4]                                 │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌────────────┐  ┌────────────┐                        │
│   │   │   │  │   ♂ 19    │  │   ♀ 19    │                        │
│   │   │   │  │  (蓝色)    │  │  (粉色)    │                        │
│   │   │   │  └────────────┘  └────────────┘                        │
│   │   │   │  样式: 圆角标签, 性别决定颜色                            │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ GenderAgeBadge/                  # 性别年龄标签
│   │   │   ├─ index.tsx
│   │   │   └─ types.ts
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🔄 VerifiedBadge/ [L4]                                  │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌────────────────┐                                     │
│   │   │   │  │ ✓ 实名认证     │                                     │
│   │   │   │  │  (蓝色背景)    │                                     │
│   │   │   │  └────────────────┘                                     │
│   │   │   │  样式: 蓝色背景+白字, 圆角12px                           │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ VerifiedBadge/                   # 实名认证标签
│   │   │   ├─ index.tsx
│   │   │   └─ types.ts
│   │   │
│   │   └─ EmptyState/                      # 空状态组件
│   │       ├─ index.tsx
│   │       └─ types.ts
│   │
│   └─ index.ts                             # 模块入口
│
└─ Common/                                  # 公共模块
    ├─ components/                          # 全局共享组件
    │   ├─ Avatar/                          # 头像组件
    │   ├─ Loading/                         # 加载组件
    │   └─ SearchInput/                     # 搜索输入框
    └─ hooks/
        └─ usePagination.ts                 # 分页Hook
```

### 文件命名规范

```
类型          命名格式                        示例
─────────────────────────────────────────────────────────
主组件        index.tsx                       index.tsx
类型定义      types.ts                        types.ts
常量          constants.ts                    constants.ts
状态管理      use{Name}.ts                    useContentArea.ts
API接口       api{Name}{Action}.ts            apiGetFollowList.ts
子组件        {Name}.tsx                      FollowButton.tsx
```

---

## 🗄️ STEP 6: 接口实现与后端设计

### 接口定义

```json
{
  "接口文档信息": {
    "对应页面": "FollowFansPage",
    "对应数据模型": "STEP 1 → PageModel",
    "版本": "v1.0"
  },

  "接口列表": [
    {
      "序号": 1,
      "接口名": "获取关注/粉丝列表",
      "接口标识": "getFollowList",
      "路径": "GET /api/user/follow/list",
      "触发时机": "[API:getFollowList] 页面初始化/下拉刷新/上拉加载/Tab切换",
      "对应数据模型": "STEP 1 → PageModel.ListData",

      "请求参数": {
        "type": "String(following|fans) - 列表类型 - 来自 STEP 1 → TabItem.key",
        "page": "Number - 页码 - 默认1",
        "pageSize": "Number - 每页数量 - 默认20"
      },

      "响应数据": {
        "code": "Number - 状态码 - 200成功",
        "message": "String - 提示信息",
        "data": {
          "_映射": "→ STEP 1: PageModel.ListData",
          "list": "Array<UserItem> - 用户列表",
          "hasMore": "Boolean - 是否有更多",
          "total": "Number - 总数"
        }
      },

      "响应示例": {
        "code": 200,
        "message": "success",
        "data": {
          "list": [
            {
              "userId": "u_123456",
              "avatarData": {
                "avatarUrl": "https://xxx.com/avatar/123.jpg"
              },
              "basicInfo": {
                "nickname": "用户名称123",
                "gender": "male",
                "age": 19,
                "isVerified": true,
                "signature": "这里是个性签名"
              },
              "relationData": {
                "relationStatus": "following"
              }
            }
          ],
          "hasMore": true,
          "total": 100
        }
      },

      "数据库映射": {
        "_说明": "此接口数据来源",
        "list[].userId": "users.id",
        "list[].avatarData": "users.avatar",
        "list[].basicInfo": "users.nickname, users.gender, users.age, users.is_verified, users.signature",
        "list[].relationData.relationStatus": "通过 user_follows 表双向查询判断"
      }
    },

    {
      "序号": 2,
      "接口名": "搜索用户",
      "接口标识": "searchUser",
      "路径": "GET /api/user/follow/search",
      "触发时机": "[API:searchUser] 搜索输入防抖后触发",
      "对应数据模型": "STEP 1 → PageModel.SearchData",

      "请求参数": {
        "keyword": "String - 搜索关键词 - 来自 STEP 1 → SearchData.keyword",
        "type": "String(following|fans) - 在哪个列表中搜索",
        "page": "Number - 页码 - 默认1",
        "pageSize": "Number - 每页数量 - 默认20"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "message": "String - 提示信息",
        "data": {
          "_映射": "→ STEP 1: PageModel.SearchData.searchResults",
          "list": "Array<UserItem> - 搜索结果",
          "hasMore": "Boolean - 是否有更多",
          "total": "Number - 总数"
        }
      },

      "响应示例": {
        "code": 200,
        "message": "success",
        "data": {
          "list": [
            {
              "userId": "u_123456",
              "avatarData": {
                "avatarUrl": "https://xxx.com/avatar/123.jpg"
              },
              "basicInfo": {
                "nickname": "用户名称123",
                "gender": "male",
                "age": 19,
                "isVerified": true,
                "signature": "这里是个性签名"
              },
              "relationData": {
                "relationStatus": "mutual"
              }
            }
          ],
          "hasMore": false,
          "total": 1
        }
      }
    },

    {
      "序号": 3,
      "接口名": "关注/取消关注",
      "接口标识": "toggleFollow",
      "路径": "POST /api/user/follow/toggle",
      "触发时机": "[API:toggleFollow] 点击关注/取关按钮",
      "对应数据模型": "STEP 1 → SharedModel.ActionResult",

      "请求参数": {
        "targetUserId": "String - 目标用户ID - 来自 STEP 1 → UserItem.userId",
        "action": "String(follow|unfollow) - 操作类型"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "message": "String - 提示信息",
        "data": {
          "_映射": "→ STEP 1: SharedModel.ActionResult",
          "success": "Boolean - 是否成功",
          "newRelationStatus": "String - 新的关系状态"
        }
      },

      "响应示例": {
        "code": 200,
        "message": "关注成功",
        "data": {
          "success": true,
          "newRelationStatus": "mutual"
        }
      },

      "数据库操作": {
        "follow": "INSERT INTO user_follows + UPDATE users.following_count/fans_count",
        "unfollow": "DELETE FROM user_follows + UPDATE users.following_count/fans_count"
      }
    }
  ]
}
```

### 接口汇总表

| 序号 | 接口标识 | 方法 | 路径 | 对应数据模型 | 触发时机 | 缓存 |
|------|----------|------|------|--------------|----------|------|
| 1 | getFollowList | GET | /api/user/follow/list | ListData | 初始化/刷新/加载/切换 | 无 |
| 2 | searchUser | GET | /api/user/follow/search | SearchData | 搜索输入 | 无 |
| 3 | toggleFollow | POST | /api/user/follow/toggle | ActionResult | 点击关注按钮 | 无 |

### 数据库表设计

```sql
-- 用户表（对应 STEP 1: ItemModel.UserItem）
CREATE TABLE users (
    id              BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '用户ID → userId',
    nickname        VARCHAR(50) NOT NULL COMMENT '昵称 → basicInfo.nickname',
    avatar          VARCHAR(500) COMMENT '头像URL → avatarData.avatarUrl',
    gender          ENUM('male', 'female', 'unknown') DEFAULT 'unknown' COMMENT '性别 → basicInfo.gender',
    age             INT UNSIGNED COMMENT '年龄 → basicInfo.age',
    is_verified     TINYINT(1) DEFAULT 0 COMMENT '是否实名认证 → basicInfo.isVerified',
    signature       VARCHAR(200) COMMENT '个性签名 → basicInfo.signature',

    -- 冗余计数字段（提高查询性能）
    following_count INT UNSIGNED DEFAULT 0 COMMENT '关注数',
    fans_count      INT UNSIGNED DEFAULT 0 COMMENT '粉丝数',

    status          TINYINT DEFAULT 1 COMMENT '状态: 0=禁用, 1=正常',
    created_at      DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at      DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_nickname (nickname),
    INDEX idx_status (status)
) COMMENT '用户表 → ItemModel.UserItem';

-- 关注关系表（用于判断 STEP 1: UserItem.relationData.relationStatus）
CREATE TABLE user_follows (
    id              BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id         BIGINT NOT NULL COMMENT '关注者ID',
    target_user_id  BIGINT NOT NULL COMMENT '被关注者ID',
    created_at      DATETIME DEFAULT CURRENT_TIMESTAMP,

    UNIQUE KEY uk_follow (user_id, target_user_id),
    INDEX idx_user_id (user_id),
    INDEX idx_target_user_id (target_user_id)
) COMMENT '关注关系表 → 判断 relationStatus';
```

### 核心SQL查询

```sql
-- 1. 获取关注列表（返回 STEP 1: PageModel.ListData）
-- type = 'following': 我关注的人
SELECT
    u.id AS userId,
    u.avatar AS avatarUrl,
    u.nickname,
    u.gender,
    u.age,
    u.is_verified AS isVerified,
    u.signature,
    -- 判断关系状态
    CASE
        WHEN f2.id IS NOT NULL THEN 'mutual'      -- 互相关注
        ELSE 'following'                          -- 我关注对方
    END AS relationStatus
FROM user_follows f1
INNER JOIN users u ON f1.target_user_id = u.id
LEFT JOIN user_follows f2 ON f2.user_id = f1.target_user_id AND f2.target_user_id = f1.user_id
WHERE f1.user_id = #{currentUserId}
  AND u.status = 1
ORDER BY f1.created_at DESC
LIMIT #{pageSize} OFFSET #{offset};

-- 2. 获取粉丝列表（返回 STEP 1: PageModel.ListData）
-- type = 'fans': 关注我的人
SELECT
    u.id AS userId,
    u.avatar AS avatarUrl,
    u.nickname,
    u.gender,
    u.age,
    u.is_verified AS isVerified,
    u.signature,
    -- 判断关系状态
    CASE
        WHEN f2.id IS NOT NULL THEN 'mutual'      -- 互相关注
        WHEN f3.id IS NOT NULL THEN 'following'   -- 我关注对方（但对方没关注我，理论上不存在）
        ELSE 'followed'                           -- 对方关注我，我未关注
    END AS relationStatus
FROM user_follows f1
INNER JOIN users u ON f1.user_id = u.id
LEFT JOIN user_follows f2 ON f2.user_id = f1.target_user_id AND f2.target_user_id = f1.user_id
LEFT JOIN user_follows f3 ON f3.user_id = #{currentUserId} AND f3.target_user_id = f1.user_id
WHERE f1.target_user_id = #{currentUserId}
  AND u.status = 1
ORDER BY f1.created_at DESC
LIMIT #{pageSize} OFFSET #{offset};

-- 3. 搜索用户（在关注/粉丝列表中搜索）
-- 以搜索关注列表为例
SELECT
    u.id AS userId,
    u.avatar AS avatarUrl,
    u.nickname,
    u.gender,
    u.age,
    u.is_verified AS isVerified,
    u.signature,
    CASE
        WHEN f2.id IS NOT NULL THEN 'mutual'
        ELSE 'following'
    END AS relationStatus
FROM user_follows f1
INNER JOIN users u ON f1.target_user_id = u.id
LEFT JOIN user_follows f2 ON f2.user_id = f1.target_user_id AND f2.target_user_id = f1.user_id
WHERE f1.user_id = #{currentUserId}
  AND u.status = 1
  AND u.nickname LIKE CONCAT('%', #{keyword}, '%')
ORDER BY f1.created_at DESC
LIMIT #{pageSize} OFFSET #{offset};

-- 4. 关注操作
-- follow:
INSERT INTO user_follows (user_id, target_user_id) VALUES (#{currentUserId}, #{targetUserId});
UPDATE users SET following_count = following_count + 1 WHERE id = #{currentUserId};
UPDATE users SET fans_count = fans_count + 1 WHERE id = #{targetUserId};

-- unfollow:
DELETE FROM user_follows WHERE user_id = #{currentUserId} AND target_user_id = #{targetUserId};
UPDATE users SET following_count = GREATEST(following_count - 1, 0) WHERE id = #{currentUserId};
UPDATE users SET fans_count = GREATEST(fans_count - 1, 0) WHERE id = #{targetUserId};

-- 5. 查询用户关系状态（用于构建 relationStatus）
SELECT
    CASE
        WHEN f1.id IS NOT NULL AND f2.id IS NOT NULL THEN 'mutual'    -- 互关
        WHEN f1.id IS NOT NULL THEN 'following'                       -- 我关注对方
        WHEN f2.id IS NOT NULL THEN 'followed'                        -- 对方关注我
        ELSE 'none'                                                   -- 无关系
    END AS relationStatus
FROM (SELECT #{currentUserId} AS current_user_id, #{targetUserId} AS target_user_id) AS params
LEFT JOIN user_follows f1 ON f1.user_id = params.current_user_id AND f1.target_user_id = params.target_user_id
LEFT JOIN user_follows f2 ON f2.user_id = params.target_user_id AND f2.target_user_id = params.current_user_id;
```

### MVP清单

| 序号 | 功能 | 对应数据模型 | 涉及表 | 接口 | 优先级 |
|------|------|--------------|--------|------|--------|
| 1 | 关注列表查询 | ListData | users, user_follows | GET /follow/list | P0 |
| 2 | 粉丝列表查询 | ListData | users, user_follows | GET /follow/list | P0 |
| 3 | 关注/取关操作 | ActionResult | user_follows, users | POST /follow/toggle | P0 |
| 4 | 分页支持 | PaginationInfo | - | query params | P0 |
| 5 | 搜索用户 | SearchData | users, user_follows | GET /follow/search | P1 |

**MVP统计：2张表 + 3个接口 = 最小可行后端**

### 性能优化检查点

```
✅ 索引：
   - users.nickname 索引（搜索优化）
   - user_follows.user_id 索引（关注列表查询）
   - user_follows.target_user_id 索引（粉丝列表查询）
   - user_follows 联合唯一索引（防重复关注）

✅ 冗余：
   - users.following_count 冗余字段（避免COUNT查询）
   - users.fans_count 冗余字段（避免COUNT查询）

✅ 分页：
   - 使用 LIMIT OFFSET 分页
   - 考虑大数据量时改用游标分页（基于 created_at）

✅ 缓存建议：
   - 用户基础信息可缓存 5分钟
   - 关系状态需实时查询，不缓存
```

---

## 🎯 质量评估

| 维度 | 评分 | 说明 |
|------|------|------|
| 数据模型 | 9 | PageModel/ItemModel完整，字段与UI绑定清晰 |
| 结构完整性 | 9 | 所有可见元素均有层级标注，含4种页面状态 |
| 数据绑定 | 9 | 所有动态数据均有[data:字段]标注 |
| 位置精确度 | 8 | 九宫格+行列系统完整，含详细尺寸 |
| 组件拆分 | 9 | L1/L2/L3/L4层级清晰，复用关系明确 |
| 复用标记 | 9 | 模板和实例标记完整，跨页面复用组件标注清晰 |
| 交互描述 | 9 | Tab切换/搜索/关注操作流程完整 |
| 代码映射 | 9 | 可直接创建文件夹结构 |
| 接口+后端 | 9 | 接口对应数据模型，SQL可直接执行 |

**综合评分：8.9 / 10**

---

*文档生成时间：2025-12-01*
*模板版本：v5.4*
