# 🌳 纯结构架构图标准模板 v5.4

> **核心输出：JSON契约 → 流程图 → 树状图 + 布局 → 代码结构 → 后端MVP**
>
> **设计理念：数据驱动，JSON先行，前后端契约优先**

---

## 📥 开始使用

**请提供以下任一输入：**

```
1. UI截图/设计稿图片 - 直接上传页面截图或设计稿
2. 页面描述 - 用文字描述页面的主要功能和布局
3. 原型链接 - 提供Figma/蓝湖等原型工具链接

示例输入：
├── "这是一个发现页面，顶部有Tab切换（关注/热门/同城），下方是瀑布流内容列表"
├── "用户个人中心页面，包含头像、昵称、统计数据、功能入口列表"
└── [直接上传UI截图]
```

**收到输入后，将按六步法生成完整开发文档。**

---

## 🚀 工作流程（必读）

### 六步法：从UI图到可开发文档

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        UI图输入                                          │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 1: 📋 页面数据模型（最重要！驱动前端构建）                    │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • 定义页面和组件需要的数据结构                                     │    │
│  │  • PageModel / AreaModel / ItemModel 层级                         │    │
│  │  • 字段与 UI 元素的绑定关系                                         │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 2: 🔄 流程图（用户操作流程）                                  │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • 页面初始化流程（调用哪些接口）                                   │    │
│  │  • 用户交互路径（触发哪些操作接口）                                 │    │
│  │  • 状态管理流程（数据如何流转）                                     │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 3: 🌳 树状图（页面结构层级）                                  │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • L1/L2/L3 三层拆分                                              │    │
│  │  • 标注位置、尺寸、样式                                            │    │
│  │  • 标注数据绑定（来自哪个JSON字段）                                 │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 4: 📍 布局定位（位置/行列描述）                               │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • 九宫格定位 + 行列系统                                           │    │
│  │  • Flex/Grid 布局描述                                             │    │
│  │  • 可视化布局图                                                    │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 5: 📁 代码结构（文件夹/文件组织）                             │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • Modules模块结构                                                │    │
│  │  • 区域组件划分                                                    │    │
│  │  • 文件命名规范                                                    │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  STEP 6: 🗄️ 接口实现与后端设计                                     │    │
│  │  ────────────────────────────────────────────────────────────    │    │
│  │  • 完整API接口定义（对应STEP 1数据模型）                            │    │
│  │  • 核心数据库表设计                                                │    │
│  │  • 核心SQL查询                                                     │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                           ↓                                              │
│                      完整开发文档                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 为什么JSON先行？

```
传统方式：UI → 前端开发 → 发现需要数据 → 找后端要接口 → 反复沟通
                                    ↓
                              效率低、返工多

JSON先行：UI → JSON契约 → 前端+后端并行开发 → 联调
                  ↓
            一次定义，双方对齐，减少返工
```

### 六步关联图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         STEP 横向关联关系                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   STEP 1              STEP 2              STEP 3                            │
│   数据模型     ←───→   流程图      ←───→   树状图                            │
│   ──────────          ──────────          ──────────                        │
│   定义 What           描述 When           描述 Where                         │
│   PageModel           [API:xxx]           {Area} 组件                       │
│   ItemModel           触发时机            [data:字段]                        │
│       │                   │                   │                             │
│       │                   ↓                   │                             │
│       │              STEP 4: 布局             │                             │
│       │              位置/尺寸/排列           │                             │
│       │                   │                   │                             │
│       │                   ↓                   │                             │
│       │              STEP 5: 代码             │                             │
│       │              文件夹/文件              │                             │
│       │                   │                   │                             │
│       └───────────────────┼───────────────────┘                             │
│                           ↓                                                 │
│                      STEP 6: 接口+后端                                       │
│                      定义 How                                               │
│                      API实现 + 数据库                                        │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │ 关键映射：                                                           │   │
│   │ • STEP 1 数据模型 ─→ STEP 3 组件 [data:字段] 绑定                    │   │
│   │ • STEP 1 数据模型 ─→ STEP 6 接口响应结构                             │   │
│   │ • STEP 2 流程 ─→ STEP 6 接口触发时机                                 │   │
│   │ • STEP 3 组件 ─→ STEP 5 代码文件路径                                 │   │
│   │ • STEP 4 布局 ─→ STEP 5 可视化布局图                                 │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 快速检查清单

```
□ STEP 1: 数据模型是否覆盖页面所有组件的数据需求？
□ STEP 2: 流程图是否覆盖所有交互？是否标注接口调用（→ STEP 6）？
□ STEP 3: 树状图是否标注了数据绑定来源（→ STEP 1）？
□ STEP 4: 布局图是否清晰可视化？
□ STEP 5: 代码结构是否可直接创建文件夹？
□ STEP 6: 接口响应是否对应 STEP 1 的数据模型？数据库是否完整？
```

---

## 📋 STEP 1: 页面数据模型定义

> **📌 目标**：从 UI 反推页面和组件需要的数据结构，定义驱动前端构建的核心 JSON 模型
>
> **📤 产出**：
> - 页面级数据模型（PageModel）
> - 组件级数据模型（AreaModel / ItemModel）
> - 每个字段与 UI 元素的绑定关系
> - 可复用的数据类型定义
> - 数据依赖关系图

### 设计理念

```
核心思想：数据驱动 UI，先定义"页面需要什么数据"，再考虑"数据从哪来"

STEP 1 职责：定义前端需要的数据结构（What）
STEP 6 职责：定义如何获取这些数据（How）→ 接口 + 数据库

关系示意：
┌─────────────────────────────────────────────────────────────────┐
│  STEP 1: 数据模型                    STEP 6: 数据实现            │
│  ─────────────────                   ─────────────────           │
│  PageModel {                    →    GET /api/{module}/list      │
│    {ListData}                        POST /api/{module}/action   │
│    {ConfigData}                      数据库表设计                 │
│  }                                   SQL 查询                    │
└─────────────────────────────────────────────────────────────────┘
```

### 数据模型层级

```
数据模型层级（对应 STEP 3 组件层级）：
├── 📱 PageModel [L1]      - 页面级数据模型，组合多个 AreaModel
├── 📦 AreaModel [L2]      - 区域级数据模型，对应 XXXArea 组件
├── 🧩 ItemModel [L3]      - 列表项数据模型，对应 XXXItem 组件
└── 🔧 SharedModel [L4]    - 共享数据模型，跨页面复用
```

### 页面数据模型模板

```json
{
  "模型信息": {
    "页面名称": "{页面中文名}",
    "页面标识": "{PageName}",
    "所属模块": "{ModuleName}",
    "页面类型": "{列表页|详情页|表单页|聚合页}"
  },

  "数据依赖图": "{ConfigData} + {ListData} → 渲染页面 → 用户操作 → {ActionResult}",

  "PageModel": {
    "_说明": "页面级数据模型 [L1]，组合所有区域数据",

    "{HeaderData}": {
      "_说明": "头部区域数据 → [→{HeaderArea}]",
      "{title}": "String - 页面标题 - [UI:{HeaderArea}.标题]",
      "{subtitle}": "String? - 副标题 - [UI:{HeaderArea}.副标题] [可选]"
    },

    "{TabData}": {
      "_说明": "Tab区域数据 → [→{TabArea}]",
      "{tabs}": "Array<{TabItem}> - Tab列表 - [UI:{TabArea}]",
      "{currentTab}": "String - 当前选中Tab - [状态:控制列表筛选]"
    },

    "{ListData}": {
      "_说明": "列表区域数据 → [→{ContentArea}]",
      "{list}": "Array<{ContentItem}> - 内容列表 - [UI:{ContentArea}]",
      "{hasMore}": "Boolean - 是否有更多 - [控制:加载更多/到底提示]",
      "{total}": "Number? - 总数 - [UI:{HeaderArea}.计数] [可选]"
    },

    "{PageState}": {
      "_说明": "页面状态数据",
      "{isLoading}": "Boolean - 加载中 - [状态:骨架屏/Loading]",
      "{isRefreshing}": "Boolean - 刷新中 - [状态:下拉刷新指示器]",
      "{isError}": "Boolean - 加载失败 - [状态:错误提示]",
      "{errorMessage}": "String? - 错误信息 - [UI:错误提示文案]"
    }
  }
}
```

### 组件数据模型模板

```json
{
  "AreaModel": {
    "_说明": "区域级数据模型 [L2]",

    "{TabArea}": {
      "{tabs}": "Array<{TabItem}> - Tab列表",
      "{TabItem}": {
        "{key}": "String - Tab标识 - [用于:筛选参数]",
        "{label}": "String - Tab文案 - [UI:Tab.文字]",
        "{isActive}": "Boolean - 是否选中 - [状态:选中样式]",
        "{badge}": "Number? - 角标数 - [UI:Tab.角标] [条件:>0时显示]"
      }
    },

    "{ContentArea}": {
      "{list}": "Array<{ContentItem}> - 内容列表",
      "{layoutType}": "String(grid|list|waterfall) - 布局类型 - [控制:布局切换]"
    }
  },

  "ItemModel": {
    "_说明": "列表项数据模型 [L3]",

    "{ContentItem}": {
      "_说明": "内容卡片数据 → [→{ItemComponent}]",

      "{id}": "String - 主体ID - [用于:跳转详情、操作参数]",
      "{type}": "String({type1}|{type2}) - 类型 - [条件:决定显示样式]",

      "{mediaData}": {
        "_说明": "媒体区域 → [→{ItemComponent}.媒体区]",
        "{coverUrl}": "String - 封面URL - [UI:卡片.封面图]",
        "{aspectRatio}": "Number - 宽高比 - [计算:高度=宽度/ratio]",
        "{duration}": "Number? - 时长(秒) - [UI:卡片.时长标签] [条件:type=video]",
        "{badge}": "String? - 角标文案 - [UI:卡片.角标] [条件:有值时显示]"
      },

      "{textData}": {
        "_说明": "文本区域 → [→{ItemComponent}.文本区]",
        "{title}": "String - 标题 - [UI:卡片.标题] [样式:14sp,最多2行,省略]",
        "{description}": "String? - 描述 - [UI:卡片.描述] [可选]"
      },

      "{authorData}": {
        "_说明": "作者信息 → [→{ItemComponent}.作者区]",
        "{userId}": "String - 用户ID - [用于:跳转用户主页]",
        "{avatar}": "String - 头像URL - [UI:卡片.头像] [样式:24x24圆形]",
        "{nickname}": "String - 昵称 - [UI:卡片.昵称]",
        "{isFollowed}": "Boolean? - 是否已关注 - [UI:关注按钮状态]"
      },

      "{statsData}": {
        "_说明": "统计数据 → [→{ItemComponent}.统计区]",
        "{likeCount}": "Number - 点赞数 - [UI:卡片.点赞] [格式:>=10000显示1.2w]",
        "{isLiked}": "Boolean - 是否已赞 - [状态:点赞按钮] [true=红心,false=空心]",
        "{commentCount}": "Number? - 评论数 - [UI:卡片.评论] [可选]"
      },

      "{metaData}": {
        "_说明": "元信息",
        "{createTime}": "String(ISO8601) - 创建时间 - [格式:刚刚/X分钟前/MM-DD]",
        "{location}": "String? - 位置 - [UI:卡片.位置] [可选]"
      }
    }
  }
}
```

### 共享数据模型

```json
{
  "SharedModel": {
    "_说明": "跨页面复用的数据模型 [L4]",

    "{UserInfo}": {
      "_说明": "用户基础信息（多处复用）",
      "{userId}": "String - 用户ID",
      "{nickname}": "String - 昵称",
      "{avatar}": "String - 头像URL",
      "{level}": "Number? - 等级",
      "{isVip}": "Boolean? - 是否VIP"
    },

    "{PaginationInfo}": {
      "_说明": "分页信息",
      "{page}": "Number - 当前页码",
      "{pageSize}": "Number - 每页数量",
      "{hasMore}": "Boolean - 是否有更多",
      "{total}": "Number? - 总数"
    },

    "{ActionResult}": {
      "_说明": "操作结果",
      "{success}": "Boolean - 是否成功",
      "{message}": "String? - 提示信息",
      "{newValue}": "Any? - 新值（如新的计数）"
    }
  }
}
```

### 字段类型标注规范

```
基础类型：
├── String              - 字符串
├── Number              - 数字（整数或浮点数）
├── Boolean             - 布尔值
├── Array<T>            - 数组，T为元素类型
└── Object              - 对象

增强标注：
├── String(val1|val2)   - 枚举字符串，列出所有可能值
├── Number(0-100)       - 数字范围
├── String?             - 可选字段（可能不返回）
├── String!             - 必填字段
└── Array<Item>         - 引用数据模型定义

示例：
├── "type": "String(image|video|audio) - 内容类型"
├── "status": "Number(0|1|2) - 状态：0=删除,1=正常,2=审核中"
├── "score": "Number(0-5) - 评分，保留1位小数"
├── "tags": "Array<String> - 标签列表"
└── "author": "Author - 作者信息（引用数据模型）"
```

### 数据字段与UI绑定标注

**标注格式规范：**
```
"字段名": "类型 - 说明 - [标注1] [标注2] ..."

标注类型：
├── [UI:组件.区域.元素]     - UI位置绑定
├── [用于:跳转/调用/计算]    - 字段用途
├── [条件:XXX时显示]        - 条件显示
├── [样式:14sp,2行省略]     - 样式描述
├── [格式:格式化规则]       - 显示格式化
├── [计算:计算公式]         - 计算逻辑
└── [状态:true/false效果]   - 状态切换
```

**【示例A：内容列表页】**
```json
{
  "响应数据": {
    "id": "String - 主体ID - [用于:跳转详情页、操作接口参数]",
    "type": "String(枚举值) - 类型标识 - [条件:决定显示不同图标/标签]",
    "{imageField}": "String - 图片URL - [UI:卡片.图片区.主图]",
    "{ratioField}": "Number - 宽高比 - [计算:高度=宽度/ratio]",
    "{textField}": "String - 文本内容 - [UI:卡片.文本区] [样式:14sp,最多2行,超出省略]",
    "{relatedUser}": {
      "_说明": "关联用户对象",
      "userId": "String - 用户ID - [用于:点击跳转用户主页]",
      "avatar": "String - 头像URL - [UI:卡片.用户区.头像] [样式:20x20圆形]",
      "nickname": "String - 昵称 - [UI:卡片.用户区.昵称]"
    },
    "{countField}": "Number - 计数 - [UI:卡片.统计区] [格式:>=10000显示1.2w]",
    "{statusField}": "Boolean - 状态标识 - [UI:状态图标] [true=激活样式,false=默认样式]",
    "createTime": "String(ISO8601) - 时间 - [格式:刚刚/X分钟前/昨天/MM-DD]"
  }
}
```

**【示例B：表单页】**
```json
{
  "响应数据": {
    "formConfig": {
      "fields": "Array<FieldConfig> - 表单字段配置 - [UI:表单区.字段列表]",
      "options": "Object - 选项数据 - [UI:下拉框/单选/多选的选项]",
      "limits": "Object - 限制条件 - [验证:字数限制/文件大小等]"
    },
    "initialData": {
      "_说明": "编辑模式时的原始数据",
      "{field1}": "类型 - 说明 - [UI:表单.字段1.默认值]",
      "{field2}": "类型 - 说明 - [UI:表单.字段2.默认值]"
    }
  }
}
```

**【示例C：详情页】**
```json
{
  "响应数据": {
    "basicInfo": {
      "_说明": "基础信息区域",
      "{主体字段}": "类型 - 说明 - [UI:详情.基础信息区]"
    },
    "statistics": {
      "_说明": "统计数据区域",
      "{count1}": "Number - 统计1 - [UI:详情.统计区.指标1]",
      "{count2}": "Number - 统计2 - [UI:详情.统计区.指标2]"
    },
    "relationStatus": {
      "_说明": "当前用户与主体的关系状态",
      "{isAction1}": "Boolean - 是否已操作1 - [UI:操作按钮1状态]",
      "{isAction2}": "Boolean - 是否已操作2 - [UI:操作按钮2状态]"
    }
  }
}
```

**【示例D：聚合页】**
```json
{
  "PageModel": {
    "_说明": "聚合页数据模型 - 多区块组合",

    "{BannerData}": {
      "_说明": "轮播区域 → [→{BannerSection}]",
      "{banners}": "Array<{BannerItem}> - 轮播列表 - [UI:轮播区]",
      "{BannerItem}": {
        "{imageUrl}": "String - 图片URL - [UI:轮播图]",
        "{linkUrl}": "String - 跳转链接 - [用于:点击跳转]",
        "{linkType}": "String(page|webview|deeplink) - 链接类型"
      }
    },

    "{EntryData}": {
      "_说明": "快捷入口区域 → [→{QuickEntrySection}]",
      "{entries}": "Array<{EntryItem}> - 入口列表 - [UI:金刚区]",
      "{EntryItem}": {
        "{icon}": "String - 图标URL - [UI:入口.图标]",
        "{title}": "String - 标题 - [UI:入口.文字]",
        "{link}": "String - 跳转链接"
      }
    },

    "{SectionList}": {
      "_说明": "内容区块列表 → 动态渲��多个区块",
      "{sections}": "Array<{SectionData}> - 区块列表",
      "{SectionData}": {
        "{sectionId}": "String - 区块ID - [用于:懒加载请求]",
        "{sectionType}": "String(recommend|hot|nearby) - 区块类型 - [条件:决定渲染样式]",
        "{title}": "String - 区块标题 - [UI:区块.标题]",
        "{moreLink}": "String? - 查看更多链接 - [UI:区块.更多] [可选]",
        "{items}": "Array<{ContentItem}> - 区块内容 - [UI:区块.列表]"
      }
    }
  }
}
```

### 业务逻辑标注速查表

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  标注类型        语法格式                    常见场景                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  条件显示        [条件:{字段}={值}]          type=video → 显示时长标签       │
│                  [条件:{字段}>0]             count>0 → 显示角标              │
│                  [条件:A且B]                 isVip且level>5 → 显示徽章       │
│                                                                             │
│  状态切换        [状态:{字段}]               isLiked: true→红心, false→空心  │
│                  [true→效果A, false→效果B]   isFollowed: true→已关注, false→关注 │
│                                                                             │
│  格式化          [格式:数字]                 count: <1000原样, >=10000显示Xw │
│                  [格式:时间]                 time: <1分钟'刚刚', <1小时'X分钟前' │
│                  [格式:大小]                 size: 自动转KB/MB/GB            │
│                  [格式:距离]                 distance: <1000显示Xm, >=1000显示Xkm │
│                                                                             │
│  计算字段        [计算:{公式}]               height = containerWidth * ratio │
│                                             progress = current/total * 100  │
│                                             remaining = total - used        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 STEP 2: 流程图模板

> **📌 目标**：基于 STEP 1 的数据模型，描述数据如何在页面流转，明确接口调用时机和用户操作路径
>
> **📤 产出**：
> - 页面初始化流程（进入页面 → 调用哪些接口 → 渲染数据）
> - 用户交互路径（列表交互、单项操作、导航跳转 → 触发哪些接口）
> - 状态管理流程（加载中、加载失败、空数据、到底了）
> - 流程与 STEP 6 接口的直接对应关系
> - 交互涉及的组件区域标注（→ STEP 3 弱关联）

### 流程与组件关联说明

```
标注格式：
├── [API:{接口标识}]     - 调用 STEP 6 定义的接口
├── [→{Area}]           - 数据渲染到 STEP 3 的组件区域
├── [触发:{Area}]       - 用户在某组件区域触发的操作
└── [状态:{Area}]       - 组件区域的状态变化

关联示意：
STEP 1 (数据模型)  ←──→  STEP 2 (流程)  ←──→  STEP 3 (组件)
   PageModel/ItemModel      数据流转              UI结构
         ↓                      ↓
   STEP 6 (接口)           触发接口调用
   API实现+数据库
```

### 通用流程图模板

```
开始
 ↓
【进入{页面名}】
 ├─→ 路由跳转: /{module}/{page}
 ├─→ Tab切换: 从{其他Tab}切换
 └─→ 深链接: {scheme}://{path}
 ↓
【页面初始化】
 │
 ├─→ 调用 [API:{configApi}] → 获取配置
 │    └─→ 渲染 [→{TabArea}] Tab列表
 │
 ├─→ 调用 [API:{listApi}] (page=1) → 获取首屏数据
 │    └─→ 渲染 [→{ContentArea}] 内容列表
 │
 └─→ 初始化监听
      ├─→ 滚动监听 → [触发:{ContentArea}]
      └─→ 下拉刷新监听 → [触发:{HeaderArea}]
 ↓
用户操作
 │
 ├─→ 【{ContentArea} 列表交互】
 │    │
 │    ├─→ 下拉刷新 [触发:{ContentArea}]
 │    │    ├─→ 调用 [API:{listApi}] (page=1)
 │    │    └─→ 清空重置 [状态:{ContentArea}]
 │    │
 │    ├─→ 上拉加载 [触发:{ContentArea}]
 │    │    ├─→ 调用 [API:{listApi}] (page+1)
 │    │    └─→ 追加数据 [状态:{ContentArea}]
 │    │
 │    └─→ 滚动浏览 → 图片懒加载
 │
 ├─→ 【{ItemComponent} 单项操作】
 │    │
 │    ├─→ 点击卡片 [触发:{ItemComponent}]
 │    │    └─→ 跳转 → 【{详情页}】(携带 {id})
 │    │
 │    └─→ 点击{操作按钮} [触发:{ItemComponent}.{ActionButton}]
 │         ├─→ 乐观更新 [状态:{ItemComponent}]
 │         ├─→ 调用 [API:{actionApi}]
 │         ├─→ 成功 → 保持状态 + [可选:Toast]
 │         └─→ 失败 → 回滚 [状态:{ItemComponent}] + Toast
 │
 ├─→ 【{TabArea} Tab切换】
 │    └─→ 点击{TabItem} [触发:{TabArea}]
 │         ├─→ 更新选中态 [状态:{TabArea}]
 │         ├─→ 调用 [API:{listApi}] (tab={tabKey}, page=1)
 │         └─→ 替换内容 [状态:{ContentArea}]
 │
 └─→ 【{TabBarArea} 导航跳转】
      └─→ 点击{NavItem} [触发:{TabBarArea}]
           └─→ 跳转 → 【{目标页面}】
 ↓
【状态管理】 [状态:{ContentArea}]
 ├─→ isLoading && page=1 → 显示骨架屏
 ├─→ isLoading && page>1 → 显示底部Loading
 ├─→ isError → 显示错误提示 → 点击重试
 ├─→ list.length=0 → 显示空状态插画
 └─→ hasMore=false → 显示"{到底文案}"
 ↓
结束
```

### 流程模式速查

```
按页面类型选择流程模式：

📋 列表页流程要点：
├── 初始化: [API:config] + [API:list(page=1)]
├── 刷新:   [API:list(page=1)] → 清空重置
├── 加载:   [API:list(page+1)] → 追加数据
├── 操作:   [API:action] → 乐观更新 + 回滚机制
└── 切换:   Tab切换 → 重新加载

📝 详情页流程要点：
├── 初始化: [API:detail(id)] + [API:comments(page=1)]
├── 评论:   [API:comments(page+1)] → 追加
├── 操作:   [API:action] → 收藏/点赞/分享
└── 提交:   [API:comment] → 发表评论 → 插入列表

✏️ 表单页流程要点：
├── 初始化: [API:formConfig] + [可选:API:detail(id)]
├── 输入:   字段校验 → 实时反馈
├── 上传:   [API:upload] → 获取URL
├── 草稿:   [API:draft] → 定时保存
└── 提交:   [API:submit] → 成功跳转/失败提示

🏠 聚合页流程要点：
├── 初始化: [API:home] → 多区块并行渲染
├── 懒加载: 滚动到区块 → [API:section(type)]
├── 刷新:   整体刷新 → 重新调用[API:home]
└── 跳转:   各区块独立跳转逻辑
```

### 流程-组件关联表模板

```markdown
| 流程节点 | 触发组件 | 调用接口 | 影响组件 | 状态变化 |
|----------|----------|----------|----------|----------|
| 页面初始化 | - | {configApi}, {listApi} | {TabArea}, {ContentArea} | loading→loaded |
| 下拉刷新 | {ContentArea} | {listApi}(page=1) | {ContentArea} | refreshing→loaded |
| 上拉加载 | {ContentArea} | {listApi}(page+1) | {ContentArea} | loadingMore→loaded |
| 点击卡片 | {ItemComponent} | - | - | 跳转{详情页} |
| 点击{操作} | {ItemComponent} | {actionApi} | {ItemComponent} | {状态}切换 |
| Tab切换 | {TabArea} | {listApi}(tab=X) | {ContentArea} | 内容替换 |
```

---
## 🌳 STEP 3: 树状图模板

> **📌 目标**：将 UI 页面拆解为层级结构，建立组件树，标注每个元素的数据来源（绑定 STEP 1 的字段）
>
> **📤 产出**：
> - L1/L2/L3 三层组件树状图
> - 每个组件的文件路径标注
> - 数据绑定标注（[data:字段名]）
> - 复用关系标注（← 复用XXX）
> - 标准 Area 命名（NavArea、ContentArea 等）

> **说明**：使用标准 `XXXArea` 命名体系，每个 Area 对应一个布局可视化模板（见 STEP 4）。
> `{xxx}` 表示需根据实际页面替换的占位符。

### 标准 Area 类型

```
页面级 Area（L2区域组件）：
├── NavArea          - 导航区（状态栏+导航栏）
├── TabNavArea       - Tab导航区（顶部Tab切换）
├── ContentListArea  - 内容列表区（瀑布流/网格卡片）
├── ListArea         - 垂直列表区（消息列表/设置列表）
├── FormArea         - 表单区（输入表单）
├── DetailArea       - 详情展示区（内容详情/用户信息）
├── ActionBarArea    - 操作栏区（底部操作按钮）
└── TabBarArea       - 底部导航区（App底部Tab）

子级组件（L3基础组件）：
├── CardItem         - 卡片项（用于ContentListArea）
├── ListItem         - 列表项（用于ListArea）
├── FormItem         - 表单项（用于FormArea）
└── TabItem          - 标签项（用于TabNavArea/TabBarArea）
```

### 通用树状图模板

```
【[模块名]】★★★
│
├── 【[主页面]】📱 [L1] [拆分:X个L2]
│   │   文件: {PageName}/index.[ext]
│   │
│   ├── 📍 {HeaderArea} [L2] [固定顶部]
│   │   │   文件: {HeaderArea}.[ext] 或 {HeaderArea}/
│   │   │   布局: 根据实际 UI 定义
│   │   └── ... [L3] 子组件
│   │
│   ├── 🏷️ {TabArea} [L2] [可选]
│   │   │   文件: {TabArea}.[ext]
│   │   └── 《TabItem》[L3] [1模板x{N}实例]
│   │
│   ├── 🏷️ {ContentArea} [L2] [flex:1, 可滚动]
│   │   │   文件: {ContentArea}/（复杂区域）
│   │   │   ├── index.[ext]
│   │   │   ├── types.[ext]
│   │   │   ├── use{ContentArea}.[ext]
│   │   │   │
│   │   │   └── {ItemComponent}/  [L3] 子组件
│   │   │       ├── index.[ext]
│   │   │       └── ...
│   │   │
│   │   └── 📋 Container [布局:根据UI定义]
│   │       └── 《{ItemComponent}》[L3] [1模板x{N}实例]
│   │           ├── ... 子元素结构
│   │           └── [data:{字段}] 数据绑定
│   │
│   ├── 📍 {ActionArea} [L2] [固定底部] [可选]
│   │   │   文件: {ActionArea}.[ext]
│   │   └── ... 操作按钮/输入框
│   │
│   └── 📍 {FooterArea} [L2] [固定底部] [可选]
│       │   文件: SharedComponents/TabBar/ (如为全局共享)
│       └── 《TabItem》[L3] [1模板x{N}实例]
│
├── 【子页面群】📱
│   ├── 【{页面A}】[L1] = {Area1} + {Area2} + ...
│   ├── 【{页面B}】[L1] = {Area1} + {Area3} + ...
│   └── ...
│
└── 🔧 服务层（对应 STEP 6 的接口）
    ├── 📡 GET /api/{module}/config    → 配置服务 [→ PageModel.{TabData}]
    ├── 📡 GET /api/{module}/list      → 列表服务 [→ PageModel.{ListData}]
    └── 📡 POST /api/{module}/{action} → 操作服务 [→ SharedModel.{ActionResult}]

树状图标注说明：
├── [L1/L2/L3/L4]  - 层级标识，对应 STEP 4 布局模板和 STEP 5 代码结构
├── [固定顶部/底部] - 位置固定，不随内容滚动
├── [flex:1, 可滚动] - 占据剩余空间，内容可滚动
├── [可选]          - 该区域根据页面需要可有可无
├── [1模板x{N}实例] - 模板复用，数据驱动渲染N个实例
├── [data:{字段}]   - 数据绑定，来自 STEP 1 的 JSON 契约
└── 文件:           - 对应 STEP 5 的代码文件路径
```

### 页面类型树状图变体

```
📝 详情页树状图：
├── 【{DetailPage}】📱 [L1]
│   ├── 📍 {HeaderArea} [L2] [固定顶部]
│   │   └── 返回 + 标题 + [分享/更多]
│   │
│   ├── 🏷️ {MediaArea} [L2] [可选]
│   │   └── 图片轮播/视频播放器 [data:{mediaData}]
│   │
│   ├── 🏷️ {DetailArea} [L2] [flex:1, 可滚动]
│   │   ├── 《AuthorInfo》[L3] [data:{authorData}]
│   │   ├── 《ContentBody》[L3] [data:{contentData}]
│   │   ├── 《StatsBar》[L3] [data:{statsData}]
│   │   └── 《CommentList》[L3] [data:{commentList}] [1模板x{N}实例]
│   │
│   └── 📍 {ActionBarArea} [L2] [固定底部]
│       └── 评论输入 + 点赞 + 收藏 + 分享

✏️ 表单页树状图：
├── 【{FormPage}】📱 [L1]
│   ├── 📍 {HeaderArea} [L2] [固定顶部]
│   │   └── 关闭/返回 + 标题 + [草稿]
│   │
│   ├── 🏷️ {FormArea} [L2] [flex:1, 可滚动]
│   │   ├── 《MediaUpload》[L3] [可选] [data:{mediaField}]
│   │   ├── 《TextInput》[L3] [data:{titleField}]
│   │   ├── 《TextArea》[L3] [data:{contentField}]
│   │   ├── 《TagSelector》[L3] [可选] [data:{tagsField}]
│   │   └── 《OptionPicker》[L3] [可选] [data:{optionField}]
│   │
│   └── 📍 {ActionBarArea} [L2] [固定底部]
│       └── [取消] + 「发布/提交」

🏠 聚合页树状图：
├── 【{HomePage}】📱 [L1]
│   ├── 📍 {HeaderArea} [L2] [固定顶部]
│   │   └── Logo + 搜索入口 + 消息入口
│   │
│   ├── 🏷️ {ContentArea} [L2] [flex:1, 可滚动]
│   │   ├── 《BannerSection》[L3] [data:{bannerData}]
│   │   ├── 《QuickEntrySection》[L3] [data:{entryData}]
│   │   ├── 《RecommendSection》[L3] [data:{recommendData}]
│   │   └── 《FeedSection》[L3] [data:{feedData}] [懒加载]
│   │
│   └── 📍 {TabBarArea} [L2] [固定底部]
│       └── 《TabItem》[L3] [1模板x{N}实例]
```

### 列表控制（通用）

```
🔄 ListControl [适用于 ContentListArea / ListArea]
├── 加载更多: 上滑 [距底100px] → 调用列表接口(page+1)
├── 下拉刷新: [阈值60px] → 调用列表接口(page=1)
├── 骨架屏: [条件:isLoading且page=1] 显示占位
├── 加载指示: [条件:isLoading且page>1] 显示底部loading
├── 空状态: [条件:list.length=0] 显示空状态插画
└── 到底提示: [条件:hasMore=false] "{到底文案}"
```

### 组件拆分规则

```
三层架构：
├── L1-页面: 完整页面 → 拆分 3-7 个 L2
├── L2-区域: 功能区块 → 拆分 2-6 个 L3
└── L3-基础: 最小单元 → 可复用组件

拆分数量参考：
├── 简单页面: L2×2-3 + L3×3-5 = 5-8 个组件
├── 中等页面: L2×4-6 + L3×8-12 = 12-18 个组件
└── 复杂页面: L2×6-10 + L3×15-25 = 21-35 个组件

复用标记：
├── ← 复用XXX        表示复用某组件
├── [1模板xN实例]    模板复用N次
├── [拆分:3个L3]     拆分为3个子组件
└── 复用性: 高(全局) / 中(跨页) / 低(页面内)
```

---

## 📍 STEP 4: 布局定位系统

> **📌 目标**：定义页面和组件的空间布局规则，确定每个元素的位置、尺寸、排列方式
>
> **📤 产出**：
> - 九宫格位置标注（TL/TC/TR/ML/MC/MR/BL/BC/BR）
> - 行列系统描述（[R1-C2]、[R1:R3]）
> - Flex/Grid 布局规则（flex-row、grid-cols-N）
> - 相对位置关系（↗️右上角、⬇️下方）
> - 布局层级定义（L1→L2→L3→L4 的布局职责）

### 九宫格位置
```
┌──────────────────────────────────────────┐
│  TL(左上)   │   TC(正上)   │   TR(右上)  │
├──────────────────────────────────────────┤
│  ML(左中)   │   MC(正中)   │   MR(右中)  │
├──────────────────────────────────────────┤
│  BL(左下)   │   BC(正下)   │   BR(右下)  │
└──────────────────────────────────────────┘
```

### 行列系统
```
[R1]: 第1行        [C1]: 第1列
[R1-C2]: 第1行第2列
[R1:R3]: 第1到3行
[R2-全行]: 第2行全宽
[R-Last]: 最后一行
```

### Flex/Grid布局
```
Flex:
├── flex-row / flex-col
├── space-between / center / start / end
├── flex-item:固定Npx / flex-1

Grid:
├── grid-cols-2 / grid-cols-3
├── gap-12px / gap-x-8px gap-y-12px
├── grid-item:R1-C1 / col-span-2
```

### 相对位置
```
↗️ 右上角    ↘️ 右下角    ↙️ 左下角    ↖️ 左上角
➡️ 右侧      ⬅️ 左侧      ⬆️ 上方      ⬇️ 下方
[偏移:-4px]  [间距:12px]
```

### 布局可视化模板系统

> **设计理念**：布局模板与代码结构一一对应，每个代码文件都有对应的布局描述。
> **查看方式**：STEP 4 定义布局基础规范，STEP 5 展示每个组件的具体布局。

#### 通用布局构建块

```
┌─────────────────────────────────────────────────────────────────┐
│  🔧 基础布局模式（可自由组合）                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  【垂直堆叠】flex-col          【水平排列】flex-row               │
│  ┌─────────────────┐          ┌─────────────────────────────┐   │
│  │    Section A    │          │  Left  │  Center  │  Right  │   │
│  ├─────────────────┤          └─────────────────────────────┘   │
│  │    Section B    │                                            │
│  ├─────────────────┤          【网格布局】grid-cols-{N}          │
│  │    Section C    │          ┌──────┬──────┬──────┐            │
│  └─────────────────┘          │  1   │  2   │  3   │            │
│                               ├──────┼──────┼──────┤            │
│  【嵌套容器】                   │  4   │  5   │  6   │            │
│  ┌─────────────────┐          └──────┴──────┴──────┘            │
│  │ ┌─────┬───────┐ │                                            │
│  │ │     │       │ │          【绝对定位叠层】                    │
│  │ │ A   │   B   │ │          ┌─────────────────┐               │
│  │ │     │       │ │          │     Base        │               │
│  │ └─────┴───────┘ │          │        ┌──────┐ │               │
│  │ ┌─────────────┐ │          │        │Overlay│ │               │
│  │ │      C      │ │          │        └──────┘ │               │
│  │ └─────────────┘ │          └─────────────────┘               │
│  └─────────────────┘                                            │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘

布局属性速记：
├── 方向:    flex-col | flex-row
├── 对齐:    center | start | end | space-between | space-around
├── 换行:    flex-wrap | nowrap
├── 间距:    gap-{N}px | gap-x-{N}px gap-y-{N}px
├── 弹性:    flex-1 | flex:固定{N}px | flex:auto
├── 网格:    grid-cols-{N} | grid-rows-{N}
├── 滚动:    scroll-y | scroll-x | scroll-none
└── 定位:    relative | absolute | fixed | sticky
```

#### 布局层级定义

```
层级      代码对应                  布局职责
─────────────────────────────────────────────────────────
L1       index.[ext] (页面)        组合 L2 区域，定义整体结构
L2       XXXArea.[ext|/]           区域内部布局，可包含 L3
L3       {SubComponent}/           可复用子组件布局
L4       SharedComponents/         跨模块共享组件布局
```

> **详细布局模板见 STEP 5**：每个代码文件都配有对应的布局可视化图。

---

## 📁 STEP 5: 代码结构映射（含布局模板）

> **📌 目标**：将 UI 结构映射为可执行的代码文件组织，定义每个文件的职责和对应的布局模板
>
> **📤 产出**：
> - 完整的文件夹/文件结构树（可直接创建）
> - 每个代码文件对应的 ASCII 布局可视化图
> - 🟢 简单区域（单文件）与 🔵 复杂区域（文件夹）的划分
> - 文件命名规范（index、types、hooks、api 等）
> - 模块级/页面级/区域级的代码组织

> **核心理念**：每个代码文件都有对应的布局模板，代码结构与 UI 布局一一映射。

### 架构理念：薄页面、厚组件
```
模块 → 多个页面 → 多个区域组件

├─ 模块级：共享数据/缓存/状态（api/, stores/, hooks/）
├─ 页面级：页面专属逻辑（api/, hooks/）+ 组合区域组件
└─ 区域组件：核心单元，具体逻辑实现都在这里

区域组件两种形式：
├─ 🟢 简单区域：XXXArea.[ext] 单文件（命名必须以Area结尾）
└─ 🔵 复杂区域：XXXArea/ 文件夹（内含完整结构）
```

### Modules 模块结构（含布局模板）

```
src/modules/
│
├─ {ModuleName}/                         # 业务功能模块
│   │
│   ├─ api/                              # 模块级API（对应 STEP 6 的接口定义）
│   │   ├─ apiGetConfig.ts
│   │   ├─ apiGetList.ts
│   │   └─ apiPostAction.ts
│   │
│   ├─ stores/                           # 模块级状态
│   ├─ hooks/                            # 模块级Hooks
│   │
│   │   ┌─────────────────────────────────────────────────────────────┐
│   │   │  📱 页面 [L1] - {PageName}/index.[ext]                       │
│   │   ├─────────────────────────────────────────────────────────────┤
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  {HeaderArea} [L2]                                   │   │ 固定
│   │   │  └─────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  {TabArea} [L2] (可选)                               │   │ 固定
│   │   │  └─────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  {ContentArea} [L2]                                 │   │
│   │   │  │    └── {ItemComponent} [L3] x N                     │   │ flex:1
│   │   │  └─────────────────────────────────────────────────────┘   │ 可滚动
│   │   │  ┌─────────────────────────────────────────────────────┐   │
│   │   │  │  {FooterArea} [L2] (可选)                            │   │ 固定
│   │   │  └─────────────────────────────────────────────────────┘   │
│   │   │  布局: flex-col | 组合 L2 区域                              │
│   │   └─────────────────────────────────────────────────────────────┘
│   │
│   ├─ {PageName}/                       # 页面文件夹
│   │   │
│   │   ├─ index.[ext]                   # 页面主文件 [L1]
│   │   ├─ api/                          # 页面级API（可选）
│   │   ├─ hooks/                        # 页面级Hooks（可选）
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🟢 简单区域 [L2] - {HeaderArea}.[ext]                   │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌────┐      ┌──────────────┐      ┌────┐              │
│   │   │   │  │ ← │      │    {标题}     │      │ ⋮ │              │
│   │   │   │  └────┘      └──────────────┘      └────┘              │
│   │   │   │  [TL]            [TC]              [TR]                │
│   │   │   │  布局: flex-row, space-between | 高度: 固定              │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ {HeaderArea}.[ext]            # 🟢 简单区域（单文件）
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🟢 简单区域 [L2] - {TabArea}.[ext]                      │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │     ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐            │
│   │   │   │     │Tab 1 │  │Tab 2 │  │Tab 3 │  │Tab N │            │
│   │   │   │     │ ━━━  │  │      │  │      │  │      │            │
│   │   │   │     └──────┘  └──────┘  └──────┘  └──────┘            │
│   │   │   │     [选中]    [默认]    [默认]    [默认]               │
│   │   │   │  布局: flex-row, center, gap-{N}px | 高度: 固定          │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   ├─ {TabArea}.[ext]               # 🟢 简单区域（单文件）
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🔵 复杂区域 [L2] - {ContentArea}/                       │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌──────────────┐  ┌──────────────┐                    │
│   │   │   │  │  ┌────────┐  │  │  ┌────────┐  │                    │
│   │   │   │  │  │  媒体   │  │  │  │  媒体   │  │                    │
│   │   │   │  │  └────────┘  │  │  └────────┘  │                    │
│   │   │   │  │  {文本内容}   │  │  {文本内容}   │  ... x N           │
│   │   │   │  │  👤 昵称 ❤️  │  │  👤 昵称 ❤️  │                    │
│   │   │   │  └──────────────┘  └──────────────┘                    │
│   │   │   │       [L3]              [L3]                           │
│   │   │   │  布局: grid-cols-{N}, gap-{N}px | 滚动: scroll-y         │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   └─ {ContentArea}/                # 🔵 复杂区域（文件夹）
│   │       │
│   │       ├─ index.[ext]               # 区域主文件
│   │       ├─ types.[ext]               # 类型定义
│   │       ├─ constants.[ext]           # 常量
│   │       ├─ use{ContentArea}.[ext]    # 状态管理Hook
│   │       │
│   │       │   ┌─────────────────────────────────────────────────────┐
│   │       │   │  🧩 子组件 [L3] - {ItemComponent}/                   │
│   │       │   ├─────────────────────────────────────────────────────┤
│   │       │   │  ┌─────────────────────────────────────────────┐   │
│   │       │   │  │  ┌─────────────────────────────────────┐   │   │
│   │       │   │  │  │           {媒体区域}                 │   │   │
│   │       │   │  │  │           [可带角标]                 │   │   │
│   │       │   │  │  └─────────────────────────────────────┘   │   │
│   │       │   │  │  ┌─────────────────────────────────────┐   │   │
│   │       │   │  │  │           {文本区域}                 │   │   │
│   │       │   │  │  └─────────────────────────────────────┘   │   │
│   │       │   │  │  ┌─────────────────────────────────────┐   │   │
│   │       │   │  │  │  {用户}              {操作}          │   │   │
│   │       │   │  │  └─────────────────────────────────────┘   │   │
│   │       │   │  └─────────────────────────────────────────────┘   │
│   │       │   │  布局: flex-col | 复用: 1模板 x N实例                │
│   │       │   └─────────────────────────────────────────────────────┘
│   │       │
│   │       └─ {ItemComponent}/          # 子组件文件夹 [L3]
│   │           ├─ index.[ext]           # 子组件主文件
│   │           ├─ types.[ext]           # 类型（可选）
│   │           └─ on{Action}.[ext]      # 事件处理（可选）
│   │
│   │   ┌─────────────────────────────────────────────────────────────┐
│   │   │  🔄 共享组件 [L4] - SharedComponents/                        │
│   │   ├─────────────────────────────────────────────────────────────┤
│   │   │                                                             │
│   │   │  特点: 跨页面复用 | 高度可配置 | 样式可定制                   │
│   │   │                                                             │
│   │   │  常见组件:                                                   │
│   │   │  ├── Button/    Avatar/    Badge/    Modal/                 │
│   │   │  ├── Toast/     Loading/   Empty/    Card/                  │
│   │   │  └── TabBar/    List/      Input/    ...                    │
│   │   │                                                             │
│   │   └─────────────────────────────────────────────────────────────┘
│   │
│   ├─ SharedComponents/                 # 模块共享组件 [L4]
│   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐
│   │   │   │  🔄 TabBar/ [L4]                                         │
│   │   │   ├─────────────────────────────────────────────────────────┤
│   │   │   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐      │
│   │   │   │  │   🏠    │ │   🔍    │ │   💬    │ │   👤    │      │
│   │   │   │  │  [🔴]   │ │         │ │  [🔴]   │ │         │      │
│   │   │   │  │  首页   │ │  发现   │ │  消息   │ │  我的   │      │
│   │   │   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘      │
│   │   │   │  布局: flex-row, 均分 | 高度: 80px + 安全区              │
│   │   │   └─────────────────────────────────────────────────────────┘
│   │   │
│   │   └─ {ComponentName}/
│   │       ├─ index.[ext]
│   │       ├─ types.[ext]
│   │       └─ styles.[ext]
│   │
│   └─ index.[ext]                       # 模块入口
│
└─ Common/                               # 公共模块
    ├─ components/                       # 全局共享组件
    │   ├─ TabBar/
    │   └─ WaterfallList/
    └─ api/
        └─ apiGetTabbar.ts
```

### 布局模板快速参考

```
根据 UI 特征选择对应布局：

页面类型           L2区域组合                        主内容区布局
─────────────────────────────────────────────────────────────────────────
列表页            Header + [Tab] + Content + TabBar   grid-cols-N / flex-col
详情页            Header + Content + ActionBar        flex-col, scroll-y
表单页            Header + Form + ActionBar           flex-col, gap-{N}px
聚合页            Header + 多Section + TabBar         flex-col, 各Section独立

子组件类型         布局模式
─────────────────────────────────────────────────────────────────────────
卡片组件           flex-col: 媒体 → 文本 → 信息行
列表项组件         flex-row: 左(固定) → 中(flex-1) → 右(固定)
表单项组件         flex-col: 标签 → 输入 → 错误提示
Tab项组件          flex-col, center: 图标 → 文字 → 角标(叠层)
```

### 文件命名规范
```
类型          命名格式                        示例
─────────────────────────────────────────────────────────
主组件        index.[ext]                     index.tsx
类型定义      types.[ext]                     types.ts
常量          constants.[ext]                 constants.ts
状态管理      use{Name}.[ext]                 useLoginArea.ts
事件处理      on{Name}[Action].[ext]          onPhoneChange.ts
导航          navigateTo{Target}.[ext]        navigateToProfile.ts
API接口       api{Name}[Action].[ext]         apiUserLogin.ts
数据处理      process{Name}[Data].[ext]       processUserData.ts
```

---

## 🗄️ STEP 6: 接口实现与后端设计

> **📌 目标**：基于 STEP 1 的数据模型，定义完整的 API 接口实现，并设计支撑数据库
>
> **📤 产出**：
> - 完整的接口定义（路径、方法、请求/响应）
> - 接口与 STEP 1 数据模型的映射关系
> - 核心数据库表设计（建表 SQL）
> - 核心 SQL 查询语句
> - MVP 清单表（功能、涉及表、接口、优先级）

### 设计理念

```
STEP 1 → STEP 6 的映射关系：

┌─────────────────────────────────────────────────────────────────────────┐
│  STEP 1: 数据模型（前端需要什么）     STEP 6: 接口实现（后端如何提供）  │
│  ──────────────────────────────       ───────────────────────────────   │
│                                                                         │
│  PageModel                       →    页面初始化时调用的接口组合         │
│    ├─ {TabData}                  →    GET /api/{module}/config          │
│    ├─ {ListData}                 →    GET /api/{module}/list            │
│    └─ {ActionResult}             →    POST /api/{module}/{action}       │
│                                                                         │
│  ItemModel                       →    list 接口的 data.list[] 结构      │
│    ├─ {authorData}               →    JOIN users 表                     │
│    ├─ {statsData}.{isLiked}      →    LEFT JOIN {关系}表                │
│    └─ {statsData}.{likeCount}    →    {主体}表.like_count 冗余字段      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 接口分类体系

```
按触发时机分类（对应 STEP 2 流程）：
├── 🔄 初始化接口 - 页面加载时调用 → [API:{configApi}] [API:{listApi}]
├── 📜 列表接口 - 分页/刷新/加载更多 → [API:{listApi}]
├── 🎯 操作接口 - 用户交互触发 → [API:{actionApi}]
├── 🔧 配置接口 - 获取静态配置（可缓存）
└── 🌐 公共接口 - 跨页面共享（底部导航等）

按数据流向分类：
├── 📥 读取类 - GET 请求，返回 STEP 1 定义的数据模型
├── 📤 写入类 - POST/PUT/DELETE 请求，返回 ActionResult
└── 📡 实时类 - WebSocket，推送更新
```

### 接口定义模板

```json
{
  "接口文档信息": {
    "对应页面": "{PageName}",
    "对应数据模型": "STEP 1 → PageModel",
    "版本": "v1.0"
  },

  "接口列表": [
    {
      "序号": 1,
      "接口名": "获取{主体}列表",
      "接口标识": "{listApi}",
      "路径": "GET /api/{module}/list",
      "触发时机": "[API:{listApi}] 页面初始化/下拉刷新/上拉加载/Tab切换",
      "对应数据模型": "STEP 1 → PageModel.{ListData}",

      "请求参数": {
        "{tab}": "String? - Tab标识 - 来自 STEP 1 → {TabItem}.{key}",
        "{page}": "Number - 页码 - 默认1",
        "{pageSize}": "Number - 每页数量 - 默认20",
        "{筛选条件}": "类型? - 说明 - [可选]"
      },

      "响应数据": {
        "code": "Number - 状态码 - 200成功",
        "message": "String - 提示信息",
        "data": {
          "_映射": "→ STEP 1: PageModel.{ListData}",
          "{list}": "Array<{ContentItem}> - 内容列表",
          "{hasMore}": "Boolean - 是否有更多",
          "{total}": "Number? - 总数"
        }
      },

      "响应示例": {
        "code": 200,
        "message": "success",
        "data": {
          "list": [
            {
              "id": "123",
              "mediaData": { "coverUrl": "...", "aspectRatio": 0.75 },
              "textData": { "title": "..." },
              "authorData": { "userId": "u1", "nickname": "...", "avatar": "..." },
              "statsData": { "likeCount": 1234, "isLiked": false }
            }
          ],
          "hasMore": true,
          "total": 100
        }
      },

      "数据库映射": {
        "_说明": "此接口数据来源",
        "{list}[].{id}": "{主体表}.id",
        "{list}[].{mediaData}": "{主体表}.cover_url, {主体表}.aspect_ratio",
        "{list}[].{authorData}": "JOIN users ON {主体表}.user_id = users.id",
        "{list}[].{statsData}.{isLiked}": "LEFT JOIN {关系表} 判断当前用户"
      }
    },

    {
      "序号": 2,
      "接口名": "获取配置",
      "接口标识": "{configApi}",
      "路径": "GET /api/{module}/config",
      "触发时机": "[API:{configApi}] 页面初始化",
      "缓存策略": "本地缓存 30min",
      "对应数据模型": "STEP 1 → PageModel.{TabData}",

      "请求参数": {},

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "_映射": "→ STEP 1: PageModel.{TabData}",
          "{tabs}": "Array<{TabItem}> - Tab列表"
        }
      }
    },

    {
      "序号": 3,
      "接口名": "{操作}动作",
      "接口标识": "{actionApi}",
      "路径": "POST /api/{module}/{action}",
      "触发时机": "[API:{actionApi}] 点击{操作按钮}",
      "对应数据模型": "STEP 1 → SharedModel.{ActionResult}",

      "请求参数": {
        "{targetId}": "String - 目标ID - 来自 STEP 1 → {ContentItem}.{id}",
        "{action}": "String(like|unlike|follow|unfollow) - 操作类型"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "_映射": "→ STEP 1: SharedModel.{ActionResult}",
          "{success}": "Boolean - 是否成功",
          "{newValue}": "Number? - 新的计数值（如点赞后的新数量）"
        }
      },

      "数据库操作": {
        "like": "INSERT INTO {关系表} + UPDATE {主体表}.like_count +1",
        "unlike": "DELETE FROM {关系表} + UPDATE {主体表}.like_count -1"
      }
    }
  ]
}
```

### 常见页面类型的接口模式

```
📋 列表页接口组合：
├── GET  /api/{module}/config         → PageModel.{TabData}
├── GET  /api/{module}/list           → PageModel.{ListData}
└── POST /api/{module}/{action}       → SharedModel.{ActionResult}

📝 详情页接口组合：
├── GET  /api/{module}/{id}           → PageModel.{DetailData}
├── GET  /api/{module}/{id}/comments  → PageModel.{CommentListData}
├── POST /api/{module}/{id}/comment   → SharedModel.{ActionResult}
└── POST /api/{module}/{id}/{action}  → SharedModel.{ActionResult}

✏️ 表单页接口组合：
├── GET  /api/{module}/form-config    → PageModel.{FormConfig}
├── GET  /api/{module}/{id}           → PageModel.{InitialData} (编辑模式)
├── POST /api/{module}/upload         → {url, thumbnailUrl}
├── POST /api/{module}/draft          → {draftId}
└── POST /api/{module}/submit         → SharedModel.{ActionResult}

🏠 聚合页接口组合：
├── GET  /api/{module}/home           → PageModel (多区块)
└── GET  /api/{module}/section/{type} → PageModel.{SectionData}
```

### 接口汇总表模板

```markdown
| 序号 | 接口标识 | 方法 | 路径 | 对应数据模型 | 触发时机 | 缓存 |
|------|----------|------|------|--------------|----------|------|
| 1 | {listApi} | GET | /api/{module}/list | {ListData} | 初始化/刷新/加载 | 无 |
| 2 | {configApi} | GET | /api/{module}/config | {TabData} | 初始化 | 30min |
| 3 | {actionApi} | POST | /api/{module}/{action} | {ActionResult} | 点击{操作} | 无 |
```

---

### 数据库设计

#### 设计原则

```
MVP = Minimum Viable Product（最小可行产品）

核心原则：
├─ 只设计核心表，不过度设计
├─ 只实现必要字段，后续迭代增加
├─ 冗余计数字段（如like_count），避免频繁COUNT
├─ 先跑通流程，再优化性能
└─ 一个页面通常只需要 3-5 张表
```

#### 从数据模型推导数据库表

```
STEP 1 数据模型                    →     数据库表推导
─────────────────────────────────────────────────────────────
{ContentItem}.{authorData}         →     users 表
  ├─ {userId}                            ├─ id
  ├─ {nickname}                          ├─ nickname
  └─ {avatar}                            └─ avatar

{ContentItem}.{mediaData/textData} →     {主体}表
  ├─ {id}                                ├─ id
  ├─ {coverUrl}                          ├─ cover_url
  ├─ {title}                             ├─ title
  └─ ...                                 └─ user_id (FK → users)

{ContentItem}.{statsData}          →     冗余字段 + 关系表
  ├─ {likeCount}                         {主体}表.like_count (冗余)
  └─ {isLiked}                           {关系}表.user_id 判断

推导规则：
├── 嵌套对象（如 authorData） → 独立表 + 外键关联
├── 计数字段（如 likeCount） → 主体表冗余字段
├── 状态字段（如 isLiked）   → 关系表判断当前用户
└── 数组字段（如 tags）      → 子表 + 外键关联
```

#### 数据库表模板

```sql
-- 用户表（对应 STEP 1: SharedModel.{UserInfo}）
CREATE TABLE users (
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    nickname    VARCHAR(50) NOT NULL COMMENT '昵称 → {nickname}',
    avatar      VARCHAR(500) COMMENT '头像URL → {avatar}',
    level       INT DEFAULT 1 COMMENT '等级 → {level}',
    is_vip      TINYINT DEFAULT 0 COMMENT 'VIP状态 → {isVip}',
    created_at  DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at  DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT '用户表 → SharedModel.{UserInfo}';

-- 内容/主体表（对应 STEP 1: ItemModel.{ContentItem}）
CREATE TABLE {主体表名} (
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id     BIGINT NOT NULL COMMENT '创建者ID → {authorData}.{userId}',

    -- 媒体数据 → {mediaData}
    cover_url   VARCHAR(500) COMMENT '封面URL → {coverUrl}',
    aspect_ratio DECIMAL(4,2) DEFAULT 1.0 COMMENT '宽高比 → {aspectRatio}',
    duration    INT COMMENT '时长(秒) → {duration}',

    -- 文本数据 → {textData}
    title       VARCHAR(200) NOT NULL COMMENT '标题 → {title}',
    description TEXT COMMENT '描述 → {description}',

    -- 统计数据 → {statsData} (冗余字段)
    like_count  INT UNSIGNED DEFAULT 0 COMMENT '点赞数 → {likeCount}',
    comment_count INT UNSIGNED DEFAULT 0 COMMENT '评论数 → {commentCount}',

    -- 元信息 → {metaData}
    type        VARCHAR(20) DEFAULT 'image' COMMENT '类型 → {type}',
    location    VARCHAR(100) COMMENT '位置 → {location}',
    status      TINYINT DEFAULT 1 COMMENT '状态: 0=删除, 1=正常',
    created_at  DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '→ {createTime}',
    updated_at  DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_user_id (user_id),
    INDEX idx_status_created (status, created_at DESC)
) COMMENT '{主体}表 → ItemModel.{ContentItem}';

-- 关系表（用于判断 STEP 1: {statsData}.{isLiked} 等状态）
CREATE TABLE {主体}_likes (
    id          BIGINT PRIMARY KEY AUTO_INCREMENT,
    {主体}_id   BIGINT NOT NULL COMMENT '主体ID',
    user_id     BIGINT NOT NULL COMMENT '用户ID',
    created_at  DATETIME DEFAULT CURRENT_TIMESTAMP,

    UNIQUE KEY uk_like ({主体}_id, user_id),
    INDEX idx_user_id (user_id)
) COMMENT '点赞关系表 → 判断 {isLiked}';
```

#### 核心SQL模板

```sql
-- 列表查询（返回 STEP 1: PageModel.{ListData}）
SELECT
    -- {ContentItem}.{id}
    m.id,

    -- {ContentItem}.{mediaData}
    m.cover_url AS coverUrl,
    m.aspect_ratio AS aspectRatio,
    m.duration,

    -- {ContentItem}.{textData}
    m.title,
    m.description,

    -- {ContentItem}.{authorData} ← JOIN users
    u.id AS authorUserId,
    u.nickname AS authorNickname,
    u.avatar AS authorAvatar,

    -- {ContentItem}.{statsData}
    m.like_count AS likeCount,
    m.comment_count AS commentCount,
    IF(l.id IS NOT NULL, 1, 0) AS isLiked,  -- ← LEFT JOIN 关系表

    -- {ContentItem}.{metaData}
    m.type,
    m.location,
    m.created_at AS createTime

FROM {主体表} m
INNER JOIN users u ON m.user_id = u.id
LEFT JOIN {主体}_likes l ON m.id = l.{主体}_id AND l.user_id = #{currentUserId}
WHERE m.status = 1
ORDER BY m.created_at DESC
LIMIT #{pageSize} OFFSET #{offset};

-- 点赞操作（更新 {isLiked} 和 {likeCount}）
-- like:
INSERT INTO {主体}_likes ({主体}_id, user_id) VALUES (#{id}, #{userId});
UPDATE {主体表} SET like_count = like_count + 1 WHERE id = #{id};

-- unlike:
DELETE FROM {主体}_likes WHERE {主体}_id = #{id} AND user_id = #{userId};
UPDATE {主体表} SET like_count = GREATEST(like_count - 1, 0) WHERE id = #{id};
```

### 后端MVP清单模板

```markdown
| 序号 | 功能 | 对应数据模型 | 涉及表 | 接口 | 优先级 |
|------|------|--------------|--------|------|--------|
| 1 | 列表查询 | {ListData} | users, {主体表} | GET /list | P0 |
| 2 | 配置获取 | {TabData} | {config表} | GET /config | P0 |
| 3 | 点赞操作 | {ActionResult} | {关系表}, {主体表} | POST /like | P0 |
| 4 | 分页支持 | {PaginationInfo} | - | query params | P0 |

MVP统计：{N}张表 + {M}个接口 = 最小可行后端
```

### 性能优化检查点

```
□ 索引：主要查询字段是否有索引？
□ 冗余：频繁COUNT的字段是否冗余存储？
□ 分页：是否使用LIMIT OFFSET？（大数据量需改游标分页）
□ N+1：是否存在循环查询？（改为JOIN或批量查询）
□ 缓存：热点数据是否缓存？（用户信息、配置信息）
```

---

## 📱 响应式规格

```
手机: 320-428px  │ grid-cols-1/2 │ gap-8-12px │ 14-16sp
平板: 768-1024px │ grid-cols-2/3 │ gap-12-16px │ 16-18sp
桌面: 1280px+    │ grid-cols-3/4 │ gap-16-24px │ 18-20sp
```

---

## 💡 快速参考

### 符号系统

```
元素标记：
【页面】📱   《组件》📋   「按钮/功能」   (注：说明)

标注语法：
├── 位置: [位置:TL/TC/TR/ML/MC/MR/BL/BC/BR]
├── 行列: [R1-C2] [R1:R3-全行] [R-Last]
├── 布局: [布局:flex-row] [布局:grid-cols-2] [gap-12px]
├── 层级: [L1-页面] [L2-区域] [L3-基础]
├── 拆分: [拆分:3个L3] [1模板x4实例] ← 复用XXX
├── 相对: [↗️右上角] [➡️右侧] [⬇️下方] [间距:12px]
├── 尺寸: [尺寸:48x48px] [高度:56px] [圆角:12px]
├── 样式: (白色背景+圆角12px+阴影2px) (16sp#333333粗体)
├── 数据: [data:字段名] ← 绑定 STEP 1 数据模型
└── 接口: [API:xxx] ← 调用 STEP 6 接口
```

### 描述流程
```
1. 层级 [L1/L2/L3]
2. 位置 [R1-C2] 或 [位置:TL]
3. 布局 [布局:flex-row]
4. 尺寸 [尺寸:48x48px]
5. 样式 (白色+圆角12px)
6. 相对 [↗️XXX右上角]
7. 数据 [data:fieldName] ← 绑定 STEP 1
8. 交互 点击→跳转 ← 关联 STEP 2
9. 复用 ← 复用XXX
```

### 常用位置
```
返回按钮: [位置:TL] [R2-C1]
页面标题: [位置:TC] [R2-居中]
操作按钮: [位置:TR] [R2-C-Last]
用户头像: [位置:行首] [flex:固定48px]
时间戳:   [位置:行末] [⬇️标题下方]
未读角标: [↗️头像右上角, 偏移:-4px]
底部导航: [R-Last-全行] [固定底部]
```

---

## 🎯 期望效果

### 输入 UI 图后可实现
```
✅ 完整的JSON数据契约（前后端对齐）          ← 新增
✅ 完整的页面结构树状图（层级清晰、数据绑定）
✅ 精准的组件拆分方案（L1/L2/L3三层）
✅ 详细的布局定位描述（九宫格、行列、可视化图）
✅ 清晰的用户操作流程图（入口、路径、状态）
✅ 规范的代码文件结构（模块→页面→区域组件）
✅ 最小可行后端设计（表结构、SQL、接口实现）  ← 新增
```

### 质量评估标准
```
评分维度              优秀(9-10)              良好(7-8)           合格(5-6)
─────────────────────────────────────────────────────────────────────────────
数据模型      模型完整+字段绑定UI     模型完整            主要模型有定义
结构完整性    所有元素都有层级标注    90%元素有标注       主要元素有标注
数据绑定      所有动态数据有标注      主要数据有标注      有部分标注
位置精确度    精确到像素和间距        有行列和九宫格      有大致位置
组件拆分      L1/L2/L3清晰合理        层级基本清晰        有基本拆分
复用标记      模板和实例标记完整      主要复用有标记      有部分标记
交互描述      所有交互都有描述        主要交互有描述      有基本交互
代码映射      完整对应文件结构        主要组件有映射      有基本映射
接口+后端    接口对应模型+表SQL完整   有接口和表结构      有基本设计
```

### 综合评分目标
```
🎯 目标分数：8分以上

达到8分标准：
├─ 数据模型覆盖所有组件，字段与UI绑定清晰
├─ 流程图清晰标注数据流转和接口调用
├─ 树状图覆盖所有可见元素，标注数据来源
├─ 每个元素都有位置和尺寸描述
├─ 组件拆分层级清晰（L1→L2→L3）
├─ 复用关系标记完整
├─ 代码结构可直接指导开发
└─ 接口对应数据模型，数据库可直接建表
```

---

## 📝 完整输出模板

当收到UI图时，按以下顺序输出：

```markdown
# 🌳 [页面名称] 结构指导文档

> **页面名称：** XXX
> **所属模块：** XXX
> **页面类型：** 列表页/详情页/表单页

---

## 📋 STEP 1: 页面数据模型

### PageModel
[页面级数据模型JSON]

### ItemModel
[列表项数据模型JSON]

### 数据模型汇总
| 模型名 | 层级 | 对应组件 | 说明 |

---

## 🔄 STEP 2: 流程图

[用户操作流程 - 标注数据模型和组件关联]

### 流程-数据关联表
| 流程节点 | 触发组件 | 数据模型 | 影响组件 |

---

## 🌳 STEP 3: 树状图

[带数据绑定的树状图 - 标注 → STEP 1 数据模型]

---

## 📍 STEP 4: 布局定位

[可视化布局图]

---

## 📁 STEP 5: 代码结构

[文件夹结构]

---

## 🗄️ STEP 6: 接口实现与后端设计

### 接口定义
[接口列表JSON - 对应 STEP 1 数据模型]

### 接口汇总表
| 序号 | 接口标识 | 方法 | 路径 | 对应数据模型 | 触发时机 |

### 数据库表设计
[建表SQL - 字段对应 STEP 1 数据模型]

### 核心SQL查询
[查询SQL]

### MVP清单
| 序号 | 功能 | 对应数据模型 | 涉及表 | 接口 | 优先级 |

---

## 🎯 质量评估

| 维度 | 评分 | 说明 |
```

---

*v5.4 - JSON契约优先 + 六步法 + 后端MVP = 完整开发指导*

*v5.4更新：*
- *精简 STEP 1：条件/格式化/计算字段模式合并为速查表*
- *补充 STEP 1：新增聚合页数据模型示例（示例D）*
- *补充 STEP 3：新增详情页/表单页/聚合页树状图变体*
- *整合组件拆分：从独立章节合并到 STEP 3 末尾*

*v5.3更新：*
- *新增六步关联图：清晰展示 STEP 1-6 的横向关联关系*
- *修正 STEP 2 引用：流程图中的接口调用现正确指向 STEP 6*
- *统一术语：STEP 1 = 数据模型(What)，STEP 6 = 接口实现(How)*
- *整合符号系统：移至快速参考部分，新增 [API:xxx] 标注*
- *强化服务层关联：STEP 3/5 的 api/ 说明现指向 STEP 6*

*v5.2更新：*
- *通用化改造：将具体示例改为`{占位符}`格式，适用于任意业务场景*
- *新增多场景示例：列表页、表单页、详情页的JSON绑定示例*
- *树状图增加三种模式：网格列表、垂直列表、表单*
- *条件字段标注改为通用模式说明*
- *修正Features→Modules命名一致性*

---

## ⚠️ 重要要求

### 输出要求：必须产出完整文档

**收到UI图/设计稿后，必须严格按照六步法输出一份完整、连贯的结构指导文档，不得遗漏任何步骤。**

```
✅ 必须包含的内容（缺一不可）：

┌─────────────────────────────────────────────────────────────────────────┐
│  □ STEP 1: 页面数据模型                                                  │
│     ├── PageModel 完整定义                                               │
│     ├── ItemModel 完整定义                                               │
│     ├── SharedModel（如有复用）                                          │
│     └── 数据模型汇总表                                                   │
├─────────────────────────────────────────────────────────────────────────┤
│  □ STEP 2: 流程图                                                        │
│     ├── 页面初始化流程                                                   │
│     ├── 用户交互路径（所有可点击元素）                                    │
│     ├── 状态管理流程                                                     │
│     └── 流程-组件关联表                                                  │
├─────────────────────────────────────────────────────────────────────────┤
│  □ STEP 3: 树状图                                                        │
│     ├── L1/L2/L3 完整层级结构                                            │
│     ├── 每个组件的文件路径                                               │
│     ├── 数据绑定标注 [data:字段名]                                       │
│     └── 复用关系标注                                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  □ STEP 4: 布局定位                                                      │
│     ├── 页面整体布局图（ASCII可视化）                                    │
│     ├── 各区域布局详图                                                   │
│     ├── 九宫格/行列位置标注                                              │
│     └── Flex/Grid 布局规则                                               │
├─────────────────────────────────────────────────────────────────────────┤
│  □ STEP 5: 代码结构                                                      │
│     ├── 完整文件夹/文件树                                                │
│     ├── 🟢简单区域 vs 🔵复杂区域 划分                                    │
│     ├── 每个文件对应的布局模板                                           │
│     └── 文件命名规范说明                                                 │
├─────────────────────────────────────────────────────────────────────────┤
│  □ STEP 6: 接口实现与后端设计                                            │
│     ├── 完整接口定义（JSON格式）                                         │
│     ├── 接口汇总表                                                       │
│     ├── 数据库表设计（建表SQL）                                          │
│     ├── 核心SQL查询                                                      │
│     └── MVP清单表                                                        │
├─────────────────────────────────────────────────────────────────────────┤
│  □ 质量评估                                                              │
│     └── 按评分维度自评（数据模型、结构、布局、接口等）                    │
└─────────────────────────────────────────────────────────────────────────┘
```

### 输出格式要求

```
1. 文档结构
   ├── 必须使用 Markdown 格式
   ├── 必须包含文档头部信息（页面名称、所属模块、页面类型）
   ├── 六个 STEP 必须按顺序完整输出
   └── 每个 STEP 必须有清晰的分隔线 ---

2. 内容深度
   ├── 数据模型：字段级别完整定义，包含类型、说明、UI绑定
   ├── 流程图：覆盖所有用户可执行的操作路径
   ├── 树状图：覆盖UI上所有可见元素
   ├── 布局图：提供ASCII可视化，标注尺寸和间距
   ├── 代码结构：可直接用于创建项目文件夹
   └── 后端设计：SQL可直接执行建表

3. 关联性
   ├── STEP 1 数据模型 ↔ STEP 3 组件 [data:字段] 绑定必须对应
   ├── STEP 2 流程 [API:xxx] ↔ STEP 6 接口定义必须对应
   ├── STEP 3 组件路径 ↔ STEP 5 代码文件必须对应
   └── STEP 6 接口响应 ↔ STEP 1 数据模型必须对应
```

### 禁止事项

```
❌ 禁止只输出部分 STEP（如只输出树状图不输出数据模型）
❌ 禁止使用"略"、"同上"、"参考XXX"等省略写法
❌ 禁止遗漏数据绑定标注
❌ 禁止接口定义与数据模型不对应
❌ 禁止代码结构与树状图组件不匹配
❌ 禁止输出无法执行的SQL语句
```

### 输出检查清单

**在输出文档前，必须自检以下项目：**

```
□ 文档是否包含完整的六个 STEP？
□ STEP 1 数据模型是否覆盖页面所有动态数据？
□ STEP 2 流程图是否标注了所有 [API:xxx] 调用？
□ STEP 3 树状图是否每个动态元素都有 [data:字段] 标注？
□ STEP 4 布局图是否提供了可视化 ASCII 图？
□ STEP 5 代码结构是否可以直接创建文件夹？
□ STEP 6 接口响应是否与 STEP 1 数据模型一一对应？
□ STEP 6 数据库表字段是否与数据模型字段对应？
□ 各 STEP 之间的引用关系是否正确？
□ 是否提供了质量自评？
```

---

**⚡ 一句话总结：收到UI图后，必须输出一份包含六个完整STEP的结构指导文档，确保前后端可直接依据文档进行开发。**

---

### 📄 文档保存要求

```
┌─────────────────────────────────────────────────────────────────────────┐
│  ⚠️ 必须将输出文档保存为 Markdown 文件                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  保存规范：                                                               │
│  ├── 文件格式：.md (Markdown)                                            │
│  ├── 文件命名：{页面名称}_结构文档.md                                     │
│  │             示例：发现页_结构文档.md、用户中心_结构文档.md              │
│  ├── 保存路径：与项目文档目录对应                                         │
│  └── 编码格式：UTF-8                                                     │
│                                                                          │
│  保存时机：                                                               │
│  ├── 完成六步法输出后，立即保存为文件                                     │
│  ├── 不得仅在对话中输出而不保存文件                                       │
│  └── 保存后告知用户文件路径                                               │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

**❌ 禁止：仅在对话中输出文档内容而不保存到文件**
**✅ 必须：使用工具将完整文档写入 .md 文件并告知用户保存路径**
