# 🌳 销售中心提货单 结构指导文档

> **页面名称：** 提货单管理
> **所属模块：** 销售中心 (SalesCenter)
> **页面类型：** 表单页 + 列表页（复合型）
> **业务单元：** 柳钢集团、柳钢股份、广西钢铁、中金公司

---

## 📋 STEP 1: 页面数据模型

### 设计理念

```
核心思想：数据驱动 UI，先定义"页面需要什么数据"，再考虑"数据从哪来"

数据依赖图：
{ConfigData} + {ContractData} → 生成提货单 → 校验提交 → 审批签署 → 下传MMS → 关闭/变更
```

### PageModel - 提货单页面数据模型

```json
{
  "模型信息": {
    "页面名称": "提货单管理",
    "页面标识": "PickupOrderPage",
    "所属模块": "SalesCenter",
    "页面类型": "表单页+列表页"
  },

  "数据依赖图": "{ConfigData} + {ContractData} → 创建提货单 → 校验 → 审批 → 下传 → 关闭",

  "PageModel": {
    "_说明": "提货单页面级数据模型 [L1]",

    "HeaderData": {
      "_说明": "表头区域数据 → [→HeaderArea]",
      "orderId": "String - 提货单ID - [用于:唯一标识]",
      "orderNo": "String - 单据编号 - [UI:表头.单据编号] [格式:T+基地编码+仓库编码+年月日+流水]",
      "orderType": "String(标准提货单) - 单据类型 - [UI:表头.单据类型] [控制:字段显隐性及必填项]",
      "documentStatus": "String(暂存|已提交|已审核|关闭状态) - 单据状态 - [UI:表头.单据状态]",
      "closeStatus": "String(是|否) - 关闭状态 - [UI:表头.关闭状态]",
      "signStatus": "String(未签署|已签署) - 签署状态 - [UI:表头.签署状态]",
      "mmsDownloadComplete": "String(是|否) - MMS下发完成 - [UI:表头.MMS下发状态]",
      "logisticsDownloadComplete": "String(是|否) - 物流下发完成 - [UI:表头.物流下发状态]"
    },

    "BusinessUnitData": {
      "_说明": "业务单元数据 → [→BusinessUnitArea]",
      "organizationCode": "String - 组织编码 - [用于:区分业务规则]",
      "organizationName": "String(柳钢集团|柳钢股份|广西钢铁|中金公司) - 账号所属组织 - [UI:表头.所属组织]",
      "baseCode": "String(01|02|03) - 基地编码 - [用于:单据编号、接口路由]",
      "baseName": "String(柳州基地|防城港基地|玉林中金) - 基地名称 - [UI:表头.基地]",
      "warehouseCode": "String - 仓库编码 - [用于:单据编号]",
      "warehouseName": "String - 仓库名称 - [UI:表头.仓库]",
      "storageArea": "String - 库区 - [UI:表头.出库库区] [控制:物流园运费校验]"
    },

    "TimeData": {
      "_说明": "时间相关数据 → [→TimeArea]",
      "planExecuteTime": "String(ISO8601) - 计划执行时间 - [UI:表头.计划执行时间] [默认:系统当天] [可修改]",
      "planEndTime": "String(ISO8601) - 计划结束时刻 - [UI:表头.计划结束时刻] [计算:自动生成] [可修改]",
      "remark": "String? - 备注 - [UI:表头.备注] [可修改]"
    },

    "ContractData": {
      "_说明": "上游合同数据 → [→ContractArea]",
      "contractId": "String - 合同ID - [用于:关联校验]",
      "contractNo": "String - 合同编号 - [UI:表头.关联合同]",
      "contractValidDate": "String(ISO8601) - 合同有效期 - [用于:有效期校验]",
      "salesPricePolicy": "String - 销售价格政策 - [UI:物料明细.价格政策] [用于:价证取价]",
      "paymentPolicy": "String - 付款政策 - [用于:货控校验]",
      "salesPaymentMethod": "String - 销售付款方式 - [用于:资金校验]",
      "orderWeight": "Number - 订货重量 - [用于:数量校验]",
      "toleranceUpperLimit": "Number(0-100) - 交货重量公差上限(%) - [用于:数量校验上限计算]",
      "allocatedAmount": "Number - 配款金额 - [用于:货控校验]"
    },

    "MaterialListData": {
      "_说明": "物料明细区域数据 → [→MaterialListArea]",
      "materialList": "Array<MaterialItem> - 物料明细列表 - [UI:物料明细表格]",
      "totalPlanWeight": "Number - 计划重量合计 - [UI:物料明细.合计]"
    },

    "FundData": {
      "_说明": "资金相关数据 → [→FundArea]",
      "fundPoolBalance": "Number - 资金池余额 - [用于:货控校验]",
      "totalTaxAmount": "Number - 价税合计 - [用于:货控校验]",
      "freightMark": "String(是|否) - 运费标记 - [UI:表头.运费标记] [用于:物流园运费校验]"
    },

    "PageState": {
      "_说明": "页面状态数据",
      "isLoading": "Boolean - 加载中 - [状态:骨架屏/Loading]",
      "isSubmitting": "Boolean - 提交中 - [状态:提交按钮禁用]",
      "validationErrors": "Array<String> - 校验错误列表 - [UI:错误弹窗]",
      "canEdit": "Boolean - 可编辑 - [条件:单据状态=暂存]",
      "canSubmit": "Boolean - 可提交 - [条件:单据状态=暂存]",
      "canDownload": "Boolean - 可下传 - [条件:单据状态=已审核]",
      "canClose": "Boolean - 可关闭 - [条件:单据状态=已审核]"
    }
  }
}
```

### ItemModel - 物料明细数据模型

```json
{
  "ItemModel": {
    "_说明": "物料明细项数据模型 [L3]",

    "MaterialItem": {
      "_说明": "物料明细行数据 → [→MaterialItemRow]",

      "lineId": "String - 明细行ID - [用于:行操作标识]",
      "lineNo": "Number - 行号 - [UI:明细.行号]",

      "materialData": {
        "_说明": "物料基础信息",
        "materialCode": "String - 物料编码 - [UI:明细.物料编码]",
        "materialName": "String - 物料名称 - [UI:明细.物料名称]",
        "specification": "String - 规格 - [UI:明细.规格]",
        "unit": "String - 单位 - [UI:明细.单位]"
      },

      "quantityData": {
        "_说明": "数量相关数据",
        "planWeight": "Number - 计划重量 - [UI:明细.计划重量] [用于:数量校验]",
        "fulfilledWeight": "Number - 已履约重量 - [UI:明细.已履约重量] [只读]",
        "cumulativeValidPlanWeight": "Number - 累计有效计划重量 - [用于:有效计划累计校验]"
      },

      "priceData": {
        "_说明": "价格相关数据",
        "unitPrice": "Number - 单价 - [UI:明细.单价]",
        "taxRate": "Number - 税率 - [UI:明细.税率]",
        "taxAmount": "Number - 税额 - [UI:明细.税额]",
        "totalAmount": "Number - 金额 - [UI:明细.金额]"
      },

      "storageData": {
        "_说明": "库区相关数据",
        "storageArea": "String - 库区 - [UI:明细.库区]",
        "isLogisticsPark": "Boolean - 是否物流园仓库 - [用于:运费校验判断]"
      },

      "statusData": {
        "_说明": "状态数据",
        "lineCloseStatus": "String(是|否) - 行关闭状态 - [UI:明细.行关闭状态]",
        "isLoaded": "String(是|否) - 已装车 - [用于:变更校验]"
      }
    }
  }
}
```

### SharedModel - 共享数据模型

```json
{
  "SharedModel": {
    "_说明": "跨页面复用的数据模型 [L4]",

    "ValidationResult": {
      "_说明": "校验结果",
      "isValid": "Boolean - 是否通过",
      "errorMessages": "Array<String> - 错误信息列表",
      "errorType": "String(contract|quantity|fund|freight|validity) - 错误类型"
    },

    "SubmitResult": {
      "_说明": "提交结果",
      "success": "Boolean - 是否成功",
      "message": "String? - 提示信息",
      "orderId": "String? - 提货单ID"
    },

    "DownloadResult": {
      "_说明": "下传结果",
      "success": "Boolean - 是否成功",
      "targetSystem": "String(MMS|物流) - 目标系统",
      "message": "String? - 返回信息"
    },

    "OrganizationConfig": {
      "_说明": "组织配置（影响业务规则）",
      "validityDays": "Number(5|7) - 提货单有效期天数 - [常规:7天, 中金:5天]",
      "mmsInterface": "String - MMS接口类型 - [柳州:本部, 防城港:广钢, 玉林:中金]"
    }
  }
}
```

### 业务规则模型

```json
{
  "BusinessRuleModel": {
    "_说明": "业务规则数据模型",

    "OrderNoRule": {
      "_说明": "单据编号规则",
      "format": "T + 基地编码(2位) + 仓库编码(3位) + 年(2位) + 月(2位) + 日(2位) + 流水(4位)",
      "example": "T01W022509220001",
      "components": {
        "prefix": "T",
        "baseCode": "01 = 柳州基地",
        "warehouseCode": "W02 = 仓库编码",
        "date": "250922 = 2025年09月22日",
        "serial": "0001 = 当日流水号"
      }
    },

    "ValidityRule": {
      "_说明": "有效期计算规则",
      "normalOrg": {
        "applies": "柳钢集团、柳钢股份、广西钢铁",
        "formula": "计划执行时间 + 7天"
      },
      "specialOrg": {
        "applies": "中金公司",
        "formula": "计划执行时间 + 5天"
      },
      "autoClose": "当前时间 > 计划结束时刻 → 自动关闭"
    },

    "QuantityValidationRule": {
      "_说明": "提单数量校验规则",
      "condition1": {
        "name": "实际出库累计校验",
        "formula": "本次计划重量 + 已履约重量 ≤ 订货重量 × (1 + 公差上限%)",
        "purpose": "确保实际已提 + 本次计划提 ≤ 合同可提上限"
      },
      "condition2": {
        "name": "有效计划累计重量校验",
        "formula": "本次计划重量 + 累计有效计划重量 ≤ 订货重量 × (1 + 公差上限%)",
        "purpose": "确保所有已规划提货计划总和不超合同上限"
      }
    },

    "FundValidationRule": {
      "_说明": "资金校验规则",
      "trigger": "所有销售付款方式均需校验",
      "formula": "资金池余额 / 配款金额 ≥ 价税合计",
      "triggerPoint": "点击【提交】按钮",
      "releasePoint": "点击【关闭】按钮",
      "releaseFormula": "释放金额 = 提货单总金额 - 出库总金额"
    },

    "FreightValidationRule": {
      "_说明": "物流园运费校验规则",
      "condition": "库区 = 物流园仓库",
      "process": [
        "1. 销售系统发送'提单运费电文'至CMS本部物流系统",
        "2. CMS返回'运费确认电文'",
        "3. 回填运费标记(是/否)"
      ]
    }
  }
}
```

### 数据模型汇总表

| 模型名 | 层级 | 对应组件 | 说明 |
|--------|------|----------|------|
| PageModel.HeaderData | L1 | HeaderArea | 表头基础信息 |
| PageModel.BusinessUnitData | L1 | BusinessUnitArea | 业务单元信息 |
| PageModel.TimeData | L1 | TimeArea | 时间相关字段 |
| PageModel.ContractData | L1 | ContractArea | 上游合同信息 |
| PageModel.MaterialListData | L2 | MaterialListArea | 物料明细列表 |
| PageModel.FundData | L1 | FundArea | 资金校验数据 |
| ItemModel.MaterialItem | L3 | MaterialItemRow | 物料明细行 |
| SharedModel.ValidationResult | L4 | ValidationDialog | 校验结果弹窗 |
| SharedModel.SubmitResult | L4 | ResultToast | 提交结果提示 |
| BusinessRuleModel | - | - | 业务规则配置 |

---

## 🔄 STEP 2: 流程图

### 2.1 提货单生成流程

```
开始
 ↓
【分货管理】
 ├─→ 进入"提单编制"页面
 ├─→ 选择销售合同
 └─→ 点击「下推生成提货单」
 ↓
【提货单初始化】 [API:createPickupOrder]
 │
 ├─→ 自动生成单据编号 [规则:T+基地+仓库+日期+流水]
 ├─→ 单据状态 = "暂存"
 ├─→ 从销售合同携带数据 [→ContractArea]
 │    ├─→ 销售价格政策
 │    ├─→ 付款政策
 │    └─→ 合同明细信息
 ├─→ 从提单编制携带数据 [→MaterialListArea]
 └─→ 设置默认时间 [→TimeArea]
      ├─→ 计划执行时间 = 系统当天
      └─→ 计划结束时刻 = 计划执行时间 + 7天(或5天)
 ↓
【提货单编辑】 [状态:暂存]
 │
 ├─→ 可修改字段：
 │    ├─→ 【计划执行时间】
 │    ├─→ 【计划结束时刻】
 │    └─→ 【备注】
 │
 ├─→ 不可修改字段：其他所有字段
 │
 └─→ 点击「价证取价」[触发:MaterialListArea] [API:getPriceByPolicy]
      └─→ 批量取价计算
 ↓
【准备提交】
 ↓
结束(进入提交流程)
```

### 2.2 提货单提交校验流程

```
开始
 ↓
【点击「提交」按钮】 [触发:ActionBarArea]
 ↓
【校验引擎启动】
 │
 ├─→ 【1.合同有效期校验】 [API:validateContract]
 │    ├─→ 检查: 销售合同是否到期
 │    └─→ 失败: "上游销售合同单据已到期，不允许创建提货单"
 │
 ├─→ 【2.提单数量校验】 [API:validateQuantity]
 │    │
 │    ├─→ 条件1: 实际出库累计校验
 │    │    ├─→ 公式: 本次计划重量 + 已履约重量 ≤ 订货重量×(1+公差上限%)
 │    │    └─→ 失败: "提单数量校验不通过"
 │    │
 │    └─→ 条件2: 有效计划累计重量校验
 │         ├─→ 公式: 本次计划重量 + 累计有效计划重量 ≤ 合同上限
 │         └─→ 失败: "提单数量校验不通过"
 │
 ├─→ 【3.资金校验】 [API:validateFund]
 │    ├─→ 触发: 所有销售付款方式
 │    ├─→ 公式: 资金池余额/配款金额 ≥ 价税合计
 │    └─→ 失败: "货款不足，无法提交"
 │
 ├─→ 【4.物流园运费校验】 [API:validateFreight] [条件:库区=物流园仓库]
 │    ├─→ 发送"提单运费电文" → CMS本部物流系统
 │    ├─→ 接收"运费确认电文" → 回填运费标记
 │    └─→ 失败: "运费不足"
 │
 └─→ 【5.有效期时间校验】
      ├─→ 规则: 计划结束时刻 ≤ 合同有效期
      └─→ 失败: "合同到期，不允许提交新提货单"
 ↓
【校验结果判断】
 ├─→ 全部通过 → 进入审批流程
 └─→ 存在失败 → 弹窗显示所有错误 [→ValidationDialog]
      例如:
      ┌────────────────────────────┐
      │ 1、合同已超期。             │
      │ 2、资金校验不通过。         │
      └────────────────────────────┘
 ↓
结束
```

### 2.3 提货单审批后流程

```
开始
 ↓
【审批通过】
 ├─→ 单据状态 → "已审核"
 ↓
【可信签署触发】 [条件:合同类型≠出口钢材销售] [API:pushToTrustedSign]
 ├─→ 自动推送提单信息 → 可信平台
 ├─→ 客户签署后 → 接收签署完成信息
 ├─→ 回填【签署状态】
 ├─→ 点击「更新签署状态」→ 调用接口更新
 └─→ 【签署状态】= "已签署" → 推送双签PDF至CRM系统
 ↓
【业务人员点击「下传」】 [触发:ActionBarArea] [API:downloadToMMS]
 │
 ├─→ 【判断基地类型】
 │
 ├─→ 基地 = 柳州基地:
 │    ├─→ 发送: "提单主表电文接口"
 │    ├─→ 发送: "提单明细电文接口"
 │    ├─→ 发送: "提单车号电文接口"
 │    ├─→ 接收: "本部下传反馈接口"
 │    └─→ 回填: 【MMS下发完成】= "是"
 │
 ├─→ 基地 = 防城港基地:
 │    ├─→ 与广钢MMS系统对接:
 │    │    ├─→ 发送: "广钢提单主表电文"
 │    │    ├─→ 发送: "广钢提单明细电文"
 │    │    └─→ 接收: "广钢下传反馈接口"
 │    │
 │    └─→ 与防城港物流系统对接:
 │         ├─→ 发送: "广钢物流提单主表电文"
 │         └─→ 发送: "广钢物流提单明细电文"
 │
 └─→ 基地 = 玉林中金:
      ├─→ 发送: "中金提单主表和明细表电文"
      └─→ 接收: "中金下传反馈接口"
 ↓
【物流系统反馈】
 ├─→ 接收: "物流下传反馈接口"
 └─→ 回填: 【物流下发完成】= "是"
 ↓
结束
```

### 2.4 提单关闭流程（非物流园仓）

```
开始
 ↓
【关闭触发方式】
 │
 ├─→ 【系统自动关闭】
 │    ├─→ 触发: 当前时间 > 计划结束时刻
 │    ├─→ 回填: 【关闭状态】= "是"
 │    ├─→ 回填: 【单据状态】= "关闭状态"
 │    └─→ 下传关闭信息至MMS
 │
 └─→ 【手动关闭】 [触发:列表「关闭」按钮]
      │
      ├─→ 【明细行关闭】
      │    ├─→ 点击【行关闭】按钮
      │    └─→ 下传行关闭信息至MMS
      │
      └─→ 【整单关闭】
           ├─→ 点击【关闭】按钮
           └─→ 下传整单关闭信息至MMS
 ↓
【下传关闭电文】 [API:downloadCloseToMMS]
 │
 ├─→ 基地 = 柳州基地: "提单主表/明细电文接口"
 ├─→ 基地 = 防城港基地: "广钢提单主表/明细电文"
 └─→ 基地 = 玉林中金: "中金提单主表和明细表电文"
 ↓
【MMS接收成功反馈】
 ├─→ 回填: 【关闭状态】= "是"
 ├─→ 回填: 【单据状态】= "关闭状态"
 ├─→ 自动释放"余款"
 ├─→ 不允许推送生成销售出库单
 └─→ 释放剩余未提货量（欠交量）
 ↓
结束
```

### 2.5 过户删除流程（物流园仓）

```
开始
 ↓
【筛选条件】
 ├─→ 出库库区 = 物流园仓
 ├─→ 单据状态 = "已审核"
 └─→ 单据类型 = "标准提货单"
 ↓
【点击「过户删除」按钮】 [API:transferDelete]
 │
 ├─→ 校验: 非物流园仓 → 报错
 │
 └─→ 发送: "过户删除回复电文" → WMS本部物流系统
 ↓
【WMS接收成功反馈】
 ├─→ 接收: "物流下传反馈接口"
 ├─→ 回填: 【关闭状态】= "是"
 ├─→ 回填: 【单据状态】= "关闭状态"
 ├─→ 自动释放"余款"
 └─→ 释放过户量（计划重量）
 ↓
结束
```

### 2.6 提货单变更流程

```
开始
 ↓
【变更前提】
 ├─→ 单据状态 = "已审核"
 └─→ 点击「变更」操作
 ↓
【生成提货单变更单】 [API:createChangeOrder]
 ├─→ 变更类型: 提单时间变更
 └─→ 可变更内容:
      ├─→ 计划执行日期
      └─→ 计划结束时刻
 ↓
【变更单审批】
 ├─→ 审批通过 → 反写回原提货单
 └─→ 自动触发推送变更信息
 ↓
【提单日期调整】 [触发:列表「日期调整」按钮]
 │
 ├─→ 校验条件:
 │    ├─→ 单据状态 = 已审核
 │    ├─→ 未生成出库单 (已装车 = 否)
 │    └─→ 新日期 ≥ 原日期时间
 │
 ├─→ 场景1: MMS下发完成 = 否
 │    └─→ 直接下推，操作类型 = I
 │
 └─→ 场景2: MMS下发完成 = 是
      ├─→ 先传 D (删除)
      ├─→ 再传 I (新增)
      └─→ U = 回退, I = 完结
 ↓
结束
```

### 流程-组件关联表

| 流程节点 | 触发组件 | 调用接口 | 影响组件 | 状态变化 |
|----------|----------|----------|----------|----------|
| 创建提货单 | 分货管理页面 | createPickupOrder | 全页面 | 初始化 → 暂存 |
| 价证取价 | MaterialListArea | getPriceByPolicy | MaterialListArea | 更新价格数据 |
| 提交校验 | ActionBarArea | validateAll | ValidationDialog | 显示校验结果 |
| 提交成功 | ActionBarArea | submitOrder | HeaderArea | 暂存 → 已提交 |
| 审批通过 | 审批流程 | - | HeaderArea | 已提交 → 已审核 |
| 可信签署 | 系统自动 | pushToTrustedSign | HeaderArea | 更新签署状态 |
| 下传MMS | ActionBarArea | downloadToMMS | HeaderArea | MMS下发完成=是 |
| 关闭提单 | ActionBarArea | closeOrder | HeaderArea | 已审核 → 关闭 |
| 过户删除 | ActionBarArea | transferDelete | HeaderArea | 已审核 → 关闭 |
| 提单变更 | ActionBarArea | createChangeOrder | 生成变更单 | - |

---

## 🌳 STEP 3: 树状图

```
【销售中心】★★★
│
├── 【提货单管理】📱 [L1] [拆分:8个L2]
│   │   文件: PickupOrder/index.tsx
│   │
│   ├── 📍 HeaderArea [L2] [固定顶部]
│   │   │   文件: HeaderArea.tsx
│   │   │   布局: flex-row, space-between
│   │   ├── 《BackButton》[L3] [data:无]
│   │   ├── 《Title》[L3] [data:提货单管理]
│   │   └── 《ActionMenu》[L3] [操作:更多菜单]
│   │
│   ├── 🏷️ OrderInfoArea [L2] [表头信息区]
│   │   │   文件: OrderInfoArea/
│   │   │   ├── index.tsx
│   │   │   ├── types.ts
│   │   │   └── useOrderInfo.ts
│   │   │
│   │   ├── 《OrderNoRow》[L3] [data:HeaderData.orderNo]
│   │   │   └── [格式:T01W022509220001]
│   │   │
│   │   ├── 《OrderTypeRow》[L3] [data:HeaderData.orderType]
│   │   │   └── [值:标准提货单]
│   │   │
│   │   ├── 《StatusRow》[L3] [data:HeaderData.documentStatus]
│   │   │   └── [状态:暂存|已提交|已审核|关闭]
│   │   │
│   │   ├── 《OrganizationRow》[L3] [data:BusinessUnitData.organizationName]
│   │   │   └── [值:柳钢集团|柳钢股份|广西钢铁|中金公司]
│   │   │
│   │   ├── 《BaseRow》[L3] [data:BusinessUnitData.baseName]
│   │   │   └── [值:柳州基地|防城港基地|玉林中金]
│   │   │
│   │   └── 《WarehouseRow》[L3] [data:BusinessUnitData.warehouseName]
│   │
│   ├── 🏷️ TimeArea [L2] [时间信息区]
│   │   │   文件: TimeArea.tsx
│   │   │
│   │   ├── 《PlanExecuteTimeInput》[L3] [data:TimeData.planExecuteTime]
│   │   │   └── [可编辑] [默认:系统当天]
│   │   │
│   │   ├── 《PlanEndTimeInput》[L3] [data:TimeData.planEndTime]
│   │   │   └── [可编辑] [计算:+7天或+5天]
│   │   │
│   │   └── 《RemarkInput》[L3] [data:TimeData.remark]
│   │       └── [可编辑]
│   │
│   ├── 🏷️ ContractInfoArea [L2] [合同关联区]
│   │   │   文件: ContractInfoArea.tsx
│   │   │
│   │   ├── 《ContractNoRow》[L3] [data:ContractData.contractNo]
│   │   │
│   │   ├── 《ContractValidDateRow》[L3] [data:ContractData.contractValidDate]
│   │   │
│   │   ├── 《PricePolicyRow》[L3] [data:ContractData.salesPricePolicy]
│   │   │
│   │   └── 《PaymentPolicyRow》[L3] [data:ContractData.paymentPolicy]
│   │
│   ├── 🏷️ MaterialListArea [L2] [flex:1, 可滚动]
│   │   │   文件: MaterialListArea/
│   │   │   ├── index.tsx
│   │   │   ├── types.ts
│   │   │   ├── useMaterialList.ts
│   │   │   └── MaterialItemRow/
│   │   │       ├── index.tsx
│   │   │       └── types.ts
│   │   │
│   │   ├── 《TableHeader》[L3]
│   │   │   └── 行号|物料编码|物料名称|规格|单位|计划重量|单价|金额|库区|操作
│   │   │
│   │   ├── 《MaterialItemRow》[L3] [1模板xN实例] [data:MaterialItem]
│   │   │   ├── [R-C1] 《LineNo》[data:lineNo]
│   │   │   ├── [R-C2] 《MaterialCode》[data:materialData.materialCode]
│   │   │   ├── [R-C3] 《MaterialName》[data:materialData.materialName]
│   │   │   ├── [R-C4] 《Specification》[data:materialData.specification]
│   │   │   ├── [R-C5] 《Unit》[data:materialData.unit]
│   │   │   ├── [R-C6] 《PlanWeight》[data:quantityData.planWeight]
│   │   │   ├── [R-C7] 《UnitPrice》[data:priceData.unitPrice]
│   │   │   ├── [R-C8] 《TotalAmount》[data:priceData.totalAmount]
│   │   │   ├── [R-C9] 《StorageArea》[data:storageData.storageArea]
│   │   │   └── [R-C10] 《RowActions》
│   │   │        ├── 「价证取价」[API:getPriceByPolicy]
│   │   │        └── 「行关闭」[API:closeOrderLine]
│   │   │
│   │   └── 《TableFooter》[L3]
│   │       └── 合计: [data:MaterialListData.totalPlanWeight]
│   │
│   ├── 🏷️ FundInfoArea [L2] [资金信息区]
│   │   │   文件: FundInfoArea.tsx
│   │   │
│   │   ├── 《FundPoolRow》[L3] [data:FundData.fundPoolBalance]
│   │   │
│   │   ├── 《TotalTaxRow》[L3] [data:FundData.totalTaxAmount]
│   │   │
│   │   └── 《FreightMarkRow》[L3] [data:FundData.freightMark]
│   │       └── [条件:库区=物流园仓库时显示]
│   │
│   ├── 🏷️ SignatureArea [L2] [签署状态区]
│   │   │   文件: SignatureArea.tsx
│   │   │
│   │   ├── 《SignStatusRow》[L3] [data:HeaderData.signStatus]
│   │   │   └── [状态:未签署|已签署]
│   │   │
│   │   └── 《UpdateSignButton》[L3]
│   │       └── 「更新签署状态」[API:updateSignStatus]
│   │
│   └── 📍 ActionBarArea [L2] [固定底部]
│       │   文件: ActionBarArea.tsx
│       │
│       ├── 《SaveButton》[L3] [条件:单据状态=暂存]
│       │   └── 「保存」[API:saveOrder]
│       │
│       ├── 《SubmitButton》[L3] [条件:单据状态=暂存]
│       │   └── 「提交」[API:submitOrder]
│       │
│       ├── 《DownloadButton》[L3] [条件:单据状态=已审核]
│       │   └── 「下传」[API:downloadToMMS]
│       │
│       ├── 《CloseButton》[L3] [条件:单据状态=已审核]
│       │   └── 「关闭」[API:closeOrder]
│       │
│       ├── 《TransferDeleteButton》[L3] [条件:库区=物流园仓]
│       │   └── 「过户删除」[API:transferDelete]
│       │
│       └── 《ChangeButton》[L3] [条件:单据状态=已审核]
│           └── 「变更」[API:createChangeOrder]
│
├── 【提货单列表】📱 [L1]
│   │   文件: PickupOrderList/index.tsx
│   │
│   ├── 📍 SearchArea [L2]
│   │   └── 筛选条件: 单据编号|单据状态|基地|日期范围
│   │
│   ├── 🏷️ ListArea [L2] [flex:1, 可滚动]
│   │   └── 《OrderListItem》[L3] [1模板xN实例]
│   │       ├── [data:orderNo] 单据编号
│   │       ├── [data:documentStatus] 单据状态
│   │       ├── [data:baseName] 基地
│   │       └── [data:planExecuteTime] 计划执行时间
│   │
│   └── 📍 BatchActionBar [L2] [固定底部]
│       ├── 「批量下传」
│       ├── 「批量关闭」
│       └── 「更新签署状态」
│
└── 🔧 服务层
    ├── 📡 GET  /api/sales/pickup-order/list     → 列表查询 [→ PageModel.HeaderData[]]
    ├── 📡 GET  /api/sales/pickup-order/{id}     → 详情查询 [→ PageModel]
    ├── 📡 POST /api/sales/pickup-order/create   → 创建提货单 [→ SubmitResult]
    ├── 📡 POST /api/sales/pickup-order/submit   → 提交提货单 [→ ValidationResult]
    ├── 📡 POST /api/sales/pickup-order/download → 下传MMS [→ DownloadResult]
    ├── 📡 POST /api/sales/pickup-order/close    → 关闭提货单 [→ SubmitResult]
    └── 📡 POST /api/sales/pickup-order/change   → 变更提货单 [→ SubmitResult]
```

### 列表控制（通用）

```
🔄 ListControl [适用于 提货单列表]
├── 加载更多: 上滑 [距底100px] → 调用列表接口(page+1)
├── 下拉刷新: [阈值60px] → 调用列表接口(page=1)
├── 骨架屏: [条件:isLoading且page=1] 显示占位
├── 加载指示: [条件:isLoading且page>1] 显示底部loading
├── 空状态: [条件:list.length=0] 显示空状态插画
└── 到底提示: [条件:hasMore=false] "已加载全部"
```

### 组件拆分规则

```
三层架构：
├── L1-页面: 提货单管理页 → 拆分 8 个 L2
├── L2-区域: 功能区块 → 拆分 2-6 个 L3
└── L3-基础: 最小单元 → 可复用组件

本页面组件统计：
├── L2 区域组件: 8 个
├── L3 基础组件: 约 35 个
└── 总计: 约 43 个组件
```

---

## 📍 STEP 4: 布局定位

### 页面整体布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📱 提货单管理页面 [L1] - PickupOrderPage                                 │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  HeaderArea [L2] [固定顶部] [高度:56px]                           │   │
│  │  ┌────────┐  ┌──────────────────────────┐  ┌────────┐          │   │
│  │  │   ←    │  │       提货单管理          │  │   ⋮    │          │   │
│  │  └────────┘  └──────────────────────────┘  └────────┘          │   │
│  │  [TL]              [TC]                        [TR]             │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  ContentScrollArea [flex:1, scroll-y]                            │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  OrderInfoArea [L2] [表头信息]                              │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  单据编号: T01W022509220001                          │  │  │   │
│  │  │  │  单据类型: 标准提货单                                 │  │  │   │
│  │  │  │  单据状态: [暂存] ← 状态标签                          │  │  │   │
│  │  │  │  所属组织: 柳钢集团                                   │  │  │   │
│  │  │  │  基    地: 柳州基地                                   │  │  │   │
│  │  │  │  仓    库: W02仓库                                    │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  │                                                                  │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  TimeArea [L2] [时间信息] [可编辑区域]                      │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  计划执行时间: [2025-09-22     ] ← 日期选择器        │  │  │   │
│  │  │  │  计划结束时刻: [2025-09-29     ] ← 日期选择器        │  │  │   │
│  │  │  │  备        注: [_______________] ← 文本输入框        │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  │                                                                  │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  ContractInfoArea [L2] [合同关联]                          │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  关联合同: HT2025092200001                           │  │  │   │
│  │  │  │  合同有效期: 2025-10-16                              │  │  │   │
│  │  │  │  价格政策: 标准价格政策                               │  │  │   │
│  │  │  │  付款政策: 全额预付                                   │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  │                                                                  │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  MaterialListArea [L2] [物料明细表格]                       │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  行号 │ 物料编码 │ 物料名称 │ 规格 │ 计划重量 │ 操作   │  │  │   │
│  │  │  ├─────────────────────────────────────────────────────┤  │  │   │
│  │  │  │  1   │ M001    │ 螺纹钢    │ Φ12  │ 100.00  │ [取价] │  │  │   │
│  │  │  │  2   │ M002    │ 线材      │ Φ6   │ 50.00   │ [取价] │  │  │   │
│  │  │  │  3   │ M003    │ 圆钢      │ Φ20  │ 80.00   │ [取价] │  │  │   │
│  │  │  ├─────────────────────────────────────────────────────┤  │  │   │
│  │  │  │  合计                             │ 230.00  │        │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  │  「价证取价」← 批量操作按钮                                 │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  │                                                                  │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  FundInfoArea [L2] [资金信息]                               │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  资金池余额: ¥1,000,000.00                           │  │  │   │
│  │  │  │  价税合计:   ¥230,000.00                             │  │  │   │
│  │  │  │  运费标记:   [是/否] ← 条件显示                       │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  │                                                                  │   │
│  │  ┌───────────────────────────────────────────────────────────┐  │   │
│  │  │  SignatureArea [L2] [签署状态]                              │  │   │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │   │
│  │  │  │  签署状态: [未签署/已签署]      [更新签署状态] ← 按钮  │  │  │   │
│  │  │  │  MMS下发:  [是/否]                                   │  │  │   │
│  │  │  │  物流下发: [是/否]                                   │  │  │   │
│  │  │  └─────────────────────────────────────────────────────┘  │  │   │
│  │  └───────────────────────────────────────────────────────────┘  │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  ActionBarArea [L2] [固定底部] [高度:64px + 安全区]              │   │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │   │
│  │  │  保存   │ │  提交   │ │  下传   │ │  关闭   │ │  变更   │  │   │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘  │   │
│  │  [条件显示:根据单据状态]                                        │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  布局: flex-col | Header固定 + Content滚动 + ActionBar固定            │
└─────────────────────────────────────────────────────────────────────────┘
```

### 物料明细表格布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  MaterialListArea [L2] - 物料明细表格                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  表格列配置 (grid布局):                                                  │
│  ┌─────┬──────┬──────┬─────┬─────┬──────┬─────┬──────┬─────┬──────┐   │
│  │ 行号 │物料编码│物料名称│ 规格 │ 单位 │计划重量│ 单价 │  金额  │ 库区 │ 操作 │   │
│  │ 5%  │  10%  │  15%  │ 10% │ 6%  │  10%  │ 10% │  12%  │ 10% │ 12% │   │
│  ├─────┼──────┼──────┼─────┼─────┼──────┼─────┼──────┼─────┼──────┤   │
│  │  1  │ M001 │螺纹钢 │ Φ12 │  吨  │100.00│5000 │500000│W02 │[取价]│   │
│  │  2  │ M002 │ 线材  │  Φ6 │  吨  │ 50.00│4800 │240000│W02 │[取价]│   │
│  │  3  │ M003 │ 圆钢  │ Φ20 │  吨  │ 80.00│5200 │416000│W02 │[取价]│   │
│  ├─────┴──────┴──────┴─────┴─────┼──────┼─────┼──────┼─────┼──────┤   │
│  │            合    计            │230.00│  -  │1156000│  -  │  -   │   │
│  └────────────────────────────────┴──────┴─────┴──────┴─────┴──────┘   │
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  「价证取价」← 批量操作按钮 [对齐:右侧]                            │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  布局: 表格布局 | scroll-x (移动端) | 固定表头                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 校验错误弹窗布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  ValidationDialog [弹窗组件]                                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │                         校验不通过                                  │ │
│  ├───────────────────────────────────────────────────────────────────┤ │
│  │                                                                    │ │
│  │  ⚠️ 1、提单数量校验不通过。                                         │ │
│  │                                                                    │ │
│  │  ⚠️ 2、合同已超期。                                                 │ │
│  │                                                                    │ │
│  │  ⚠️ 3、资金校验不通过。                                             │ │
│  │                                                                    │ │
│  ├───────────────────────────────────────────────────────────────────┤ │
│  │                          ┌─────────┐                               │ │
│  │                          │  确 定  │                               │ │
│  │                          └─────────┘                               │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  布局: flex-col, center | 宽度: 80% | 最大宽度: 400px                   │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📁 STEP 5: 代码结构

```
src/modules/
│
├─ SalesCenter/                              # 销售中心模块
│   │
│   ├─ api/                                  # 模块级API
│   │   ├─ apiGetPickupOrderList.ts          # 获取提货单列表
│   │   ├─ apiGetPickupOrderDetail.ts        # 获取提货单详情
│   │   ├─ apiCreatePickupOrder.ts           # 创建提货单
│   │   ├─ apiSubmitPickupOrder.ts           # 提交提货单
│   │   ├─ apiValidatePickupOrder.ts         # 校验提货单
│   │   ├─ apiDownloadToMMS.ts               # 下传MMS
│   │   ├─ apiClosePickupOrder.ts            # 关闭提货单
│   │   ├─ apiTransferDelete.ts              # 过户删除
│   │   ├─ apiGetPriceByPolicy.ts            # 价证取价
│   │   ├─ apiUpdateSignStatus.ts            # 更新签署状态
│   │   └─ apiCreateChangeOrder.ts           # 创建变更单
│   │
│   ├─ stores/                               # 模块级状态
│   │   ├─ pickupOrderStore.ts               # 提货单状态管理
│   │   └─ validationStore.ts                # 校验状态管理
│   │
│   ├─ hooks/                                # 模块级Hooks
│   │   ├─ usePickupOrder.ts                 # 提货单业务逻辑
│   │   └─ useValidation.ts                  # 校验逻辑
│   │
│   ├─ types/                                # 模块级类型定义
│   │   ├─ pickupOrder.ts                    # 提货单类型
│   │   ├─ material.ts                       # 物料类型
│   │   └─ validation.ts                     # 校验类型
│   │
│   │   ┌─────────────────────────────────────────────────────────────────┐
│   │   │  📱 提货单管理 [L1] - PickupOrder/index.tsx                     │
│   │   ├─────────────────────────────────────────────────────────────────┤
│   │   │  ┌─────────────────────────────────────────────────────────┐   │
│   │   │  │  HeaderArea [L2]                                         │   │
│   │   │  └─────────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────────┐   │
│   │   │  │  ScrollContent                                           │   │
│   │   │  │  ├── OrderInfoArea [L2]                                  │   │
│   │   │  │  ├── TimeArea [L2]                                       │   │
│   │   │  │  ├── ContractInfoArea [L2]                               │   │
│   │   │  │  ├── MaterialListArea [L2]                               │   │
│   │   │  │  ├── FundInfoArea [L2]                                   │   │
│   │   │  │  └── SignatureArea [L2]                                  │   │
│   │   │  └─────────────────────────────────────────────────────────┘   │
│   │   │  ┌─────────────────────────────────────────────────────────┐   │
│   │   │  │  ActionBarArea [L2]                                      │   │
│   │   │  └─────────────────────────────────────────────────────────┘   │
│   │   └─────────────────────────────────────────────────────────────────┘
│   │
│   ├─ PickupOrder/                          # 提货单管理页面
│   │   │
│   │   ├─ index.tsx                         # 页面主文件 [L1]
│   │   ├─ types.ts                          # 页面类型定义
│   │   ├─ constants.ts                      # 页面常量
│   │   │
│   │   ├─ HeaderArea.tsx                    # 🟢 简单区域 - 头部导航
│   │   │
│   │   ├─ OrderInfoArea/                    # 🔵 复杂区域 - 表头信息
│   │   │   ├─ index.tsx
│   │   │   ├─ types.ts
│   │   │   ├─ useOrderInfo.ts
│   │   │   ├─ OrderNoRow.tsx                # [L3] 单据编号行
│   │   │   ├─ OrderTypeRow.tsx              # [L3] 单据类型行
│   │   │   ├─ StatusRow.tsx                 # [L3] 状态行
│   │   │   ├─ OrganizationRow.tsx           # [L3] 组织行
│   │   │   ├─ BaseRow.tsx                   # [L3] 基地行
│   │   │   └─ WarehouseRow.tsx              # [L3] 仓库行
│   │   │
│   │   ├─ TimeArea.tsx                      # 🟢 简单区域 - 时间信息
│   │   │   └─ 包含: PlanExecuteTimeInput, PlanEndTimeInput, RemarkInput
│   │   │
│   │   ├─ ContractInfoArea.tsx              # 🟢 简单区域 - 合同关联
│   │   │
│   │   ├─ MaterialListArea/                 # 🔵 复杂区域 - 物料明细
│   │   │   ├─ index.tsx
│   │   │   ├─ types.ts
│   │   │   ├─ useMaterialList.ts
│   │   │   ├─ TableHeader.tsx               # [L3] 表头
│   │   │   ├─ TableFooter.tsx               # [L3] 表尾合计
│   │   │   └─ MaterialItemRow/              # [L3] 物料明细行
│   │   │       ├─ index.tsx
│   │   │       ├─ types.ts
│   │   │       └─ RowActions.tsx            # 行操作按钮
│   │   │
│   │   ├─ FundInfoArea.tsx                  # 🟢 简单区域 - 资金信息
│   │   │
│   │   ├─ SignatureArea.tsx                 # 🟢 简单区域 - 签署状态
│   │   │
│   │   └─ ActionBarArea.tsx                 # 🟢 简单区域 - 底部操作栏
│   │
│   ├─ PickupOrderList/                      # 提货单列表页面
│   │   ├─ index.tsx
│   │   ├─ SearchArea.tsx
│   │   ├─ ListArea/
│   │   │   ├─ index.tsx
│   │   │   └─ OrderListItem.tsx
│   │   └─ BatchActionBar.tsx
│   │
│   ├─ PickupOrderChange/                    # 提货单变更页面
│   │   ├─ index.tsx
│   │   └─ ...
│   │
│   ├─ SharedComponents/                     # 模块共享组件
│   │   ├─ ValidationDialog/                 # 校验错误弹窗
│   │   │   ├─ index.tsx
│   │   │   └─ types.ts
│   │   ├─ StatusTag/                        # 状态标签
│   │   │   └─ index.tsx
│   │   └─ DateTimePicker/                   # 日期时间选择器
│   │       └─ index.tsx
│   │
│   └─ index.ts                              # 模块入口
│
└─ Common/                                   # 公共模块
    ├─ components/
    │   ├─ Button/
    │   ├─ Table/
    │   ├─ Dialog/
    │   └─ Form/
    └─ utils/
        ├─ dateUtils.ts                      # 日期工具
        ├─ numberUtils.ts                    # 数字格式化
        └─ validationUtils.ts                # 校验工具
```

### 文件命名规范

| 类型 | 命名格式 | 示例 |
|------|----------|------|
| 页面组件 | PascalCase | PickupOrder/index.tsx |
| 区域组件 | PascalCase + Area | OrderInfoArea.tsx |
| 列表项组件 | PascalCase + Row/Item | MaterialItemRow.tsx |
| API函数 | camelCase + api前缀 | apiGetPickupOrderList.ts |
| Hook函数 | camelCase + use前缀 | usePickupOrder.ts |
| Store | camelCase + Store后缀 | pickupOrderStore.ts |
| 类型定义 | camelCase | pickupOrder.ts |
| 常量 | UPPER_SNAKE_CASE | ORDER_STATUS.ts |

---

## 🗄️ STEP 6: 接口实现与后端设计

### 接口定义

```json
{
  "接口文档信息": {
    "对应页面": "提货单管理",
    "对应数据模型": "STEP 1 → PageModel",
    "版本": "v1.0"
  },

  "接口列表": [
    {
      "序号": 1,
      "接口名": "获取提货单列表",
      "接口标识": "listApi",
      "路径": "GET /api/sales/pickup-order/list",
      "触发时机": "[API:listApi] 列表页初始化/搜索/分页",
      "对应数据模型": "STEP 1 → HeaderData[]",

      "请求参数": {
        "orderNo": "String? - 单据编号 - 模糊搜索",
        "documentStatus": "String? - 单据状态 - 精确匹配",
        "baseCode": "String? - 基地编码 - 精确匹配",
        "startDate": "String? - 开始日期 - 范围查询",
        "endDate": "String? - 结束日期 - 范围查询",
        "page": "Number - 页码 - 默认1",
        "pageSize": "Number - 每页数量 - 默认20"
      },

      "响应数据": {
        "code": "Number - 状态码 - 200成功",
        "message": "String - 提示信息",
        "data": {
          "list": "Array<PickupOrderListItem> - 提货单列表",
          "total": "Number - 总数",
          "hasMore": "Boolean - 是否有更多"
        }
      }
    },
    {
      "序号": 2,
      "接口名": "获取提货单详情",
      "接口标识": "detailApi",
      "路径": "GET /api/sales/pickup-order/{id}",
      "触发时机": "[API:detailApi] 详情页初始化",
      "对应数据模型": "STEP 1 → PageModel",

      "请求参数": {
        "id": "String - 提货单ID - 路径参数"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "_映射": "→ STEP 1: PageModel",
          "headerData": "HeaderData - 表头数据",
          "businessUnitData": "BusinessUnitData - 业务单元数据",
          "timeData": "TimeData - 时间数据",
          "contractData": "ContractData - 合同数据",
          "materialListData": "MaterialListData - 物料明细",
          "fundData": "FundData - 资金数据"
        }
      }
    },
    {
      "序号": 3,
      "接口名": "提交提货单",
      "接口标识": "submitApi",
      "路径": "POST /api/sales/pickup-order/submit",
      "触发时机": "[API:submitApi] 点击提交按钮",
      "对应数据模型": "STEP 1 → ValidationResult + SubmitResult",

      "请求参数": {
        "orderId": "String - 提货单ID"
      },

      "响应数据": {
        "code": "Number - 状态码 - 200成功, 400校验失败",
        "data": {
          "success": "Boolean - 是否成功",
          "validationErrors": "Array<String>? - 校验错误列表",
          "message": "String? - 提示信息"
        }
      },

      "业务逻辑": {
        "步骤1": "合同有效期校验",
        "步骤2": "提单数量校验（条件1+条件2）",
        "步骤3": "资金校验",
        "步骤4": "物流园运费校验（条件触发）",
        "步骤5": "有效期时间校验"
      }
    },
    {
      "序号": 4,
      "接口名": "下传MMS",
      "接口标识": "downloadApi",
      "路径": "POST /api/sales/pickup-order/download",
      "触发时机": "[API:downloadApi] 点击下传按钮",
      "对应数据模型": "STEP 1 → DownloadResult",

      "请求参数": {
        "orderId": "String - 提货单ID",
        "baseCode": "String - 基地编码 - 决定下传接口"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "mmsDownloadComplete": "Boolean - MMS下发完成",
          "logisticsDownloadComplete": "Boolean - 物流下发完成",
          "message": "String? - 返回信息"
        }
      },

      "业务逻辑": {
        "柳州基地": "提单主表电文 + 提单明细电文 + 提单车号电文 → 本部MMS",
        "防城港基地": "广钢提单主表电文 + 广钢提单明细电文 → 广钢MMS + 防城港物流",
        "玉林中金": "中金提单主表和明细表电文 → 中金MMS"
      }
    },
    {
      "序号": 5,
      "接口名": "关闭提货单",
      "接口标识": "closeApi",
      "路径": "POST /api/sales/pickup-order/close",
      "触发时机": "[API:closeApi] 点击关闭按钮/自动关闭",
      "对应数据模型": "STEP 1 → SubmitResult",

      "请求参数": {
        "orderId": "String - 提货单ID",
        "closeType": "String(line|order) - 关闭类型 - 行关闭/整单关闭",
        "lineId": "String? - 明细行ID - 行关闭时必填"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "releaseAmount": "Number - 释放金额",
          "message": "String? - 提示信息"
        }
      }
    },
    {
      "序号": 6,
      "接口名": "过户删除",
      "接口标识": "transferDeleteApi",
      "路径": "POST /api/sales/pickup-order/transfer-delete",
      "触发时机": "[API:transferDeleteApi] 点击过户删除按钮",
      "对应数据模型": "STEP 1 → SubmitResult",

      "请求参数": {
        "orderId": "String - 提货单ID"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "releaseAmount": "Number - 释放金额（过户量）",
          "message": "String? - 提示信息"
        }
      },

      "校验规则": {
        "条件1": "出库库区 = 物流园仓",
        "条件2": "单据状态 = 已审核",
        "条件3": "单据类型 = 标准提货单"
      }
    },
    {
      "序号": 7,
      "接口名": "价证取价",
      "接口标识": "getPriceApi",
      "路径": "POST /api/sales/pickup-order/get-price",
      "触发时机": "[API:getPriceApi] 点击价证取价按钮",

      "请求参数": {
        "orderId": "String - 提货单ID",
        "lineIds": "Array<String> - 明细行ID列表 - 批量取价"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "priceResults": "Array<PriceResult> - 取价结果列表"
        }
      }
    },
    {
      "序号": 8,
      "接口名": "更新签署状态",
      "接口标识": "updateSignApi",
      "路径": "POST /api/sales/pickup-order/update-sign-status",
      "触发时机": "[API:updateSignApi] 点击更新签署状态按钮",

      "请求参数": {
        "orderIds": "Array<String> - 提货单ID列表"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "updatedCount": "Number - 更新数量"
        }
      }
    },
    {
      "序号": 9,
      "接口名": "创建变更单",
      "接口标识": "createChangeApi",
      "路径": "POST /api/sales/pickup-order/change",
      "触发时机": "[API:createChangeApi] 点击变更按钮",

      "请求参数": {
        "orderId": "String - 原提货单ID",
        "changeType": "String(time) - 变更类型",
        "newPlanExecuteTime": "String? - 新计划执行时间",
        "newPlanEndTime": "String? - 新计划结束时刻"
      },

      "响应数据": {
        "code": "Number - 状态码",
        "data": {
          "success": "Boolean - 是否成功",
          "changeOrderId": "String - 变更单ID"
        }
      },

      "校验规则": {
        "条件1": "单据状态 = 已审核",
        "条件2": "已装车 = 否",
        "条件3": "新日期 ≥ 原日期"
      }
    }
  ]
}
```

### 接口汇总表

| 序号 | 接口标识 | 方法 | 路径 | 对应数据模型 | 触发时机 |
|------|----------|------|------|--------------|----------|
| 1 | listApi | GET | /api/sales/pickup-order/list | HeaderData[] | 列表初始化/搜索 |
| 2 | detailApi | GET | /api/sales/pickup-order/{id} | PageModel | 详情页初始化 |
| 3 | submitApi | POST | /api/sales/pickup-order/submit | ValidationResult | 点击提交 |
| 4 | downloadApi | POST | /api/sales/pickup-order/download | DownloadResult | 点击下传 |
| 5 | closeApi | POST | /api/sales/pickup-order/close | SubmitResult | 点击关闭 |
| 6 | transferDeleteApi | POST | /api/sales/pickup-order/transfer-delete | SubmitResult | 过户删除 |
| 7 | getPriceApi | POST | /api/sales/pickup-order/get-price | PriceResult | 价证取价 |
| 8 | updateSignApi | POST | /api/sales/pickup-order/update-sign-status | SubmitResult | 更新签署 |
| 9 | createChangeApi | POST | /api/sales/pickup-order/change | SubmitResult | 创建变更 |

### 数据库表设计

```sql
-- ============================================
-- 提货单主表
-- ============================================
CREATE TABLE t_pickup_order (
    id                      BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    order_no                VARCHAR(50) NOT NULL COMMENT '单据编号 → HeaderData.orderNo [格式:T+基地+仓库+日期+流水]',
    order_type              VARCHAR(50) DEFAULT '标准提货单' COMMENT '单据类型 → HeaderData.orderType',
    document_status         VARCHAR(20) DEFAULT '暂存' COMMENT '单据状态 → HeaderData.documentStatus [暂存|已提交|已审核|关闭状态]',
    close_status            VARCHAR(10) DEFAULT '否' COMMENT '关闭状态 → HeaderData.closeStatus [是|否]',
    sign_status             VARCHAR(20) DEFAULT '未签署' COMMENT '签署状态 → HeaderData.signStatus [未签署|已签署]',
    mms_download_complete   VARCHAR(10) DEFAULT '否' COMMENT 'MMS下发完成 → HeaderData.mmsDownloadComplete',
    logistics_download_complete VARCHAR(10) DEFAULT '否' COMMENT '物流下发完成 → HeaderData.logisticsDownloadComplete',

    -- 业务单元信息 → BusinessUnitData
    organization_code       VARCHAR(50) NOT NULL COMMENT '组织编码',
    organization_name       VARCHAR(100) NOT NULL COMMENT '所属组织 [柳钢集团|柳钢股份|广西钢铁|中金公司]',
    base_code               VARCHAR(10) NOT NULL COMMENT '基地编码 [01|02|03]',
    base_name               VARCHAR(50) NOT NULL COMMENT '基地名称 [柳州基地|防城港基地|玉林中金]',
    warehouse_code          VARCHAR(20) NOT NULL COMMENT '仓库编码',
    warehouse_name          VARCHAR(100) COMMENT '仓库名称',
    storage_area            VARCHAR(100) COMMENT '出库库区',

    -- 时间信息 → TimeData
    plan_execute_time       DATETIME NOT NULL COMMENT '计划执行时间 [默认:系统当天]',
    plan_end_time           DATETIME NOT NULL COMMENT '计划结束时刻 [计算:+7天或+5天]',
    remark                  TEXT COMMENT '备注',

    -- 关联合同信息 → ContractData
    contract_id             BIGINT NOT NULL COMMENT '合同ID',
    contract_no             VARCHAR(50) NOT NULL COMMENT '合同编号',
    contract_valid_date     DATE NOT NULL COMMENT '合同有效期',
    sales_price_policy      VARCHAR(100) COMMENT '销售价格政策',
    payment_policy          VARCHAR(100) COMMENT '付款政策',
    sales_payment_method    VARCHAR(100) COMMENT '销售付款方式',
    order_weight            DECIMAL(18,4) COMMENT '订货重量',
    tolerance_upper_limit   DECIMAL(5,2) DEFAULT 0 COMMENT '交货重量公差上限(%)',
    allocated_amount        DECIMAL(18,2) COMMENT '配款金额',

    -- 资金信息 → FundData
    fund_pool_balance       DECIMAL(18,2) COMMENT '资金池余额',
    total_tax_amount        DECIMAL(18,2) COMMENT '价税合计',
    freight_mark            VARCHAR(10) DEFAULT '否' COMMENT '运费标记 [是|否]',

    -- 审计字段
    create_by               VARCHAR(50) COMMENT '创建人',
    create_time             DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by               VARCHAR(50) COMMENT '更新人',
    update_time             DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag                TINYINT DEFAULT 0 COMMENT '删除标记 [0:正常 1:删除]',

    -- 索引
    UNIQUE KEY uk_order_no (order_no),
    INDEX idx_document_status (document_status),
    INDEX idx_base_code (base_code),
    INDEX idx_contract_id (contract_id),
    INDEX idx_create_time (create_time DESC)
) COMMENT '提货单主表 → PageModel.HeaderData + BusinessUnitData + TimeData + ContractData + FundData';


-- ============================================
-- 提货单明细表
-- ============================================
CREATE TABLE t_pickup_order_line (
    id                      BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    order_id                BIGINT NOT NULL COMMENT '提货单ID → 关联主表',
    line_no                 INT NOT NULL COMMENT '行号 → MaterialItem.lineNo',

    -- 物料信息 → MaterialItem.materialData
    material_code           VARCHAR(50) NOT NULL COMMENT '物料编码',
    material_name           VARCHAR(200) NOT NULL COMMENT '物料名称',
    specification           VARCHAR(200) COMMENT '规格',
    unit                    VARCHAR(20) COMMENT '单位',

    -- 数量信息 → MaterialItem.quantityData
    plan_weight             DECIMAL(18,4) NOT NULL COMMENT '计划重量',
    fulfilled_weight        DECIMAL(18,4) DEFAULT 0 COMMENT '已履约重量 [只读]',
    cumulative_valid_plan_weight DECIMAL(18,4) DEFAULT 0 COMMENT '累计有效计划重量',

    -- 价格信息 → MaterialItem.priceData
    unit_price              DECIMAL(18,4) COMMENT '单价',
    tax_rate                DECIMAL(5,2) COMMENT '税率',
    tax_amount              DECIMAL(18,2) COMMENT '税额',
    total_amount            DECIMAL(18,2) COMMENT '金额',

    -- 库区信息 → MaterialItem.storageData
    storage_area            VARCHAR(100) COMMENT '库区',
    is_logistics_park       TINYINT DEFAULT 0 COMMENT '是否物流园仓库 [0:否 1:是]',

    -- 状态信息 → MaterialItem.statusData
    line_close_status       VARCHAR(10) DEFAULT '否' COMMENT '行关闭状态 [是|否]',
    is_loaded               VARCHAR(10) DEFAULT '否' COMMENT '已装车 [是|否]',

    -- 关联合同明细
    contract_line_id        BIGINT COMMENT '合同明细ID',

    -- 审计字段
    create_time             DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time             DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    del_flag                TINYINT DEFAULT 0,

    -- 索引
    INDEX idx_order_id (order_id),
    INDEX idx_material_code (material_code)
) COMMENT '提货单明细表 → MaterialItem';


-- ============================================
-- 提货单变更记录表
-- ============================================
CREATE TABLE t_pickup_order_change (
    id                      BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    change_no               VARCHAR(50) NOT NULL COMMENT '变更单号',
    order_id                BIGINT NOT NULL COMMENT '原提货单ID',
    order_no                VARCHAR(50) NOT NULL COMMENT '原单据编号',
    change_type             VARCHAR(50) NOT NULL COMMENT '变更类型 [提单时间变更]',

    -- 变更前值
    old_plan_execute_time   DATETIME COMMENT '原计划执行时间',
    old_plan_end_time       DATETIME COMMENT '原计划结束时刻',

    -- 变更后值
    new_plan_execute_time   DATETIME COMMENT '新计划执行时间',
    new_plan_end_time       DATETIME COMMENT '新计划结束时刻',

    -- 状态
    change_status           VARCHAR(20) DEFAULT '待审批' COMMENT '变更状态 [待审批|已生效|已拒绝]',

    -- 审计字段
    create_by               VARCHAR(50),
    create_time             DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time             DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_order_id (order_id)
) COMMENT '提货单变更记录表';


-- ============================================
-- 提货单操作日志表
-- ============================================
CREATE TABLE t_pickup_order_log (
    id                      BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    order_id                BIGINT NOT NULL COMMENT '提货单ID',
    operation_type          VARCHAR(50) NOT NULL COMMENT '操作类型 [创建|提交|审批|下传|关闭|变更]',
    operation_desc          VARCHAR(500) COMMENT '操作描述',

    -- MMS下传相关
    target_system           VARCHAR(50) COMMENT '目标系统 [本部MMS|广钢MMS|中金MMS|物流系统]',
    interface_name          VARCHAR(100) COMMENT '接口名称',
    request_data            TEXT COMMENT '请求数据',
    response_data           TEXT COMMENT '响应数据',
    response_status         VARCHAR(20) COMMENT '响应状态 [成功|失败]',

    -- 审计字段
    operator                VARCHAR(50) COMMENT '操作人',
    operate_time            DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',

    INDEX idx_order_id (order_id),
    INDEX idx_operate_time (operate_time DESC)
) COMMENT '提货单操作日志表';
```

### 核心SQL查询

```sql
-- ============================================
-- 1. 列表查询（返回 HeaderData[]）
-- ============================================
SELECT
    o.id,
    o.order_no AS orderNo,
    o.order_type AS orderType,
    o.document_status AS documentStatus,
    o.close_status AS closeStatus,
    o.sign_status AS signStatus,
    o.organization_name AS organizationName,
    o.base_name AS baseName,
    o.warehouse_name AS warehouseName,
    o.plan_execute_time AS planExecuteTime,
    o.plan_end_time AS planEndTime,
    o.total_tax_amount AS totalTaxAmount,
    o.mms_download_complete AS mmsDownloadComplete,
    o.create_time AS createTime
FROM t_pickup_order o
WHERE o.del_flag = 0
    AND (#{orderNo} IS NULL OR o.order_no LIKE CONCAT('%', #{orderNo}, '%'))
    AND (#{documentStatus} IS NULL OR o.document_status = #{documentStatus})
    AND (#{baseCode} IS NULL OR o.base_code = #{baseCode})
    AND (#{startDate} IS NULL OR o.plan_execute_time >= #{startDate})
    AND (#{endDate} IS NULL OR o.plan_execute_time <= #{endDate})
ORDER BY o.create_time DESC
LIMIT #{pageSize} OFFSET #{offset};


-- ============================================
-- 2. 详情查询（返回 PageModel）
-- ============================================
-- 主表查询
SELECT
    o.*,
    c.contract_no AS contractNo,
    c.valid_date AS contractValidDate
FROM t_pickup_order o
LEFT JOIN t_sales_contract c ON o.contract_id = c.id
WHERE o.id = #{orderId} AND o.del_flag = 0;

-- 明细查询
SELECT
    l.id AS lineId,
    l.line_no AS lineNo,
    l.material_code AS materialCode,
    l.material_name AS materialName,
    l.specification,
    l.unit,
    l.plan_weight AS planWeight,
    l.fulfilled_weight AS fulfilledWeight,
    l.unit_price AS unitPrice,
    l.tax_rate AS taxRate,
    l.tax_amount AS taxAmount,
    l.total_amount AS totalAmount,
    l.storage_area AS storageArea,
    l.line_close_status AS lineCloseStatus,
    l.is_loaded AS isLoaded
FROM t_pickup_order_line l
WHERE l.order_id = #{orderId} AND l.del_flag = 0
ORDER BY l.line_no;


-- ============================================
-- 3. 提单数量校验
-- ============================================
-- 条件1: 实际出库累计校验
SELECT
    l.id AS lineId,
    l.plan_weight AS planWeight,
    l.fulfilled_weight AS fulfilledWeight,
    c.order_weight AS contractOrderWeight,
    c.tolerance_upper_limit AS toleranceUpperLimit,
    (l.plan_weight + l.fulfilled_weight) AS totalWeight,
    (c.order_weight * (1 + c.tolerance_upper_limit / 100)) AS maxAllowedWeight,
    CASE
        WHEN (l.plan_weight + l.fulfilled_weight) <= (c.order_weight * (1 + c.tolerance_upper_limit / 100))
        THEN 'PASS'
        ELSE 'FAIL'
    END AS validationResult
FROM t_pickup_order_line l
JOIN t_pickup_order o ON l.order_id = o.id
JOIN t_sales_contract_line c ON l.contract_line_id = c.id
WHERE o.id = #{orderId};

-- 条件2: 有效计划累计重量校验
SELECT
    SUM(l.plan_weight) AS totalPlanWeight
FROM t_pickup_order_line l
JOIN t_pickup_order o ON l.order_id = o.id
WHERE o.contract_id = #{contractId}
    AND o.document_status NOT IN ('关闭状态')
    AND o.del_flag = 0
    AND l.del_flag = 0;


-- ============================================
-- 4. 资金校验
-- ============================================
SELECT
    o.id,
    o.fund_pool_balance AS fundPoolBalance,
    o.allocated_amount AS allocatedAmount,
    o.total_tax_amount AS totalTaxAmount,
    CASE
        WHEN (o.fund_pool_balance / NULLIF(o.allocated_amount, 0)) >= o.total_tax_amount
        THEN 'PASS'
        ELSE 'FAIL'
    END AS fundValidationResult
FROM t_pickup_order o
WHERE o.id = #{orderId};


-- ============================================
-- 5. 关闭提货单 - 释放余款
-- ============================================
-- 计算释放金额
SELECT
    o.total_tax_amount AS orderTotalAmount,
    COALESCE(SUM(out.total_amount), 0) AS outboundTotalAmount,
    (o.total_tax_amount - COALESCE(SUM(out.total_amount), 0)) AS releaseAmount
FROM t_pickup_order o
LEFT JOIN t_sales_outbound out ON out.pickup_order_id = o.id AND out.del_flag = 0
WHERE o.id = #{orderId}
GROUP BY o.id;

-- 更新关闭状态
UPDATE t_pickup_order
SET close_status = '是',
    document_status = '关闭状态',
    update_by = #{operator},
    update_time = NOW()
WHERE id = #{orderId};


-- ============================================
-- 6. 自动关闭（定时任务）
-- ============================================
UPDATE t_pickup_order
SET close_status = '是',
    document_status = '关闭状态',
    update_time = NOW()
WHERE del_flag = 0
    AND document_status = '已审核'
    AND close_status = '否'
    AND plan_end_time < NOW();


-- ============================================
-- 7. 单据编号生成
-- ============================================
-- 获取当日最大流水号
SELECT MAX(CAST(SUBSTRING(order_no, -4) AS UNSIGNED)) AS maxSerial
FROM t_pickup_order
WHERE order_no LIKE CONCAT('T', #{baseCode}, #{warehouseCode}, DATE_FORMAT(NOW(), '%y%m%d'), '%');

-- 生成新编号: T + 基地编码(2位) + 仓库编码(3位) + 年月日(6位) + 流水(4位)
-- 示例: T01W022509220001
```

### MVP清单

| 序号 | 功能 | 对应数据模型 | 涉及表 | 接口 | 优先级 |
|------|------|--------------|--------|------|--------|
| 1 | 提货单列表查询 | HeaderData[] | t_pickup_order | GET /list | P0 |
| 2 | 提货单详情查询 | PageModel | t_pickup_order, t_pickup_order_line | GET /{id} | P0 |
| 3 | 创建提货单 | PageModel | t_pickup_order, t_pickup_order_line | POST /create | P0 |
| 4 | 提交校验 | ValidationResult | t_pickup_order, t_sales_contract | POST /submit | P0 |
| 5 | 下传MMS | DownloadResult | t_pickup_order, t_pickup_order_log | POST /download | P0 |
| 6 | 关闭提货单 | SubmitResult | t_pickup_order | POST /close | P1 |
| 7 | 价证取价 | PriceResult | t_pickup_order_line | POST /get-price | P1 |
| 8 | 过户删除 | SubmitResult | t_pickup_order | POST /transfer-delete | P2 |
| 9 | 更新签署状态 | SubmitResult | t_pickup_order | POST /update-sign-status | P2 |
| 10 | 创建变更单 | SubmitResult | t_pickup_order_change | POST /change | P2 |

**MVP统计：4张核心表 + 10个接口 = 最小可行后端**

### 外部系统接口对接

| 基地 | 目标系统 | 接口电文 | 用途 |
|------|----------|----------|------|
| 柳州基地 | 本部MMS | 提单主表电文接口 | 下传提单主表 |
| 柳州基地 | 本部MMS | 提单明细电文接口 | 下传提单明细 |
| 柳州基地 | 本部MMS | 提单车号电文接口 | 下传车号信息 |
| 柳州基地 | 本部MMS | 本部下传反馈接口 | 接收下传结果 |
| 防城港基地 | 广钢MMS | 广钢提单主表电文 | 下传提单主表 |
| 防城港基地 | 广钢MMS | 广钢提单明细电文 | 下传提单明细 |
| 防城港基地 | 广钢MMS | 广钢下传反馈接口 | 接收下传结果 |
| 防城港基地 | 防城港物流 | 广钢物流提单主表电文 | 下传物流信息 |
| 防城港基地 | 防城港物流 | 广钢物流提单明细电文 | 下传物流明细 |
| 玉林中金 | 中金MMS | 中金提单主表和明细表电文 | 下传提单信息 |
| 玉林中金 | 中金MMS | 中金下传反馈接口 | 接收下传结果 |
| 物流园 | CMS本部物流 | 提单运费电文 | 运费校验请求 |
| 物流园 | CMS本部物流 | 运费确认电文 | 运费校验结果 |
| 物流园 | WMS本部物流 | 过户删除回复电文 | 过户删除请求 |
| 物流园 | WMS本部物流 | 物流下传反馈接口 | 接收下传结果 |
| 全部 | 可信平台 | 提单推送至可信签署 | 推送签署请求 |
| 全部 | 可信平台 | 核对明细函推送至可信签署 | 接收签署结果 |
| 全部 | CRM系统 | PDF推送接口 | 推送双签PDF |

---

## 🎯 质量评估

| 维度 | 评分 | 说明 |
|------|------|------|
| 数据模型 | 9 | 完整覆盖表头、明细、业务规则，字段与业务逻辑绑定清晰 |
| 结构完整性 | 9 | 所有业务场景都有层级标注，包含创建、校验、下传、关闭、变更全流程 |
| 数据绑定 | 9 | 所有动态数据均有[data:字段]标注，与数据模型对应 |
| 位置精确度 | 8 | 有完整布局图，表格列宽比例明确，弹窗布局清晰 |
| 组件拆分 | 9 | L1/L2/L3层级清晰，区域划分合理（8个L2，约35个L3） |
| 复用标记 | 8 | 共享组件标记完整，模块内复用关系清晰 |
| 交互描述 | 9 | 覆盖所有业务流程，包含5个完整的流程图 |
| 代码映射 | 9 | 完整对应文件结构，可直接创建项目 |
| 接口+后端 | 9 | 9个接口完整定义，4张核心表，SQL可直接执行 |
| 业务规则 | 10 | 完整覆盖所有校验规则、计算公式、接口对接 |

**综合评分：9.0分**

---

*v1.0 - 销售中心提货单结构指导文档*

*文档说明：*
- *本文档基于业务逻辑详设转换而成*
- *覆盖提货单全生命周期：创建 → 校验 → 审批 → 下传 → 关闭/变更*
- *包含5种校验规则的完整逻辑*
- *包含3种基地的MMS对接方案*
- *包含物流园特殊处理流程*
