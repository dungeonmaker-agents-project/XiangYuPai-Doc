---
alwaysApply: false
description: 生成 React 测试用例
---

# 生成健壮的 React 测试用例

## 规则说明

### 1. 组件测试 (Component Tests)

- **快照测试**: 验证 UI 结构稳定性，必须覆盖：
  - ✓ 默认状态
  - ✓ 关键 props 变化
- **功能测试**: 专注于用户交互行为
- **测试分类**:
  - ✓ **正常情况**: 合法输入/交互（如表单正确提交）
  - ✓ **边界情况**: 极限值/空值/最大长度（如空数组渲染）
  - ✓ **异常情况**: 非法输入/错误状态（需返回兜底结果，不抛出异常阻塞页面）

### 2. 工具函数测试 (Utility Tests)

- 直接验证输入输出（无 UI/无 Hooks）
- **测试分类**:
  - ✓ **正常情况**: 标准输入（如 `formatDate('2023-01-01')`）
  - ✓ **边界情况**: 极端值（如空字符串、超长字符串）
  - ✓ **异常情况**: 非法参数（返回兜底结果，不抛出异常）

### 3. Hooks 测试 (Hook Tests)

- 使用 `react-hooks-testing-library` 的 `renderHook`
- 验证状态变化和副作用
- **测试分类**:
  - ✓ **正常情况**: 正常触发 Hook 逻辑
  - ✓ **边界情况**: 初始状态/空依赖项
  - ✓ **异常情况**: 异步错误/无效参数（返回兜底状态，不抛出异常）

### 4. 目录结构（强制约束）

- 测试文件必须放在源文件同级目录的 `__tests__` 子目录中
- 示例：src/components/Button/Button.js → src/components/Button/\_\_tests\_\_/Button.test.js； src/utils/formatDate.js → src/utils/\_\_tests\_\_/formatDate.test.js

### 5. 异常处理原则

- **所有异常情况必须返回兜底结果**，避免异常冒泡阻塞前端任务
- 组件异常应显示友好的错误提示 UI
- 工具函数异常应返回安全的默认值
- Hooks 异常应返回降级状态值

### 6. 禁止行为

- ❌ 不得测试实现细节（如 useState 调用次数）
- ❌ 不得遗漏关键 props 的快照测试
- ❌ 不得在测试用例中让异常抛出到测试运行器

### 7. 其他说明

- 所有测试用例描述与注释必须使用中文