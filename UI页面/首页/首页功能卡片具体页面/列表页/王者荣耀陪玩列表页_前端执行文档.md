# ç‹è€…è£è€€æŠ€èƒ½æœåŠ¡åˆ—è¡¨é¡µ - å‰ç«¯æ‰§è¡Œæ–‡æ¡£

> **ç‰ˆæœ¬**: v1.4
> **æ›´æ–°æ—¥æœŸ**: 2025-12-09
> **å…³è”æ–‡æ¡£**:
> - [ç‹è€…è£è€€é™ªç©åˆ—è¡¨é¡µ_ç»“æ„æ–‡æ¡£.md](./ç‹è€…è£è€€é™ªç©åˆ—è¡¨é¡µ_ç»“æ„æ–‡æ¡£.md) (æ•°æ®æ¨¡å‹æ¥æº)
> - [ç‹è€…è£è€€é™ªç©åˆ—è¡¨é¡µ_PRD.md](./ç‹è€…è£è€€é™ªç©åˆ—è¡¨é¡µ_PRD.md) (ä¸šåŠ¡éœ€æ±‚)
> - [çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md](../çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µ/çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md) (è¯¦æƒ…é¡µ-çº¿ä¸Š)
> - [çº¿ä¸‹æ´»åŠ¨è¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md](../çº¿ä¸‹æ´»åŠ¨è¯¦æƒ…é¡µ/çº¿ä¸‹æ´»åŠ¨è¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md) (è¯¦æƒ…é¡µ-çº¿ä¸‹)
> **åç«¯å¯¹æ¥**:
> - BFFæœåŠ¡: `xypai-app-bff` (ç«¯å£: 9400)
> - é¢†åŸŸæœåŠ¡: `xypai-user` (ç«¯å£: 9401)
> - æ•°æ®åº“: `xypai_user` (MySQL)
> **å‰ç«¯å®ç°**: `src/features/GameSkill/` (å·²å®ç°)

---

## 1. æ¨¡å—ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|------|
| æ¨¡å—åç§° | GameSkill |
| æ¨¡å—è·¯å¾„ | `src/features/GameSkill/` |
| é¡µé¢åç§° | GameSkillList |
| é¡µé¢è·¯ç”± | `/(tabs)/homepage/game-player-list` |
| è·¯ç”±å‚æ•° | `skillType` (æŠ€èƒ½ç±»å‹), `gameId` (æ¸¸æˆID) |
| æ·±é“¾æ¥ | `xyp://skill/list/{gameId}` |
| è¯¦æƒ…é¡µè·³è½¬ | â†’ `OnlineGameDetailPage` (æºå¸¦ skillId â†’ companionId) |

---

## 1.1 é¡µé¢å¯¼èˆªå…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é¦–é¡µ Homepage                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç‹è€…è£è€€é™ªç©  â”‚  â”‚  çº¿ä¸‹æ´»åŠ¨     â”‚  â”‚   å…¶ä»–æ¸¸æˆ    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                  â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                  â”‚
           â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GameSkillList    â”‚  â”‚ OfflineActivity  â”‚
â”‚ (åˆ—è¡¨é¡µ-æœ¬æ–‡æ¡£)  â”‚  â”‚   List           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ç‚¹å‡»å¡ç‰‡
         â”‚ skillId â†’ companionId
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OnlineGameDetail â”‚  â† çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md
â”‚  (è¯¦æƒ…é¡µ)        â”‚
â”‚                  â”‚
â”‚ - UserInfoArea   â”‚
â”‚ - TagsArea       â”‚
â”‚ - SkillIntroArea â”‚
â”‚ - ReviewsArea    â”‚
â”‚ - ActionBarArea  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµæ˜ å°„ (åˆ—è¡¨ â†’ è¯¦æƒ…)

| åˆ—è¡¨é¡µå­—æ®µ (SkillServiceItem) | è¯¦æƒ…é¡µå­—æ®µ (CompanionDetailData) | è¯´æ˜ |
|------------------------------|----------------------------------|------|
| `skillId` | `companionId` | ä¸»é”®æ˜ å°„ (åç«¯åŒä¸€ID) |
| `userId` | `basicInfo.userId` | ç”¨æˆ·IDé€ä¼  |
| `avatarData.avatarUrl` | `basicInfo.avatar` | å¤´åƒä¸€è‡´ |
| `basicData.nickname` | `basicInfo.nickname` | æ˜µç§°ä¸€è‡´ |
| `basicData.isOnline` | `basicInfo.isOnline` | åœ¨çº¿çŠ¶æ€ä¸€è‡´ |
| `priceData.price` | `basicInfo.pricePerGame` | ä»·æ ¼ä¸€è‡´ |
| `verificationData.isGodVerified` | `tagsData.expertBadge` | å¤§ç¥è®¤è¯ â†’ å¤§ç¥å¾½ç«  |
| `skillData.server` | `tagsData.serverTag` | qqâ†’QQåŒº, wechatâ†’å¾®ä¿¡åŒº |
| `skillData.gameRank` | `tagsData.rankTag` | æ®µä½ä¸€è‡´ |
| `skillData.peakScore` | `tagsData.peakTag` | å·…å³°åˆ† â†’ å·…å³°æ ‡ç­¾ |
| `skillData.description` | `skillData.skillDescription` | æè¿°ä¸€è‡´ |

---

## 2. æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| React Native | 0.81.4 | è·¨å¹³å°æ¡†æ¶ |
| Expo | ~54.0.10 | å¼€å‘å·¥å…·é“¾ |
| Expo Router | ~6.0.8 | æ–‡ä»¶è·¯ç”± |
| TypeScript | ~5.9.2 | ç±»å‹ç³»ç»Ÿ |
| Zustand | ^5.0.8 | çŠ¶æ€ç®¡ç† |

---

## 3. ç›®å½•ç»“æ„

> å®é™…å®ç°ç»“æ„ (2025-12-09 å·²å®ç°)

```
src/features/
â”‚
â”œâ”€ GameSkill/                              # æ¸¸æˆé™ªç©æ¨¡å— (åˆ—è¡¨é¡µ)
â”‚   â”‚
â”‚   â”œâ”€ index.ts                            # æ¨¡å—å…¥å£å¯¼å‡º
â”‚   â”œâ”€ Quick-Understanding.md              # æ¨¡å—è¯´æ˜æ–‡æ¡£
â”‚   â”‚
â”‚   â”œâ”€ api/                                # æ¨¡å—çº§API (åˆ†ç¦»å¼)
â”‚   â”‚   â”œâ”€ index.ts                        # APIå¯¼å‡ºå…¥å£
â”‚   â”‚   â”œâ”€ types.ts                        # ç±»å‹å®šä¹‰ (VOå‘½å)
â”‚   â”‚   â”œâ”€ apiGetSkillConfig.ts            # GET /xypai-app-bff/api/skill/config
â”‚   â”‚   â”œâ”€ apiGetSkillList.ts              # GET/POST /xypai-app-bff/api/skill/list
â”‚   â”‚   â””â”€ apiPostSkillOrder.ts            # POST /xypai-app-bff/api/skill/order
â”‚   â”‚
â”‚   â”œâ”€ stores/                             # æ¨¡å—çº§çŠ¶æ€
â”‚   â”‚   â”œâ”€ index.ts                        # Storeå¯¼å‡ºå…¥å£
â”‚   â”‚   â””â”€ useSkillStore.ts                # Zustand Store (å«Selector Hooks)
â”‚   â”‚
â”‚   â””â”€ GameSkillList/                      # é¡µé¢æ–‡ä»¶å¤¹ [L1]
â”‚       â”œâ”€ index.tsx                       # é¡µé¢ä¸»æ–‡ä»¶ (ç»„åˆæ‰€æœ‰L2åŒºåŸŸ)
â”‚       â”œâ”€ types.ts                        # è·¯ç”±å‚æ•°ç±»å‹
â”‚       â”œâ”€ constants.ts                    # æ¸¸æˆIDæ˜ å°„ã€é»˜è®¤å€¼
â”‚       â”œâ”€ NavArea.tsx                     # ğŸŸ¢ å¯¼èˆªåŒºåŸŸ [L2]
â”‚       â”œâ”€ FilterArea.tsx                  # ğŸŸ¢ ç­›é€‰æ§åˆ¶æ  [L2]
â”‚       â”œâ”€ TabArea.tsx                     # ğŸŸ¢ Tabåˆ‡æ¢æ  [L2]
â”‚       â”œâ”€ QuickTagArea.tsx                # ğŸŸ¢ å¿«æ·æ ‡ç­¾æ  [L2]
â”‚       â”œâ”€ ContentListArea/                # ğŸ”µ åˆ—è¡¨åŒºåŸŸ [L2]
â”‚       â”‚   â”œâ”€ index.tsx                   # FlatListå®¹å™¨
â”‚       â”‚   â”œâ”€ types.ts                    # åŒºåŸŸProps
â”‚       â”‚   â””â”€ SkillServiceCard/           # å¡ç‰‡ç»„ä»¶ [L3]
â”‚       â”‚       â”œâ”€ index.tsx               # å¡ç‰‡ä¸»ç»„ä»¶ (memo)
â”‚       â”‚       â”œâ”€ types.ts                # å¡ç‰‡Props
â”‚       â”‚       â””â”€ styles.ts               # å¡ç‰‡æ ·å¼
â”‚       â””â”€ modals/                         # åº•éƒ¨å¼¹çª—ç»„ä»¶
â”‚           â”œâ”€ index.ts                    # Modalå¯¼å‡ºå…¥å£
â”‚           â”œâ”€ SortBottomSheet.tsx         # æ’åºé€‰æ‹©å¼¹çª—
â”‚           â”œâ”€ GenderBottomSheet.tsx       # æ€§åˆ«ç­›é€‰å¼¹çª—
â”‚           â””â”€ FilterBottomSheet.tsx       # é«˜çº§ç­›é€‰é¢æ¿
â”‚
â”œâ”€ OnlineGame/                             # çº¿ä¸Šæ¸¸æˆæ¨¡å— (è¯¦æƒ…é¡µ)
â”‚   â”œâ”€ OnlineGameDetail/                   # â† çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md
â”‚   â”‚   â”œâ”€ index.tsx
â”‚   â”‚   â”œâ”€ NavArea.tsx
â”‚   â”‚   â”œâ”€ GameProfileArea/
â”‚   â”‚   â”œâ”€ UserInfoArea.tsx
â”‚   â”‚   â”œâ”€ TagsArea.tsx
â”‚   â”‚   â”œâ”€ SkillIntroArea.tsx
â”‚   â”‚   â”œâ”€ ReviewsArea/
â”‚   â”‚   â””â”€ ActionBarArea.tsx
â”‚   â””â”€ SharedComponents/
â”‚       â”œâ”€ StarRating/
â”‚       â””â”€ TagBadge/
â”‚
â”œâ”€ Activity/                               # æ´»åŠ¨æ¨¡å— (çº¿ä¸‹è¯¦æƒ…é¡µ)
â”‚   â””â”€ OfflineActivityDetail/              # â† çº¿ä¸‹æ´»åŠ¨è¯¦æƒ…é¡µ_ç»“æ„æ–‡æ¡£.md
â”‚       â”œâ”€ index.tsx
â”‚       â”œâ”€ NavArea.tsx
â”‚       â”œâ”€ GameProfileArea.tsx
â”‚       â”œâ”€ HostInfoArea.tsx
â”‚       â”œâ”€ ActivityDescArea/
â”‚       â”œâ”€ ReviewsArea/
â”‚       â””â”€ ActionBarArea.tsx
â”‚
â””â”€ Common/                                 # å…¬å…±æ¨¡å— (è·¨æ¨¡å—å…±äº«)
    â”œâ”€ components/                         # å…¨å±€å…±äº«ç»„ä»¶
    â”‚   â”œâ”€ Avatar/                         # å¤´åƒç»„ä»¶
    â”‚   â”œâ”€ Button/                         # æŒ‰é’®ç»„ä»¶
    â”‚   â”œâ”€ Badge/                          # å¾½ç« ç»„ä»¶
    â”‚   â””â”€ NavBar/                         # å¯¼èˆªæ ç»„ä»¶
    â””â”€ hooks/
        â””â”€ useNavigation.ts                # å¯¼èˆªHook
```

### æ–‡ä»¶å‘½åè§„èŒƒ (å®é™…ä½¿ç”¨)

| ç±»å‹ | å‘½åæ ¼å¼ | ç¤ºä¾‹ |
|------|----------|------|
| é¡µé¢ä¸»æ–‡ä»¶ | index.tsx | GameSkillList/index.tsx |
| ç±»å‹å®šä¹‰ | types.ts | api/types.ts |
| Storeæ–‡ä»¶ | use{Name}Store.ts | useSkillStore.ts |
| APIå‡½æ•° | api{Method}{Name}.ts | apiGetSkillList.ts |
| ğŸŸ¢ç®€å•åŒºåŸŸ | {Name}Area.tsx | NavArea.tsx, QuickTagArea.tsx |
| ğŸ”µå¤æ‚åŒºåŸŸ | {Name}Area/ | ContentListArea/ |
| å­ç»„ä»¶ | {Name}/ | SkillServiceCard/ |
| å¼¹çª—ç»„ä»¶ | {Name}BottomSheet.tsx | SortBottomSheet.tsx |

---

## 4. ç±»å‹å®šä¹‰

> æ¥æº: `src/features/GameSkill/api/types.ts` (å®é™…å®ç°)

```typescript
// api/types.ts

// ==================== è¯·æ±‚ç±»å‹ REQUEST TYPES ====================

/**
 * æ’åºç±»å‹
 * smart: AIæ¨è | newest: æœ€æ–°å‘å¸ƒ | recent: æœ€è¿‘æ´»è·ƒ
 * popular: çƒ­é—¨æ¨è | price_asc/desc: ä»·æ ¼æ’åº
 */
export type SortType = 'smart' | 'newest' | 'recent' | 'popular' | 'price_asc' | 'price_desc';

/**
 * æ€§åˆ«ç­›é€‰
 */
export type GenderType = 'all' | 'male' | 'female';

/**
 * é«˜çº§ç­›é€‰å‚æ•°
 */
export interface SkillFiltersParams {
  status?: 'all' | 'online' | 'active_3d' | 'active_7d';
  region?: string[];              // å¤§åŒº: ['qq', 'wechat']
  rank?: string[];                // æ®µä½: ['glory_king', 'supreme_master']
  priceRange?: string;            // ä»·æ ¼åŒºé—´: '4-9', '10-19', '20+'
  position?: string[];            // ä½ç½®: ['jungle', 'mid']
  tags?: string[];                // æ ‡ç­¾: ['peak', 'boost']
  location?: 'same_city';         // ä½ç½®çº¦æŸ
  cityCode?: string;              // åŸå¸‚ä»£ç 
}

/**
 * åˆ—è¡¨æŸ¥è¯¢å‚æ•°
 */
export interface SkillListQueryParams {
  gameId: string;                 // æ¸¸æˆID (å¿…å¡«)
  tabType?: string;               // Tabç±»å‹: glory_king, online, boost, coach, companion, expert
  sortBy?: SortType;              // æ’åºç­–ç•¥
  gender?: GenderType;            // æ€§åˆ«ç­›é€‰
  pageNum?: number;               // é¡µç  (é»˜è®¤: 1)
  pageSize?: number;              // æ¯é¡µæ•°é‡ (é»˜è®¤: 20)
  latitude?: number;              // ç”¨æˆ·çº¬åº¦ (è·ç¦»è®¡ç®—)
  longitude?: number;             // ç”¨æˆ·ç»åº¦ (è·ç¦»è®¡ç®—)
  filters?: SkillFiltersParams;   // é«˜çº§ç­›é€‰æ¡ä»¶
}

// ==================== é…ç½®å“åº”ç±»å‹ CONFIG RESPONSE ====================

/**
 * é€šç”¨é€‰é¡¹
 */
export interface OptionVO {
  value: string;
  label: string;
}

/**
 * ä»·æ ¼åŒºé—´é€‰é¡¹
 */
export interface PriceRangeOptionVO {
  value: string;
  label: string;
  min: number;
  max?: number;                   // å¯é€‰ (ç”¨äºå¼€æ”¾åŒºé—´å¦‚ "20+")
}

/**
 * æ¸¸æˆä¿¡æ¯
 */
export interface GameInfoVO {
  gameId: string;
  gameName: string;
  icon?: string;
}

/**
 * Tabé…ç½®
 */
export interface TabVO {
  value: string;
  label: string;
  count?: number;                 // å¯é€‰è®¡æ•°å¾½ç« 
}

/**
 * ç­›é€‰é€‰é¡¹é…ç½®
 */
export interface FilterOptionsVO {
  sortOptions: OptionVO[];
  genderOptions: OptionVO[];
  statusOptions: OptionVO[];
  regionOptions: OptionVO[];
  rankOptions: OptionVO[];
  priceRangeOptions: PriceRangeOptionVO[];
  positionOptions: OptionVO[];
  tagOptions: OptionVO[];
}

/**
 * å¿«æ·æ ‡ç­¾
 */
export interface QuickTagVO {
  id: string;
  label: string;
  icon?: string;
  filterKey: string;              // ç›®æ ‡ç­›é€‰å‚æ•°é”®
  filterValue: string;            // ç­›é€‰å€¼
}

/**
 * é…ç½®æ¥å£å“åº”
 * @ç«¯ç‚¹ GET /xypai-app-bff/api/skill/config
 */
export interface SkillConfigResponse {
  gameInfo: GameInfoVO;
  tabs: TabVO[];
  filterOptions: FilterOptionsVO;
  quickTags: QuickTagVO[];
}

// ==================== åˆ—è¡¨å“åº”ç±»å‹ LIST RESPONSE ====================

/**
 * å¤´åƒæ•°æ®
 */
export interface AvatarDataVO {
  avatarUrl: string;
}

/**
 * åŸºç¡€ä¿¡æ¯
 */
export interface BasicDataVO {
  nickname: string;
  gender: 'male' | 'female' | 'other';
  age?: number;
  distance?: number;              // è·ç¦» (ç±³)
  distanceDisplay?: string;       // æ ¼å¼åŒ–æ˜¾ç¤º: "3.2km"
  isOnline: boolean;
}

/**
 * è®¤è¯æ•°æ®
 */
export interface VerificationDataVO {
  isRealVerified: boolean;        // å®åè®¤è¯
  isGodVerified: boolean;         // å¤§ç¥è®¤è¯
  isVip: boolean;                 // VIPä¼šå‘˜
}

/**
 * æ¸¸æˆå±æ€§
 */
export interface GameAttrsVO {
  position?: string[];            // ä½ç½®: ['jungle', 'mid']
  tags?: string[];                // æ ‡ç­¾: ['peak', 'boost']
}

/**
 * æŠ€èƒ½æ•°æ®
 */
export interface SkillDataVO {
  skillName: string;
  gameName: string;
  gameRank?: string;              // å½“å‰æ®µä½
  peakScore?: number;             // å·…å³°åˆ†
  server?: string;                // å¤§åŒº
  gameAttrs?: GameAttrsVO;        // æ¸¸æˆå±æ€§
  description?: string;           // æœåŠ¡æè¿°
  rating: number;                 // è¯„åˆ† (0-5)
  orderCount: number;             // è®¢å•æ•°
}

/**
 * ä»·æ ¼æ•°æ®
 */
export interface PriceDataVO {
  price: number;                  // ä»·æ ¼æ•°å€¼
  unit: string;                   // å•ä½ (e.g., "gold_coin")
  displayText: string;            // æ ¼å¼åŒ–æ˜¾ç¤º: "10 é‡‘å¸/å±€"
}

/**
 * æŠ€èƒ½æœåŠ¡å¡ç‰‡æ•°æ®
 * @è¯´æ˜ åˆ—è¡¨é¡¹å®Œæ•´æ•°æ®ç»“æ„
 */
export interface SkillServiceItemVO {
  skillId: number;
  userId: number;
  avatarData: AvatarDataVO;
  basicData: BasicDataVO;
  verificationData: VerificationDataVO;
  skillData: SkillDataVO;
  priceData: PriceDataVO;
}

/**
 * åˆ—è¡¨æ¥å£å“åº”
 * @ç«¯ç‚¹ GET/POST /xypai-app-bff/api/skill/list
 */
export interface SkillListResponse {
  list: SkillServiceItemVO[];
  total: number;
  hasMore: boolean;
}

// ==================== è®¢å•ç±»å‹ ORDER TYPES ====================

/**
 * è®¢å•åˆ›å»ºå‚æ•°
 */
export interface SkillOrderParams {
  skillId: number;
  quantity: number;
  serviceType?: string;           // å¯é€‰æœåŠ¡å˜ä½“
}

/**
 * è®¢å•åˆ›å»ºå“åº”
 */
export interface SkillOrderResponse {
  success: boolean;
  orderId?: string;
  message?: string;
}
```

### ç±»å‹å‘½åè§„èŒƒ

| åˆ†ç±» | åç¼€ | ç¤ºä¾‹ |
|------|------|------|
| å“åº”å€¼å¯¹è±¡ | VO | `SkillServiceItemVO`, `TabVO` |
| è¯·æ±‚å‚æ•° | Params | `SkillListQueryParams`, `SkillFiltersParams` |
| æ¥å£å“åº” | Response | `SkillConfigResponse`, `SkillListResponse` |
| åŸºç¡€ç±»å‹ | Type | `SortType`, `GenderType` |

---

## 5. APIæ¥å£

> æ¥æº: ç»“æ„æ–‡æ¡£ STEP 6 æ¥å£å®šä¹‰
> åç«¯å¯¹æ¥: xypai-app-bff â†’ xypai-user (Dubbo RPC)

### 5.1 åç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   App å®¢æˆ·ç«¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ REST API (Gateway: 8080)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  xypai-app-bff  â”‚  â† æœ¬é¡µé¢å¯¹æ¥çš„ BFF æœåŠ¡
â”‚  (ç«¯å£: 9400)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Dubbo RPC è°ƒç”¨
         â”‚ RemoteAppUserService
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  xypai-user     â”‚  â† ç”¨æˆ·/æŠ€èƒ½é¢†åŸŸæœåŠ¡
â”‚  (ç«¯å£: 9401)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ MyBatis Plus
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ xypai_user      â”‚  â† MySQL æ•°æ®åº“
â”‚ (skills + users)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 RPC æ–¹æ³•å¯¹ç…§

| å‰ç«¯è°ƒç”¨ | BFF æ¥å£ | RPC æ–¹æ³• | æ•°æ®åº“è¡¨ |
|---------|---------|---------|---------|
| `apiGetSkillConfig` | `GET /xypai-app-bff/api/skill/config` | `getFilterConfig()` | skills (èšåˆç»Ÿè®¡) |
| `apiGetSkillList` | `GET/POST /xypai-app-bff/api/skill/list` | `querySkillServiceList()` | users + skills |
| `apiPostSkillOrder` | `POST /xypai-app-bff/api/skill/order` | - | orders |

### 5.3 API æ¥å£å®šä¹‰

> å®é™…å®ç°: åˆ†ç¦»å¼APIæ–‡ä»¶ç»“æ„

```typescript
// ==================== api/apiGetSkillConfig.ts ====================

import { api } from '@/services/api/config';
import type { SkillConfigResponse } from './types';

export interface GetSkillConfigParams {
  gameId: string;
}

/**
 * è·å–é¡µé¢é…ç½® (ç­›é€‰é¡¹ã€Tabåˆ—è¡¨ã€å¿«æ·æ ‡ç­¾)
 * @ç«¯ç‚¹ GET /xypai-app-bff/api/skill/config
 * @è§¦å‘æ—¶æœº é¡µé¢åˆå§‹åŒ–
 */
export async function apiGetSkillConfig(params: GetSkillConfigParams): Promise<SkillConfigResponse> {
  const response = await api.get<{ code: number; msg: string; data: SkillConfigResponse }>(
    '/xypai-app-bff/api/skill/config',
    { params }
  );

  if (response.data.code !== 200) {
    throw new Error(response.data.msg || 'Failed to get skill config');
  }

  return response.data.data;
}

// ==================== api/apiGetSkillList.ts ====================

import { api } from '@/services/api/config';
import type { SkillListQueryParams, SkillListResponse } from './types';

/**
 * è·å–æŠ€èƒ½æœåŠ¡åˆ—è¡¨
 * @ç«¯ç‚¹ GET/POST /xypai-app-bff/api/skill/list
 * @è¯´æ˜ ç®€å•æŸ¥è¯¢ä½¿ç”¨GET, å¤æ‚ç­›é€‰ä½¿ç”¨POST
 * @è§¦å‘æ—¶æœº é¡µé¢åˆå§‹åŒ–/ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½/ç­›é€‰/Tabåˆ‡æ¢
 */
export async function apiGetSkillList(params: SkillListQueryParams): Promise<SkillListResponse> {
  // æ™ºèƒ½è·¯ç”±: å¤æ‚ç­›é€‰ä½¿ç”¨POST, ç®€å•æŸ¥è¯¢ä½¿ç”¨GET
  const hasComplexFilters = params.filters && Object.keys(params.filters).length > 0;

  if (hasComplexFilters) {
    const { filters, ...queryParams } = params;
    const response = await api.post<{ code: number; msg: string; data: SkillListResponse }>(
      '/xypai-app-bff/api/skill/list',
      filters,
      { params: queryParams }
    );

    if (response.data.code !== 200) {
      throw new Error(response.data.msg || 'Failed to get skill list');
    }

    return response.data.data;
  }

  // ç®€å•GETè¯·æ±‚
  const response = await api.get<{ code: number; msg: string; data: SkillListResponse }>(
    '/xypai-app-bff/api/skill/list',
    { params }
  );

  if (response.data.code !== 200) {
    throw new Error(response.data.msg || 'Failed to get skill list');
  }

  return response.data.data;
}

// ==================== api/apiPostSkillOrder.ts ====================

import { api } from '@/services/api/config';
import type { SkillOrderParams, SkillOrderResponse } from './types';

/**
 * åˆ›å»ºæŠ€èƒ½æœåŠ¡è®¢å•
 * @ç«¯ç‚¹ POST /xypai-app-bff/api/skill/order
 * @è§¦å‘æ—¶æœº è¯¦æƒ…é¡µä¸‹å•
 */
export async function apiPostSkillOrder(params: SkillOrderParams): Promise<SkillOrderResponse> {
  const response = await api.post<{ code: number; msg: string; data: SkillOrderResponse }>(
    '/xypai-app-bff/api/skill/order',
    params
  );

  if (response.data.code !== 200) {
    throw new Error(response.data.msg || 'Failed to create order');
  }

  return response.data.data;
}

// ==================== api/index.ts (å¯¼å‡ºå…¥å£) ====================

export * from './types';
export { apiGetSkillConfig } from './apiGetSkillConfig';
export { apiGetSkillList } from './apiGetSkillList';
export { apiPostSkillOrder } from './apiPostSkillOrder';
```

### 5.4 æ•°æ®åº“å­—æ®µæ˜ å°„

> æ•°æ®åº“: xypai_user | è¡¨: skills + users

| å‰ç«¯å­—æ®µ | æ•°æ®åº“å­—æ®µ | è¯´æ˜ |
|---------|-----------|------|
| **skillId** | `skills.skill_id` | æŠ€èƒ½ä¸»é”® |
| **userId** | `skills.user_id` | ç”¨æˆ·ID |
| **avatarUrl** | `users.avatar` | ç”¨æˆ·å¤´åƒURL |
| **nickname** | `users.nickname` | ç”¨æˆ·æ˜µç§° |
| **gender** | `users.gender` | æ€§åˆ« (male/female) |
| **age** | `è®¡ç®—` | TIMESTAMPDIFF(YEAR, users.birthday, CURDATE()) |
| **distance** | `è®¡ç®—` | ST_Distance_Sphere(users.location, :userLocation) |
| **isOnline** | `users.is_online` | åœ¨çº¿çŠ¶æ€ |
| **isRealVerified** | `users.is_real_verified` | å®åè®¤è¯ |
| **isGodVerified** | `users.is_god_verified` | å¤§ç¥è®¤è¯ |
| **isVip** | `users.is_vip` | VIPçŠ¶æ€ |
| **skillName** | `skills.skill_name` | æŠ€èƒ½åç§° |
| **gameName** | `skills.game_name` | æ¸¸æˆåç§° |
| **gameRank** | `skills.game_rank` | æ¸¸æˆæ®µä½ (å…³è” skill_rank_config.rank_name) |
| **peakScore** | `skills.peak_score` | å·…å³°åˆ† (v1.0.8æ–°å¢) |
| **server** | `skills.server` | å¤§åŒº (qq/wechat) |
| **gameAttrs** | `skills.game_attrs` | JSON: {"position":[], "tags":[]} |
| **description** | `skills.description` | æŠ€èƒ½æè¿° |
| **rating** | `skills.rating` | è¯„åˆ† (0-5.00) |
| **orderCount** | `skills.order_count` | è®¢å•æ•° |
| **price** | `skills.price` | ä»·æ ¼ |
| **priceUnit** | `skills.price_unit` | ä»·æ ¼å•ä½ (å±€/å°æ—¶) |

### 5.5 ç›¸å…³æ•°æ®åº“è¡¨

```sql
-- xypai_user æ•°æ®åº“æ ¸å¿ƒè¡¨

-- 1. users ç”¨æˆ·è¡¨ (æ ¸å¿ƒå­—æ®µ)
users.user_id, users.nickname, users.avatar, users.gender, users.birthday
users.latitude, users.longitude, users.location (POINT)
users.is_online, users.is_real_verified, users.is_god_verified, users.is_vip

-- 2. skills æŠ€èƒ½è¡¨ (æ ¸å¿ƒå­—æ®µ)
skills.skill_id, skills.user_id, skills.skill_name, skills.skill_type
skills.game_name, skills.game_rank, skills.peak_score, skills.server
skills.game_attrs (JSON), skills.price, skills.price_unit
skills.rating, skills.order_count, skills.is_online

-- 3. skill_rank_config æ®µä½é…ç½®è¡¨
skill_rank_config.skill_config_id, skill_rank_config.server
skill_rank_config.rank_name, skill_rank_config.sort_order
```

---

## 6. Storeè®¾è®¡

> æ¥æº: `src/features/GameSkill/stores/useSkillStore.ts` (å®é™…å®ç°)

```typescript
// stores/useSkillStore.ts

import { create } from 'zustand';
import { apiGetSkillConfig, apiGetSkillList } from '../api';
import type {
  SkillConfigResponse,
  SkillServiceItemVO,
  TabVO,
  FilterOptionsVO,
  QuickTagVO,
  SortType,
  GenderType,
  SkillFiltersParams,
} from '../api/types';

// ==================== State Interface ====================

interface SkillState {
  // é…ç½®æ•°æ® (from apiGetSkillConfig)
  config: SkillConfigResponse | null;
  tabs: TabVO[];
  filterOptions: FilterOptionsVO | null;
  quickTags: QuickTagVO[];

  // åˆ—è¡¨æ•°æ® (from apiGetSkillList)
  skillList: SkillServiceItemVO[];
  total: number;
  hasMore: boolean;

  // å½“å‰ç­›é€‰é€‰æ‹©
  gameId: string;
  activeTab: string;
  sortBy: SortType;
  gender: GenderType;
  activeQuickTag: string | null;
  advancedFilters: SkillFiltersParams;

  // åˆ†é¡µçŠ¶æ€
  pageNum: number;
  pageSize: number;

  // åŠ è½½çŠ¶æ€
  isConfigLoading: boolean;
  isListLoading: boolean;
  isRefreshing: boolean;
  isLoadingMore: boolean;
  error: string | null;

  // ç”¨æˆ·åœ°ç†ä½ç½® (è·ç¦»è®¡ç®—)
  latitude: number | null;
  longitude: number | null;
}

interface SkillActions {
  // åˆå§‹åŒ–
  setGameId: (gameId: string) => void;
  setUserLocation: (lat: number, lng: number) => void;

  // æ•°æ®åŠ è½½
  loadConfig: () => Promise<void>;
  loadList: (isLoadMore?: boolean) => Promise<void>;
  refreshList: () => Promise<void>;

  // ç­›é€‰ä¿®æ”¹
  setActiveTab: (tab: string) => void;
  setSortBy: (sort: SortType) => void;
  setGender: (gender: GenderType) => void;
  toggleQuickTag: (tagId: string | null) => void;
  setAdvancedFilters: (filters: SkillFiltersParams) => void;
  resetFilters: () => void;

  // çŠ¶æ€é‡ç½®
  reset: () => void;
}

type SkillStore = SkillState & SkillActions;

// ==================== Initial State ====================

const initialState: SkillState = {
  config: null,
  tabs: [],
  filterOptions: null,
  quickTags: [],
  skillList: [],
  total: 0,
  hasMore: true,
  gameId: 'honor_of_kings',
  activeTab: 'glory_king',
  sortBy: 'smart',
  gender: 'all',
  activeQuickTag: null,
  advancedFilters: {},
  pageNum: 1,
  pageSize: 20,
  isConfigLoading: false,
  isListLoading: false,
  isRefreshing: false,
  isLoadingMore: false,
  error: null,
  latitude: null,
  longitude: null,
};

// ==================== Store ====================

export const useSkillStore = create<SkillStore>((set, get) => ({
  ...initialState,

  // è®¾ç½®æ¸¸æˆID, é‡ç½®åˆ—è¡¨çŠ¶æ€
  setGameId: (gameId: string) => {
    set({ gameId, pageNum: 1, skillList: [], hasMore: true });
  },

  // å­˜å‚¨ç”¨æˆ·ä½ç½® (ç”¨äºè·ç¦»æ’åº)
  setUserLocation: (lat: number, lng: number) => {
    set({ latitude: lat, longitude: lng });
  },

  // åŠ è½½é¡µé¢é…ç½® (tabs, filters, quickTags)
  loadConfig: async () => {
    const { gameId } = get();
    set({ isConfigLoading: true, error: null });

    try {
      const config = await apiGetSkillConfig({ gameId });
      set({
        config,
        tabs: config.tabs,
        filterOptions: config.filterOptions,
        quickTags: config.quickTags,
        isConfigLoading: false,
      });
    } catch (error) {
      set({
        error: error instanceof Error ? error.message : 'Failed to load config',
        isConfigLoading: false,
      });
    }
  },

  // åŠ è½½æŠ€èƒ½åˆ—è¡¨ (æ”¯æŒåˆ†é¡µ)
  loadList: async (isLoadMore = false) => {
    const state = get();

    // é˜²é‡å¤è¯·æ±‚
    if (isLoadMore && !state.hasMore) return;
    if (isLoadMore && state.isLoadingMore) return;
    if (!isLoadMore && state.isListLoading) return;

    const pageNum = isLoadMore ? state.pageNum + 1 : 1;

    set({
      isListLoading: !isLoadMore,
      isLoadingMore: isLoadMore,
      error: null,
    });

    try {
      // åˆå¹¶å¿«æ·æ ‡ç­¾åˆ°ç­›é€‰æ¡ä»¶
      const mergedFilters = { ...state.advancedFilters };
      if (state.activeQuickTag) {
        const quickTag = state.quickTags.find(t => t.id === state.activeQuickTag);
        if (quickTag && quickTag.filterKey === 'tags') {
          mergedFilters.tags = [...(mergedFilters.tags || []), quickTag.filterValue];
        }
      }

      const result = await apiGetSkillList({
        gameId: state.gameId,
        tabType: state.activeTab,
        sortBy: state.sortBy,
        gender: state.gender,
        pageNum,
        pageSize: state.pageSize,
        latitude: state.latitude ?? undefined,
        longitude: state.longitude ?? undefined,
        filters: Object.keys(mergedFilters).length > 0 ? mergedFilters : undefined,
      });

      set({
        skillList: isLoadMore ? [...state.skillList, ...result.list] : result.list,
        total: result.total,
        hasMore: result.hasMore,
        pageNum,
        isListLoading: false,
        isLoadingMore: false,
      });
    } catch (error) {
      set({
        error: error instanceof Error ? error.message : 'Failed to load list',
        isListLoading: false,
        isLoadingMore: false,
      });
    }
  },

  // ä¸‹æ‹‰åˆ·æ–°
  refreshList: async () => {
    set({ isRefreshing: true, pageNum: 1 });
    try {
      await get().loadList(false);
    } finally {
      set({ isRefreshing: false });
    }
  },

  // åˆ‡æ¢Tab (è§¦å‘åˆ—è¡¨é‡è½½)
  setActiveTab: (tab: string) => {
    set({ activeTab: tab, pageNum: 1, skillList: [], hasMore: true });
    get().loadList();
  },

  // åˆ‡æ¢æ’åº (è§¦å‘åˆ—è¡¨é‡è½½)
  setSortBy: (sort: SortType) => {
    set({ sortBy: sort, pageNum: 1, skillList: [], hasMore: true });
    get().loadList();
  },

  // åˆ‡æ¢æ€§åˆ«ç­›é€‰ (è§¦å‘åˆ—è¡¨é‡è½½)
  setGender: (gender: GenderType) => {
    set({ gender, pageNum: 1, skillList: [], hasMore: true });
    get().loadList();
  },

  // åˆ‡æ¢å¿«æ·æ ‡ç­¾ (è§¦å‘åˆ—è¡¨é‡è½½)
  toggleQuickTag: (tagId: string | null) => {
    const current = get().activeQuickTag;
    set({
      activeQuickTag: current === tagId ? null : tagId,
      pageNum: 1,
      skillList: [],
      hasMore: true,
    });
    get().loadList();
  },

  // åº”ç”¨é«˜çº§ç­›é€‰ (è§¦å‘åˆ—è¡¨é‡è½½)
  setAdvancedFilters: (filters: SkillFiltersParams) => {
    set({
      advancedFilters: filters,
      pageNum: 1,
      skillList: [],
      hasMore: true,
    });
    get().loadList();
  },

  // é‡ç½®æ‰€æœ‰ç­›é€‰
  resetFilters: () => {
    set({
      sortBy: 'smart',
      gender: 'all',
      activeQuickTag: null,
      advancedFilters: {},
      pageNum: 1,
      skillList: [],
      hasMore: true,
    });
    get().loadList();
  },

  // å®Œå…¨é‡ç½® (é¡µé¢å¸è½½æ—¶)
  reset: () => {
    set(initialState);
  },
}));

// ==================== Selector Hooks ====================

/** è·å–å®Œæ•´é…ç½® */
export const useSkillConfig = () => useSkillStore((s) => s.config);

/** è·å–Tabåˆ—è¡¨ */
export const useSkillTabs = () => useSkillStore((s) => s.tabs);

/** è·å–æŠ€èƒ½åˆ—è¡¨ */
export const useSkillList = () => useSkillStore((s) => s.skillList);

/** è·å–å½“å‰ç­›é€‰çŠ¶æ€ */
export const useSkillFilters = () => useSkillStore((s) => ({
  activeTab: s.activeTab,
  sortBy: s.sortBy,
  gender: s.gender,
  activeQuickTag: s.activeQuickTag,
  advancedFilters: s.advancedFilters,
}));

/** è·å–æ‰€æœ‰åŠ è½½çŠ¶æ€ */
export const useSkillLoading = () => useSkillStore((s) => ({
  isConfigLoading: s.isConfigLoading,
  isListLoading: s.isListLoading,
  isRefreshing: s.isRefreshing,
  isLoadingMore: s.isLoadingMore,
}));
```

### Store ç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **APIè°ƒç”¨** | ä½¿ç”¨å®é™…APIå‡½æ•° (`apiGetSkillConfig`, `apiGetSkillList`) |
| **åˆ†é¡µç­–ç•¥** | `loadList(isLoadMore)` å‚æ•°æ§åˆ¶è¿½åŠ /æ›¿æ¢ |
| **ç­›é€‰è”åŠ¨** | æ‰€æœ‰ç­›é€‰ä¿®æ”¹è‡ªåŠ¨è§¦å‘ `loadList()` |
| **å¿«æ·æ ‡ç­¾** | `toggleQuickTag` åˆå¹¶åˆ° `advancedFilters.tags` |
| **ä½ç½®æœåŠ¡** | `latitude/longitude` ç”¨äºè·ç¦»è®¡ç®— |
| **Selector Hooks** | 5ä¸ªç²’åº¦åŒ–é€‰æ‹©å™¨é˜²æ­¢ä¸å¿…è¦é‡æ¸²æŸ“ |

---

## 7. ç»„ä»¶å®ç°æ¸…å•

> å®é™…å®ç°ç»“æ„ (2025-12-09)

### 7.1 L1 é¡µé¢ç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| GameSkillList | `GameSkillList/index.tsx` | ç»„åˆL2åŒºåŸŸï¼Œç®¡ç†é¡µé¢ç”Ÿå‘½å‘¨æœŸï¼Œåè°ƒModalçŠ¶æ€ |

**å®ç°è¦ç‚¹**:
- ä½¿ç”¨ `useLocalSearchParams` è·å– `skillType` å’Œ `gameId`
- åœ¨ `useEffect` ä¸­åˆå§‹åŒ–: `setGameId` â†’ `loadConfig` + `loadList`
- ä½¿ç”¨ `expo-location` è·å–ç”¨æˆ·ä½ç½®
- ç®¡ç†3ä¸ªModalå¯è§çŠ¶æ€: `showSortSheet`, `showGenderSheet`, `showFilterSheet`
- ç»„åˆ: NavArea + FilterArea + TabArea + QuickTagArea + ContentListArea + Modals

### 7.2 L2 åŒºåŸŸç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | èŒè´£ | å¸ƒå±€ |
|------|------|------|------|
| NavArea | `NavArea.tsx` | å¯¼èˆªæ  (è¿”å›+æ ‡é¢˜) | å›ºå®šé¡¶éƒ¨, h:44px |
| FilterArea | `FilterArea.tsx` | ç­›é€‰æ§åˆ¶æ  (æ’åº+æ€§åˆ«+ç­›é€‰æŒ‰é’®) | å›ºå®šé¡¶éƒ¨, h:44px |
| TabArea | `TabArea.tsx` | æœåŠ¡ç±»å‹Tabåˆ‡æ¢ | å›ºå®šé¡¶éƒ¨, h:40px, scroll-x |
| QuickTagArea | `QuickTagArea.tsx` | å¿«æ·æ ‡ç­¾æ  | å›ºå®šé¡¶éƒ¨, h:40px, scroll-x |
| ContentListArea | `ContentListArea/index.tsx` | é™ªç©å¸ˆåˆ—è¡¨ | flex:1, scroll-y |

**NavArea å®ç°è¦ç‚¹**:
```typescript
interface NavAreaProps {
  title: string;
}
// - ä½¿ç”¨ router.back() å®ç°è¿”å›
// - æ ‡é¢˜å±…ä¸­æ˜¾ç¤º
// - å›ºå®šé«˜åº¦44px
```

**FilterArea å®ç°è¦ç‚¹**:
```typescript
interface FilterAreaProps {
  sortBy: SortType;
  gender: GenderType;
  hasActiveFilters: boolean;
  onSortPress: () => void;
  onGenderPress: () => void;
  onFilterPress: () => void;
}
// - 3ä¸ªæŒ‰é’®æ¨ªå‘æ’åˆ—
// - æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„æ’åº/æ€§åˆ«æ ‡ç­¾
// - ç­›é€‰æŒ‰é’®æ¿€æ´»æ—¶é«˜äº®æ˜¾ç¤º
```

**TabArea å®ç°è¦ç‚¹**:
```typescript
interface TabAreaProps {
  tabs: TabVO[];
  activeTab: string;
  onTabPress: (tab: string) => void;
}
// - ä½¿ç”¨ ScrollView horizontal
// - é€‰ä¸­æ€: ç´«è‰²èƒŒæ™¯ #F5E6FF, ç´«è‰²æ–‡å­— #9B59B6
```

**QuickTagArea å®ç°è¦ç‚¹**:
```typescript
interface QuickTagAreaProps {
  tags: QuickTagVO[];
  activeTag: string | null;
  onTagPress: (tagId: string | null) => void;
}
// - ä½¿ç”¨ ScrollView horizontal
// - æ”¯æŒå•é€‰/å–æ¶ˆé€‰æ‹©
// - é€‰ä¸­æ€ä¸Tabæ ·å¼ä¸€è‡´
```

**ContentListArea å®ç°è¦ç‚¹**:
```typescript
interface ContentListAreaProps {
  data: SkillServiceItemVO[];
  isLoading: boolean;
  isRefreshing: boolean;
  isLoadingMore: boolean;
  hasMore: boolean;
  onRefresh: () => void;
  onLoadMore: () => void;
  onItemPress: (item: SkillServiceItemVO) => void;
}
// - ä½¿ç”¨ FlatList è™šæ‹ŸåŒ–åˆ—è¡¨
// - onRefresh ä¸‹æ‹‰åˆ·æ–°
// - onEndReached ä¸Šæ‹‰åŠ è½½
// - renderItem æ¸²æŸ“ SkillServiceCard
```

### 7.3 L3 åŸºç¡€ç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | æ•°æ®æ¥æº | è¯´æ˜ |
|------|------|---------|------|
| SkillServiceCard | `ContentListArea/SkillServiceCard/` | `SkillServiceItemVO` | memoä¼˜åŒ–, å«styles.ts |

**SkillServiceCard å®ç°è¦ç‚¹**:
```typescript
interface SkillServiceCardProps {
  item: SkillServiceItemVO;
  onPress?: (item: SkillServiceItemVO) => void;
}
// å¸ƒå±€: flex-row
// - å·¦ä¾§: Avatar 120x160, åœ†è§’8px
// - å³ä¾§: flex:1, flex-col
//   - Row1: æ˜µç§° + æ€§åˆ«å¹´é¾„æ ‡ç­¾ + è·ç¦»
//   - Row2: è®¤è¯å¾½ç«  (å®å/å¤§ç¥/VIP)
//   - Row3: æè¿° (2è¡Œçœç•¥)
//   - Row4: æ ‡ç­¾åˆ—è¡¨ (server/rank/peak/tags)
//   - Row5: ä»·æ ¼ + è®¢å•æ•°|è¯„åˆ†
```

### 7.4 Modalç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| SortBottomSheet | `modals/SortBottomSheet.tsx` | æ’åºé€‰æ‹©å¼¹çª— |
| GenderBottomSheet | `modals/GenderBottomSheet.tsx` | æ€§åˆ«ç­›é€‰å¼¹çª— |
| FilterBottomSheet | `modals/FilterBottomSheet.tsx` | é«˜çº§ç­›é€‰é¢æ¿ |

**SortBottomSheet**:
```typescript
interface SortBottomSheetProps {
  visible: boolean;
  currentValue: SortType;
  onSelect: (value: SortType) => void;
  onClose: () => void;
}
// 6ä¸ªæ’åºé€‰é¡¹: smart, newest, recent, popular, price_asc, price_desc
```

**GenderBottomSheet**:
```typescript
interface GenderBottomSheetProps {
  visible: boolean;
  currentValue: GenderType;
  onSelect: (value: GenderType) => void;
  onClose: () => void;
}
// 3ä¸ªæ€§åˆ«é€‰é¡¹: all, male, female
```

**FilterBottomSheet**:
```typescript
interface FilterBottomSheetProps {
  visible: boolean;
  currentFilters: SkillFiltersParams;
  onApply: (filters: SkillFiltersParams) => void;
  onReset: () => void;
  onClose: () => void;
}
// é«˜çº§ç­›é€‰: çŠ¶æ€/å¤§åŒº/æ®µä½/ä»·æ ¼/ä½ç½®/æ ‡ç­¾/æ‰€åœ¨åœ°
```

---

## 8. è·¯ç”±é…ç½®

```typescript
// app/(tabs)/homepage/game-player-list.tsx

import { useLocalSearchParams } from 'expo-router';
import { GameSkillList } from '@/src/features/GameSkill';

export default function GamePlayerListScreen() {
  const { skillType, gameId } = useLocalSearchParams<{
    skillType: string;
    gameId: string;
  }>();

  return (
    <GameSkillList
      skillType={skillType || 'ç‹è€…è£è€€'}
      gameId={gameId || 'honor_of_kings'}
    />
  );
}
```

**è·¯ç”±å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| skillType | string | æ˜¯ | æŠ€èƒ½ç±»å‹ï¼Œå¦‚ 'ç‹è€…è£è€€' |
| gameId | string | æ˜¯ | æ¸¸æˆIDï¼Œå¦‚ 'honor_of_kings' |

**å¯¼èˆªè°ƒç”¨ç¤ºä¾‹**:
```typescript
// ä»é¦–é¡µå¯¼èˆªåˆ°åˆ—è¡¨é¡µ
router.push({
  pathname: '/(tabs)/homepage/game-player-list',
  params: { skillType: 'ç‹è€…è£è€€', gameId: 'honor_of_kings' },
});
```

---

## 9. å®ç°æ­¥éª¤

1. [ ] åˆ›å»ºç›®å½•ç»“æ„ `src/features/GameSkill/`
2. [ ] å®ç° `types/index.ts` - å®Œæ•´ç±»å‹å®šä¹‰
3. [ ] å®ç° `api/skillApi.ts` - APIæ¥å£ + Mockæ•°æ®
4. [ ] å®ç° `stores/useSkillStore.ts` - Zustand Store
5. [ ] å®ç° `SharedComponents/TabButton/` - TabæŒ‰é’®ç»„ä»¶
6. [ ] å®ç° `SharedComponents/FilterDropdown/` - ç­›é€‰ä¸‹æ‹‰ç»„ä»¶
7. [ ] å®ç° `SharedComponents/FilterPanel/` - ç­›é€‰é¢æ¿ç»„ä»¶
8. [ ] å®ç° `SharedComponents/Badge/` - è®¤è¯å¾½ç« ç»„ä»¶
9. [ ] å®ç° `SharedComponents/EmptyState/` - ç©ºçŠ¶æ€ç»„ä»¶
10. [ ] å®ç° `GameSkillList/ContentListArea/SkillServiceCard/` - å¡ç‰‡ç»„ä»¶
11. [ ] å®ç° `GameSkillList/NavArea.tsx` - å¯¼èˆªåŒºåŸŸ
12. [ ] å®ç° `GameSkillList/FilterArea.tsx` - ç­›é€‰åŒºåŸŸ
13. [ ] å®ç° `GameSkillList/TabArea.tsx` - TabåŒºåŸŸ
14. [ ] å®ç° `GameSkillList/ContentListArea/` - åˆ—è¡¨åŒºåŸŸ
15. [ ] å®ç° `GameSkillList/index.tsx` - é¡µé¢ä¸»æ–‡ä»¶
16. [ ] åˆ›å»º `app/(tabs)/homepage/game-player-list.tsx` - è·¯ç”±å…¥å£
17. [ ] ç¼–å†™ `Quick-Understanding.md` - æ¨¡å—è¯´æ˜æ–‡æ¡£
18. [ ] å®ç° `index.ts` - æ¨¡å—å¯¼å‡º

---

## 10. å…¬å…±ç»„ä»¶å¤ç”¨

| ç»„ä»¶ | è·¯å¾„ | ç”¨é€” |
|------|------|------|
| ThemedText | `@/components/ThemedText` | ä¸»é¢˜æ–‡æœ¬ |
| ThemedView | `@/components/ThemedView` | ä¸»é¢˜å®¹å™¨ |
| Colors | `@/constants/theme` | é¢œè‰²å¸¸é‡ |
| locationStore | `@/stores/locationStore` | ä½ç½®æ•°æ® (è·å–ç»çº¬åº¦) |
| client | `@/services/api/client` | HTTPå®¢æˆ·ç«¯ |

---

## 11. æ ·å¼è§„èŒƒ

> æ¥æº: ç»“æ„æ–‡æ¡£ STEP 4 å¸ƒå±€å®šä½

### 11.1 é¢œè‰²å®šä¹‰

```typescript
// é¢œè‰²å®šä¹‰
const COLORS = {
  primary: '#9B59B6',           // ä¸»è‰²è°ƒç´«è‰²
  primaryLight: '#F5E6FF',      // æµ…ç´«è‰²èƒŒæ™¯
  pink: '#FF6B9D',              // ä»·æ ¼ç²‰è‰²
  text: '#333333',              // ä¸»æ–‡å­—
  textSecondary: '#666666',     // æ¬¡è¦æ–‡å­—
  textLight: '#999999',         // è¾…åŠ©æ–‡å­—
  background: '#F5F5F5',        // èƒŒæ™¯è‰²
  white: '#FFFFFF',
  border: '#EEEEEE',
  female: '#FF69B4',            // å¥³æ€§ç²‰è‰²
  male: '#4A90E2',              // ç”·æ€§è“è‰²
};
```

### 11.2 å­—ä½“å¤§å°

```typescript
const FONT_SIZE = {
  title: 17,      // å¯¼èˆªæ ‡é¢˜
  cardName: 16,   // å¡ç‰‡æ˜µç§°
  filter: 14,     // ç­›é€‰æ–‡å­—
  desc: 13,       // æè¿°æ–‡å­—
  tag: 12,        // æ ‡ç­¾æ–‡å­—
  badge: 10,      // å¾½ç« æ–‡å­—
  price: 20,      // ä»·æ ¼æ•°å­—
  priceUnit: 12,  // ä»·æ ¼å•ä½
};
```

### 11.3 é—´è·

```typescript
const SPACING = {
  xs: 4,
  sm: 8,
  md: 12,
  lg: 16,
  xl: 20,
};
```

### 11.4 å¸ƒå±€å¸¸é‡

```typescript
// å›ºå®šé«˜åº¦
const LAYOUT = {
  statusBar: 44,        // çŠ¶æ€æ é«˜åº¦
  navBar: 44,           // å¯¼èˆªæ é«˜åº¦
  filterBar: 44,        // ç­›é€‰æ é«˜åº¦
  tabBar: 40,           // Tabæ é«˜åº¦
  homeIndicator: 34,    // åº•éƒ¨å®‰å…¨åŒº
  cardHeight: 160,      // å¡ç‰‡é«˜åº¦
  avatarWidth: 120,     // å¤´åƒå®½åº¦
  avatarHeight: 160,    // å¤´åƒé«˜åº¦
  dropdownItemHeight: 48, // ä¸‹æ‹‰é€‰é¡¹é«˜åº¦
};
```

### 11.5 Tabæ ·å¼è§„æ ¼

```typescript
// Tabæ ·å¼
const TAB_STYLES = {
  // é€‰ä¸­æ€
  active: {
    backgroundColor: '#F5E6FF',
    color: '#9B59B6',
    borderRadius: 16,
    paddingHorizontal: 16,
    paddingVertical: 8,
  },
  // é»˜è®¤æ€
  inactive: {
    backgroundColor: '#F5F5F5',
    color: '#999999',
    borderRadius: 16,
    paddingHorizontal: 16,
    paddingVertical: 8,
  },
};
```

### 11.6 FilterPanelæ ·å¼è§„æ ¼

```typescript
// FilterPanelæ ·å¼
const FILTER_PANEL_STYLES = {
  // åˆ†ç±»æ ‡é¢˜
  categoryTitle: {
    fontSize: 14,
    color: '#333333',
    marginBottom: 12,
  },
  // é€‰é¡¹å®¹å™¨
  optionsContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 12,
  },
  // é€‰é¡¹Tag - é€‰ä¸­æ€
  tagActive: {
    borderWidth: 1,
    borderColor: '#9B59B6',
    backgroundColor: '#F5E6FF',
    color: '#9B59B6',
    borderRadius: 16,
    paddingHorizontal: 16,
    paddingVertical: 8,
  },
  // é€‰é¡¹Tag - é»˜è®¤æ€
  tagInactive: {
    borderWidth: 1,
    borderColor: '#EEEEEE',
    backgroundColor: '#F5F5F5',
    color: '#666666',
    borderRadius: 16,
    paddingHorizontal: 16,
    paddingVertical: 8,
  },
  // ActionBar
  actionBar: {
    height: 80,
    paddingHorizontal: 16,
    paddingVertical: 16,
    flexDirection: 'row',
    gap: 12,
  },
  // é‡ç½®æŒ‰é’®
  resetButton: {
    flex: 1,
    borderWidth: 1,
    borderColor: '#EEEEEE',
    backgroundColor: '#FFFFFF',
    color: '#666666',
    borderRadius: 8,
  },
  // å®ŒæˆæŒ‰é’®
  confirmButton: {
    flex: 2,
    backgroundColor: 'linear-gradient(90deg, #9B59B6, #B47CC4)',
    color: '#FFFFFF',
    borderRadius: 8,
  },
};
```

### 11.7 Dropdownæ ·å¼è§„æ ¼

```typescript
// Dropdownæ ·å¼
const DROPDOWN_STYLES = {
  // é€‰é¡¹è¡Œ
  optionItem: {
    height: 48,
    paddingHorizontal: 16,
    justifyContent: 'space-between',
    alignItems: 'center',
    flexDirection: 'row',
  },
  // é€‰ä¸­æ€æ–‡å­—
  selectedText: {
    color: '#9B59B6',
  },
  // é»˜è®¤æ€æ–‡å­—
  normalText: {
    color: '#333333',
  },
  // é€‰ä¸­å›¾æ ‡
  checkIcon: {
    color: '#9B59B6',
  },
  // åˆ†éš”çº¿
  divider: {
    height: 1,
    backgroundColor: '#EEEEEE',
  },
};
```

---

## 12. è´¨é‡æ£€æŸ¥æ¸…å•

### 12.1 ç±»å‹æ£€æŸ¥
- [ ] ç±»å‹å®šä¹‰ä¸ç»“æ„æ–‡æ¡£ STEP 1 æ•°æ®æ¨¡å‹ä¸€è‡´
- [ ] æ‰€æœ‰ç»„ä»¶Propséƒ½æœ‰ç±»å‹å®šä¹‰
- [ ] APIå“åº”ç±»å‹æ­£ç¡®å®šä¹‰

### 12.2 APIå¯¹æ¥
- [ ] APIæ¥å£ä¸ç»“æ„æ–‡æ¡£ STEP 6 æ¥å£å®šä¹‰ä¸€è‡´
- [ ] APIåŒ…å«Mockæ•°æ®ï¼Œå¯ç‹¬ç«‹è¿è¡Œ
- [ ] æ¯ä¸ªAPIéƒ½æœ‰JSDocæ³¨é‡Šè¯´æ˜å¯¹åº”åç«¯è·¯å¾„

### 12.3 Storeè®¾è®¡
- [ ] StoreåŒ…å«æ‰€æœ‰å¿…è¦çš„stateå’Œactions
- [ ] æä¾›äº†selectorsä¾¿äºç»„ä»¶è®¢é˜…
- [ ] ä½¿ç”¨devtoolsä¾¿äºè°ƒè¯•

### 12.4 ç»„ä»¶å®ç°
- [ ] ç»„ä»¶å‘½åç¬¦åˆè§„èŒƒ (PascalCase + Area/Cardç­‰åç¼€)
- [ ] L1/L2/L3å±‚çº§æ­£ç¡®æ‹†åˆ†
- [ ] åˆ—è¡¨ä½¿ç”¨FlatListå®ç°é«˜æ€§èƒ½æ»šåŠ¨

### 12.5 äº¤äº’å®Œæ•´æ€§
- [ ] ä¸‹æ‹‰åˆ·æ–°æ­£å¸¸å·¥ä½œ
- [ ] ä¸Šæ‹‰åŠ è½½æ›´å¤šæ­£å¸¸å·¥ä½œ
- [ ] ç­›é€‰æ¡ä»¶å˜åŒ–è§¦å‘åˆ—è¡¨åˆ·æ–°
- [ ] Tabåˆ‡æ¢è§¦å‘åˆ—è¡¨åˆ·æ–°
- [ ] éª¨æ¶å±/ç©ºçŠ¶æ€/é”™è¯¯çŠ¶æ€æ­£ç¡®æ˜¾ç¤º
- [ ] ç‚¹å‡»å¡ç‰‡æ­£ç¡®è·³è½¬è¯¦æƒ…é¡µ (æºå¸¦ skillId)

### 12.6 æ–‡æ¡£å®Œæ•´æ€§
- [x] å·²ç”Ÿæˆ `Quick-Understanding.md`
- [x] è·¯ç”±é…ç½®æ­£ç¡®

### 12.7 æ•°æ®ä¸€è‡´æ€§ (ä¸è¯¦æƒ…é¡µå¯¹é½)
- [ ] skillId â†’ companionId æ˜ å°„æ­£ç¡®
- [ ] åˆ—è¡¨å¡ç‰‡æ•°æ®ä¸è¯¦æƒ…é¡µæ•°æ®ç»“æ„ä¸€è‡´
- [ ] è®¤è¯æ ‡ç­¾ â†’ å¾½ç« è½¬æ¢æ­£ç¡®

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.4*
*æœ€åæ›´æ–°: 2025-12-09*
*ç¼–å†™äºº: Claude Code*
*æ›´æ–°è®°å½•:*
*- v1.4: å¯¹é½å®é™…ä»£ç å®ç° - APIç«¯ç‚¹æ›´æ–°ä¸º/xypai-app-bff/api/skill/*, åˆ†ç¦»å¼APIæ–‡ä»¶ç»“æ„, Storeé‡å‘½åä¸ºuseSkillStore, ç±»å‹ä½¿ç”¨VOåç¼€å‘½å, æ·»åŠ QuickTagAreaç»„ä»¶, æ·»åŠ modals/ç›®å½•ç»“æ„*
*- v1.3: å¯¹é½è¯¦æƒ…é¡µç»“æ„æ–‡æ¡£ - æ·»åŠ é¡µé¢å¯¼èˆªå…³ç³»å›¾, æ·»åŠ æ•°æ®æµæ˜ å°„è¡¨, å…³è”çº¿ä¸Šæ¸¸æˆè¯¦æƒ…é¡µå’Œçº¿ä¸‹æ´»åŠ¨è¯¦æƒ…é¡µç»“æ„æ–‡æ¡£*
*- v1.2: å¯¹æ¥åç«¯é¡¹ç›® - APIè·¯å¾„æ”¹ä¸º/api/service/*, æ·»åŠ åç«¯æ¶æ„å›¾, å¯¹é½skill_rank_configæ®µä½é…ç½®, Mockæ•°æ®æ·»åŠ æ•°æ®åº“å­—æ®µæ³¨é‡Š*
*- v1.1: å¯¹é½ç°æœ‰é¡¹ç›®ç»“æ„ (src/features/GameSkill/)ï¼Œè¡¥å……Badge/EmptyStateç»„ä»¶ï¼Œå®Œå–„FilterPanelæ ·å¼è§„æ ¼*
*- v1.0: åˆå§‹ç‰ˆæœ¬*
