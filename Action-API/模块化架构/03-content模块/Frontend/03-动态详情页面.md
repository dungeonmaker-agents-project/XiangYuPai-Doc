# 动态详情页面

## 概述

动态详情页面是用户查看完整动态内容、浏览评论、进行互动的核心页面。用户可以在此页面查看动态的完整信息、发表评论、回复评论、点赞收藏、关注作者等。

**主要功能:**
- 查看完整动态内容(文字、图片、视频)
- 评论列表展示(支持二级回复)
- 发布评论和回复
- 互动功能(点赞、收藏、分享)
- 用户关注/取关
- 内容管理(删除动态/评论、举报)

**前置条件:**
- 无需登录即可查看详情
- 互动操作(点赞/收藏/评论)需要登录
- 编辑/删除操作需要是作者本人

---

## 页面结构

### 顶部导航栏

**布局:**
```
┌─────────────────────────────────────┐
│ ←                            •••    │
└─────────────────────────────────────┘
```

**组件:**
- 返回按钮(左侧)
- 更多按钮(右侧, •••)

**样式:**
- 高度: 56px
- 背景: 透明或半透明(滚动时变白色)
- 返回按钮: ← 箭头
- 更多按钮: ••• 三个点

### 内容区域

**媒体区域(图片/视频):**
```
┌─────────────────────────────────────┐
│                                     │
│         [大图/视频播放器]            │
│                                     │
└─────────────────────────────────────┘
```

**用户信息区:**
```
┌─────────────────────────────────────┐
│ [头像] 用户昵称 [关注]               │
│        5分钟前                       │
└─────────────────────────────────────┘
```

**内容文本区:**
```
┌─────────────────────────────────────┐
│ 今天逛街的时候                       │
│ 发现超好玩的店,一定要分享...         │
│                                     │
│ #探店日记# #美食分享#                │
│                                     │
│ 📍 XX商场 · 2.3km                   │
└─────────────────────────────────────┘
```

**互动数据栏:**
```
┌─────────────────────────────────────┐
│ 👍 28   💬 评论 16                  │
└─────────────────────────────────────┘
```

### 评论区域

**评论列表:**
```
┌─────────────────────────────────────┐
│ 评论 16          [按时间 ▼]          │
├─────────────────────────────────────┤
│ [头像] 用户A                         │
│        人肉窝这个不真的很宝藏呢        │
│        ♡ 5   回复   5分钟前          │
│                                     │
│        [头像] 用户B 回复 用户A       │
│               确实很不错!             │
│               ♡ 2   5分钟前          │
│                                     │
│        展开更多2条回复 ▼              │
├─────────────────────────────────────┤
│ [更多评论...]                        │
└─────────────────────────────────────┘
```

**评论样式:**
- 一级评论:
  - 内边距: 16px
  - 头像: 36x36px
  - 昵称: 14pt,加粗
  - 内容: 14pt,常规
  - 背景: 白色

- 二级回复:
  - 内边距: 左侧52px(缩进)
  - 头像: 32x32px
  - 背景: 浅灰色 (#FAFAFA)

### 底部操作栏

```
┌─────────────────────────────────────┐
│ [说点什么...____________] ♡ 28 ⭐ 💬 │
└─────────────────────────────────────┘
```

**组件:**
- 评论输入框(占据剩余空间)
- 点赞按钮(♡ 或 ♥)
- 收藏按钮(⭐)
- 评论按钮(💬)

**样式:**
- 高度: 56px
- 背景: 白色
- 固定在底部

---

## 接口列表

### 1. 获取动态详情

**接口:** `GET /api/v1/content/detail/{feedId}`

**路径参数:**
- `feedId`: 动态ID

**触发时机:**
- 页面初始化时

**后端服务:** ContentService (xypai-content)

**响应数据结构:**
```typescript
{
  code: 200,
  message: "success",
  data: {
    id: string;
    userId: string;
    type: number;
    title?: string;
    content: string;
    coverImage?: string;

    userInfo: {
      id: string;
      nickname: string;
      avatar: string;
      gender?: 'male' | 'female';
      age?: number;
      isFollowed: boolean;
      isRealVerified?: boolean;
      isGodVerified?: boolean;
      isVip?: boolean;
    };

    mediaList: Array<{
      id: string;
      type: 'image' | 'video';
      url: string;
      thumbnailUrl?: string;
      width: number;
      height: number;
      duration?: number;
    }>;

    topicList: Array<{
      name: string;
      description?: string;
      participantCount: number;
      postCount: number;
    }>;

    locationName?: string;
    locationAddress?: string;
    longitude?: number;
    latitude?: number;
    distance?: number;

    likeCount: number;
    commentCount: number;
    shareCount: number;
    collectCount: number;
    viewCount: number;

    isLiked: boolean;
    isCollected: boolean;

    canEdit: boolean;
    canDelete: boolean;

    createdAt: number;
    updatedAt: number;
  }
}
```

---

### 2. 获取评论列表

**接口:** `GET /api/v1/content/comments/{feedId}`

**路径参数:**
- `feedId`: 动态ID

**查询参数:**
```typescript
{
  page: number;        // 页码,从1开始
  pageSize: number;    // 每页数量,默认20
  sortType?: 'time' | 'hot' | 'like';  // 排序方式,默认time
}
```

**触发时机:**
- 详情页加载完成后
- 下拉加载更多时
- 发布评论成功后刷新

**后端服务:** ContentService (xypai-content)

**响应数据结构:**
```typescript
{
  code: 200,
  message: "success",
  data: {
    list: Comment[];
    total: number;
    hasMore: boolean;
  }
}

interface Comment {
  id: string;
  feedId: string;
  userId: string;

  userInfo: {
    id: string;
    nickname: string;
    avatar: string;
    isRealVerified?: boolean;
    isGodVerified?: boolean;
  };

  content: string;

  parentId?: string;       // NULL = 一级评论
  replyToUserId?: string;
  replyToUserNickname?: string;

  likeCount: number;
  replyCount: number;
  isTop: boolean;
  isLiked: boolean;

  replies: Comment[];      // 二级回复,最多3条
  totalReplies?: number;
  hasMoreReplies?: boolean;

  canDelete: boolean;

  createdAt: number;
}
```

---

### 3. 发布评论

**接口:** `POST /api/v1/content/comment`

**请求参数:**
```typescript
{
  feedId: string;        // 动态ID
  content: string;       // 评论内容,1-500字符
  parentId?: string;     // 回复的一级评论ID(可选)
  replyToUserId?: string; // 回复的用户ID(可选)
}
```

**触发时机:**
- 用户点击发送按钮

**后端服务:** ContentService (xypai-content)

---

### 4. 删除评论

**接口:** `DELETE /api/v1/content/comment/{commentId}`

**路径参数:**
- `commentId`: 评论ID

**触发时机:**
- 用户确认删除评论后

**后端服务:** ContentService (xypai-content)

---

### 5. 点赞动态

**接口:** `POST /api/v1/interaction/like`

**请求参数:**
```typescript
{
  targetType: 'feed';      // 固定值: feed
  targetId: string;        // 动态ID
  action: 'like' | 'unlike'
}
```

**触发时机:**
- 用户点击底部点赞按钮

**后端服务:** ContentService (xypai-content)

---

### 6. 点赞评论

**接口:** `POST /api/v1/interaction/like`

**请求参数:**
```typescript
{
  targetType: 'comment';   // 固定值: comment
  targetId: string;        // 评论ID
  action: 'like' | 'unlike'
}
```

**触发时机:**
- 用户点击评论的点赞图标

**后端服务:** ContentService (xypai-content)

---

### 7. 收藏动态

**接口:** `POST /api/v1/interaction/collect`

**请求参数:**
```typescript
{
  targetType: 'feed';            // 固定值: feed
  targetId: string;              // 动态ID
  action: 'collect' | 'uncollect'
}
```

**触发时机:**
- 用户点击底部收藏按钮

**后端服务:** ContentService (xypai-content)

---

### 8. 分享动态

**接口:** `POST /api/v1/interaction/share`

**请求参数:**
```typescript
{
  targetType: 'feed';      // 固定值: feed
  targetId: string;        // 动态ID
  shareChannel: 'wechat' | 'moments' | 'qq' | 'qzone' | 'weibo' | 'copy_link'
}
```

**触发时机:**
- 用户选择分享渠道后

**后端服务:** ContentService (xypai-content)

---

### 9. 删除动态

**接口:** `DELETE /api/v1/content/{feedId}`

**路径参数:**
- `feedId`: 动态ID

**触发时机:**
- 用户确认删除动态后

**后端服务:** ContentService (xypai-content)

---

### 10. 举报动态

**接口:** `POST /api/v1/content/report`

**请求参数:**
```typescript
{
  targetType: 'feed';      // 固定值: feed
  targetId: string;        // 动态ID
  reasonType: string;      // 举报类型
  description?: string;    // 举报描述,0-200字符
  evidenceImages?: string[]; // 举报图片,最多3张
}
```

**触发时机:**
- 用户提交举报信息后

**后端服务:** ContentService (xypai-content)

---

### 11. 关注/取关用户

**接口:** `POST /api/v1/user/follow`

**请求参数:**
```typescript
{
  targetUserId: string;         // 目标用户ID
  action: 'follow' | 'unfollow'
}
```

**触发时机:**
- 用户点击关注/已关注按钮

**后端服务:** UserService (xypai-user) - RPC调用

---

## 数据流

### 页面加载流程

```
1. 用户从发现主页点击动态卡片
   ↓
2. 进入动态详情页
   - 显示顶部导航栏
   - 显示骨架屏(媒体区+内容区+评论区)
   ↓
3. 调用详情接口
   GET /api/v1/content/detail/{feedId}
   ↓
4. ContentService处理
   - 从数据库查询动态详情
   - 调用UserService.getUserInfo()获取用户信息(RPC)
   - 更新浏览数(+1)
   - 组装Feed数据
   ↓
5. 返回详情数据
   {
     code: 200,
     data: {
       id, userId, type, title, content,
       userInfo, mediaList, topicList,
       locationName, likeCount, commentCount,
       isLiked, isCollected, canEdit, canDelete,
       createdAt, updatedAt
     }
   }
   ↓
6. 前端渲染完整内容
   - 渲染媒体列表(图片/视频)
   - 显示话题标签
   - 显示位置信息
   - 显示互动数据
   ↓
7. 并行加载评论列表
   GET /api/v1/content/comments/{feedId}?page=1&pageSize=20
   ↓
8. ContentService处理
   - 查询评论列表(一级评论)
   - 查询每个一级评论的前3条回复
   - 调用UserService.getUserInfo()获取评论用户信息(RPC)
   ↓
9. 返回评论数据
   {
     code: 200,
     data: {
       list: [
         {
           id, userId, content, userInfo,
           likeCount, replyCount, isLiked,
           replies: [
             { id, content, userInfo, ... }
           ],
           totalReplies: 5,
           hasMoreReplies: true
         }
       ],
       total: 16,
       hasMore: true
     }
   }
   ↓
10. 前端渲染评论列表
   - 显示一级评论
   - 显示前3条二级回复
   - 显示"展开更多X条回复"按钮
```

### 发布评论流程

```
1. 用户点击评论输入框
   ↓
2. 检查登录状态
   - 未登录: 弹出登录提示,终止流程
   - 已登录: 继续
   ↓
3. 输入框获得焦点
   - 弹出键盘
   - 输入框固定在键盘上方
   - 显示发送按钮
   ↓
4. 用户输入评论内容
   - 实时显示字符计数(0/500)
   - 达到500字符禁止继续输入
   - 输入框自动扩展(最多4行)
   ↓
5. 用户点击发送按钮
   - 验证内容不为空
   - 发送按钮显示加载状态
   ↓
6. 调用发布评论接口
   POST /api/v1/content/comment
   {
     feedId: "xxx",
     content: "评论内容",
     parentId: null,        // 一级评论为null
     replyToUserId: null
   }
   ↓
7. ContentService处理
   - 验证用户登录状态
   - 验证内容格式(1-500字符)
   - 创建评论记录
   - 更新动态评论数(+1)
   ↓
8. 返回新评论数据
   {
     code: 200,
     data: {
       comment: {
         id, feedId, userId, content,
         userInfo, likeCount, replyCount,
         isLiked, canDelete, createdAt
       }
     }
   }
   ↓
9. 前端处理响应
   成功:
   - 清空输入框
   - 收起键盘
   - 新评论插入列表顶部
   - 评论总数+1
   - 显示"评论成功"Toast

   失败:
   - 保留输入内容
   - 显示错误提示
   - 允许重新发送
```

### 回复评论流程

```
1. 用户点击某条评论的"回复"按钮
   ↓
2. 输入框显示"回复 @用户昵称:"前缀
   - 自动聚焦输入框
   - 设置replyTo状态
   ↓
3. 用户输入回复内容
   ↓
4. 点击发送按钮
   ↓
5. 调用发布评论接口
   POST /api/v1/content/comment
   {
     feedId: "xxx",
     content: "回复内容",
     parentId: "comment_id",      // 一级评论ID
     replyToUserId: "user_id"     // 被回复用户ID
   }
   ↓
6. ContentService处理
   - 创建二级回复记录
   - 更新一级评论的回复数(+1)
   - 更新动态评论数(+1)
   ↓
7. 前端处理响应
   - 清空输入框
   - 收起键盘
   - 新回复显示在对应一级评论下方
   - 如果超过3条,需点击"展开"查看
```

### 点赞评论流程

```
1. 用户点击评论的点赞图标
   ↓
2. 检查登录状态
   - 未登录: 弹出登录提示,终止流程
   - 已登录: 继续
   ↓
3. 乐观更新UI
   - 立即切换图标: 空心 ↔ 实心
   - 立即更新点赞数: +1 或 -1
   ↓
4. 调用点赞接口
   POST /api/v1/interaction/like
   {
     targetType: 'comment',
     targetId: 'comment_id',
     action: 'like' 或 'unlike'
   }
   ↓
5. ContentService处理
   - 更新评论点赞记录
   - 更新评论点赞数
   ↓
6. 返回结果
   {
     code: 200,
     data: {
       success: true,
       likeCount: 6,
       isLiked: true
     }
   }
   ↓
7. 前端处理响应
   - 成功: 保持乐观更新的UI状态
   - 失败: 回滚UI状态,显示错误Toast
```

### 删除评论流程

```
1. 用户长按自己的评论
   ↓
2. 检查canDelete权限
   - canDelete=false: 不显示删除选项
   - canDelete=true: 显示删除选项
   ↓
3. 弹出操作菜单
   - "删除"(红色)
   - "取消"
   ↓
4. 用户点击"删除"
   ↓
5. 弹出确认对话框
   - 标题: "确认删除评论?"
   - 内容: "删除后将无法恢复"
   - 按钮: "取消" | "删除"(红色)
   ↓
6. 用户点击"删除"确认
   ↓
7. 调用删除接口
   DELETE /api/v1/content/comment/{commentId}
   ↓
8. ContentService处理
   - 验证用户权限(只能删除自己的评论)
   - 删除评论记录
   - 如果是一级评论,删除所有二级回复
   - 更新动态评论数(-1或-N)
   ↓
9. 返回结果
   {
     code: 200,
     message: "删除成功"
   }
   ↓
10. 前端处理响应
   成功:
   - 从列表中移除该评论
   - 评论总数-1
   - 如果是一级评论,同时移除其所有二级回复
   - 显示"删除成功"Toast

   失败:
   - 显示错误Toast
```

---

## 状态管理

### 页面状态定义

```typescript
interface DetailPageState {
  // 动态数据
  feed: Feed | null;
  loading: boolean;
  error: Error | null;

  // 评论数据
  comments: Comment[];
  commentLoading: boolean;
  commentPage: number;
  commentHasMore: boolean;
  commentSortType: 'time' | 'hot' | 'like';

  // 输入状态
  commentText: string;
  replyTo: {
    commentId: string;
    userId: string;
    nickname: string;
  } | null;

  // UI状态
  showSharePanel: boolean;
  showReportPage: boolean;
}
```

### 初始状态

```typescript
const initialState: DetailPageState = {
  feed: null,
  loading: true,
  error: null,

  comments: [],
  commentLoading: false,
  commentPage: 1,
  commentHasMore: true,
  commentSortType: 'time',

  commentText: '',
  replyTo: null,

  showSharePanel: false,
  showReportPage: false,
};
```

### 状态更新

**加载详情:**
```typescript
const loadFeedDetail = async (feedId: string) => {
  setState({ ...state, loading: true });

  try {
    const response = await getFeedDetail(feedId);

    if (response.code === 200) {
      setState({
        ...state,
        loading: false,
        feed: response.data
      });

      // 并行加载评论
      loadComments(feedId);
    } else {
      setState({
        ...state,
        loading: false,
        error: new Error(response.message)
      });
    }
  } catch (error) {
    setState({
      ...state,
      loading: false,
      error: error
    });
  }
};
```

**发布评论:**
```typescript
const publishComment = async () => {
  // 验证内容
  if (!state.commentText.trim()) {
    showToast('请输入评论内容');
    return;
  }

  try {
    const response = await createComment({
      feedId: state.feed.id,
      content: state.commentText,
      parentId: state.replyTo?.commentId,
      replyToUserId: state.replyTo?.userId
    });

    if (response.code === 200) {
      // 清空输入
      setState({
        ...state,
        commentText: '',
        replyTo: null
      });

      // 新评论插入列表顶部
      const newComment = response.data.comment;
      setState({
        ...state,
        comments: [newComment, ...state.comments]
      });

      // 更新评论总数
      if (state.feed) {
        setState({
          ...state,
          feed: {
            ...state.feed,
            commentCount: state.feed.commentCount + 1
          }
        });
      }

      showToast('评论成功');
    } else {
      showToast(response.message);
    }
  } catch (error) {
    showToast('评论失败,请重试');
  }
};
```

---

## 前端验证

### 评论内容验证

```typescript
const validateComment = (content: string) => {
  if (!content || content.trim().length === 0) {
    return { valid: false, error: '评论内容不能为空' };
  }

  if (content.length > 500) {
    return { valid: false, error: '评论内容不能超过500字符' };
  }

  return { valid: true };
};
```

### 权限验证

```typescript
// 检查是否可以删除动态
const canDeleteFeed = (feed: Feed, currentUserId: string) => {
  return feed.userId === currentUserId && feed.canDelete;
};

// 检查是否可以删除评论
const canDeleteComment = (comment: Comment, currentUserId: string) => {
  return comment.userId === currentUserId && comment.canDelete;
};
```

---

## 交互行为

### 1. 页面加载

**进入详情页:**
1. 显示顶部导航栏
2. 显示骨架屏
3. 调用详情接口
4. 成功后:
   - 渲染完整内容
   - 加载评论列表
   - 更新浏览数
5. 失败后:
   - 显示错误页面
   - 提供返回按钮

---

### 2. 图片查看

**点击图片:**
1. 打开全屏图片查看器
2. 显示当前图片
3. 支持左右滑动切换
4. 支持双击放大/缩小
5. 支持双指缩放
6. 显示图片序号(1/3)
7. 点击空白区域关闭

---

### 3. 视频播放

**点击视频:**
1. 显示播放控件
2. 自动播放
3. 支持全屏切换
4. 双击全屏播放

---

### 4. 评论输入

**点击输入框:**
1. 检查登录状态
2. 未登录: 弹出登录提示
3. 已登录:
   - 输入框获得焦点
   - 弹出键盘
   - 输入框固定在键盘上方
   - 显示发送按钮

**输入评论:**
- 实时显示字符计数
- 达到500字符禁止继续输入
- 输入框自动扩展(最多4行)

**发送评论:**
1. 验证内容不为空
2. 发送按钮显示加载状态
3. 调用发布接口
4. 成功后:
   - 清空输入框
   - 收起键盘
   - 新评论插入列表顶部
   - 显示"评论成功"Toast
5. 失败后:
   - 保留输入内容
   - 显示错误提示

---

### 5. 回复评论

**点击"回复"按钮:**
1. 输入框显示"回复 @用户昵称:"
2. 自动聚焦输入框
3. 设置replyTo状态
4. 其他流程同发布评论

---

### 6. 评论点赞

**点击评论点赞:**
1. 检查登录状态
2. 乐观更新UI
3. 调用接口
4. 失败时回滚

---

### 7. 评论删除

**长按自己的评论:**
1. 检查canDelete权限
2. 弹出操作菜单
3. 点击删除:
   - 弹出确认对话框
   - "确认删除评论?"
4. 确认后:
   - 调用删除接口
   - 成功后从列表移除
   - 评论数-1

---

### 8. 分享面板

**点击分享按钮:**
1. 从底部滑入分享面板(300ms)
2. 显示分享选项:
   - 微信好友
   - 朋友圈
   - QQ好友
   - 新浪微博
   - 复制链接
3. 点击某个选项执行分享
4. 点击空白区域关闭

---

### 9. 举报流程

**点击举报:**
1. 跳转到举报页面(全屏)
2. 选择举报类型(必选)
3. 填写描述(可选,0-200字)
4. 上传图片(可选,最多3张)
5. 点击提交:
   - 验证类型已选择
   - 调用举报接口
   - 成功后显示确认对话框
   - 点击确定返回详情页

---

### 10. 更多操作菜单

**点击更多按钮(•••):**
1. 弹出操作菜单:
   - 作者本人:
     - "删除"(红色)
     - "举报"(灰色)
     - "取消"
   - 其他用户:
     - "举报"(灰色)
     - "取消"
2. 点击对应选项执行操作

---

## 测试要点

### 功能测试
- [ ] 详情页加载正常
- [ ] 媒体展示正常(图片/视频)
- [ ] 评论列表加载正常
- [ ] 发布评论功能正常
- [ ] 回复评论功能正常
- [ ] 点赞评论功能正常
- [ ] 删除评论功能正常
- [ ] 点赞动态功能正常
- [ ] 收藏动态功能正常
- [ ] 分享功能正常
- [ ] 举报功能正常
- [ ] 关注用户功能正常
- [ ] 删除动态功能正常

### 边界测试
- [ ] 动态不存在处理
- [ ] 评论为空处理
- [ ] 评论内容超长验证
- [ ] 举报重复提交处理
- [ ] 网络异常处理
- [ ] 权限验证正确
- [ ] 快速重复点赞/收藏

### 性能测试
- [ ] 大图加载性能
- [ ] 视频播放流畅度
- [ ] 评论列表滚动流畅
- [ ] 二级回复展开性能
- [ ] 内存占用控制

---

## 使用的后端服务

### ContentService (xypai-content, port 8003)

**调用的接口:**
1. `GET /api/v1/content/detail/{feedId}` - 获取动态详情
2. `GET /api/v1/content/comments/{feedId}` - 获取评论列表
3. `POST /api/v1/content/comment` - 发布评论
4. `DELETE /api/v1/content/comment/{commentId}` - 删除评论
5. `POST /api/v1/interaction/like` - 点赞动态/评论
6. `POST /api/v1/interaction/collect` - 收藏动态
7. `POST /api/v1/interaction/share` - 分享动态
8. `DELETE /api/v1/content/{feedId}` - 删除动态
9. `POST /api/v1/content/report` - 举报动态

**RPC调用:**
- ContentService内部调用UserService.getUserInfo()获取用户信息

---

### UserService (xypai-user, port 8002)

**调用的接口:**
1. `POST /api/v1/user/follow` - 关注/取关用户

**RPC提供:**
- UserService.getUserInfo(userId) - 供ContentService调用

---

## 相关页面

### 前置页面
1. **发现主页页面** (`01-发现主页页面.md`)
   - 跳转方式: 点击动态卡片
   - 传递参数: feedId

### 后续页面
1. **发现主页页面** (`01-发现主页页面.md`)
   - 跳转方式: 删除动态成功后返回
   - 传递参数: 无

2. **用户主页页面** (在02-user模块)
   - 跳转方式: 点击用户头像/昵称
   - 传递参数: userId

3. **话题详情页面** (待创建)
   - 跳转方式: 点击话题标签
   - 传递参数: topicName

4. **举报页面** (子页面)
   - 跳转方式: 点击更多→举报
   - 传递参数: targetType=feed, targetId=feedId

5. **登录页面** (在01-auth模块)
   - 跳转方式: 未登录时点击需登录操作
   - 传递参数: 无

---

## TypeScript类型定义

```typescript
// Feed详情数据
interface Feed {
  id: string;
  userId: string;
  type: number;
  title?: string;
  content: string;
  coverImage?: string;

  userInfo: {
    id: string;
    nickname: string;
    avatar: string;
    gender?: 'male' | 'female';
    age?: number;
    isFollowed: boolean;
    isRealVerified?: boolean;
    isGodVerified?: boolean;
    isVip?: boolean;
  };

  mediaList: Array<{
    id: string;
    type: 'image' | 'video';
    url: string;
    thumbnailUrl?: string;
    width: number;
    height: number;
    duration?: number;
  }>;

  topicList: Array<{
    name: string;
    description?: string;
    participantCount: number;
    postCount: number;
  }>;

  locationName?: string;
  locationAddress?: string;
  longitude?: number;
  latitude?: number;
  distance?: number;

  likeCount: number;
  commentCount: number;
  shareCount: number;
  collectCount: number;
  viewCount: number;

  isLiked: boolean;
  isCollected: boolean;

  canEdit: boolean;
  canDelete: boolean;

  createdAt: number;
  updatedAt: number;
}

// Comment数据
interface Comment {
  id: string;
  feedId: string;
  userId: string;

  userInfo: {
    id: string;
    nickname: string;
    avatar: string;
    isRealVerified?: boolean;
    isGodVerified?: boolean;
  };

  content: string;

  parentId?: string;
  replyToUserId?: string;
  replyToUserNickname?: string;

  likeCount: number;
  replyCount: number;
  isTop: boolean;
  isLiked: boolean;

  replies: Comment[];
  totalReplies?: number;
  hasMoreReplies?: boolean;

  canDelete: boolean;

  createdAt: number;
}

// 发布评论请求
interface CreateCommentRequest {
  feedId: string;
  content: string;
  parentId?: string;
  replyToUserId?: string;
}

// 发布评论响应
interface CreateCommentResponse {
  code: number;
  message: string;
  data: {
    comment: Comment;
  } | null;
}
```
