# 用户模块完整测试用例文档
User Module Complete Test Cases Document

**版本 Version**: 1.0
**创建日期 Created**: 2025-11-14
**负责人 Owner**: XiangYuPai Team

---

## 目录 Table of Contents

1. [测试概述](#一测试概述)
2. [测试环境](#二测试环境)
3. [页面测试用例](#三页面测试用例)
4. [API接口测试](#四api接口测试)
5. [完整流程测试](#五完整流程测试)
6. [性能测试](#六性能测试)
7. [安全测试](#七安全测试)
8. [兼容性测试](#八兼容性测试)

---

## 一、测试概述

### 1.1 测试范围

本测试文档覆盖用户模块的所有功能，包括：
- ✅ 7个前端页面的完整测试
- ✅ 50+个API接口的功能测试
- ✅ 10+个完整业务流程的端到端测试
- ✅ 性能、安全、兼容性测试

### 1.2 测试目标

1. **功能完整性**: 确保所有功能按需求正常工作
2. **数据准确性**: 验证数据的正确性和一致性
3. **用户体验**: 确保界面友好、操作流畅
4. **系统稳定性**: 验证系统在各种场景下的稳定性
5. **性能达标**: 确保响应时间满足要求

### 1.3 测试方法

- **功能测试**: 黑盒测试、白盒测试
- **接口测试**: Postman/JMeter
- **自动化测试**: Selenium/Cypress
- **性能测试**: JMeter压测
- **安全测试**: 渗透测试

---

## 二、测试环境

### 2.1 环境配置

| 环境 | 后端地址 | 数据库 | 说明 |
|------|---------|--------|------|
| 开发环境 | http://localhost:9401 | xypai_user_dev | 开发调试 |
| 测试环境 | http://test.xypai.com:9401 | xypai_user_test | 功能测试 |
| 预发布环境 | http://pre.xypai.com:9401 | xypai_user_pre | 上线前验证 |
| 生产环境 | https://api.xypai.com | xypai_user_prod | 正式环境 |

### 2.2 测试账号

| 账号类型 | 手机号 | 说明 |
|---------|--------|------|
| 普通用户 | 13800000001 | 完整资料 |
| 新用户 | 13800000002 | 未完善资料 |
| 技能提供者 | 13800000003 | 已发布技能 |
| 高级用户 | 13800000004 | 多技能、多关注 |

### 2.3 测试数据准备

```sql
-- 创建测试用户
INSERT INTO users (phone, nickname, avatar) VALUES
('13800000001', '测试用户A', 'https://cdn.example.com/avatar1.jpg'),
('13800000002', '测试用户B', 'https://cdn.example.com/avatar2.jpg'),
('13800000003', '技能达人', 'https://cdn.example.com/avatar3.jpg');

-- 创建测试技能
INSERT INTO skills (user_id, skill_name, skill_type, price, is_online) VALUES
(3, '王者荣耀上分', 'online', 99.00, true),
(3, '家政清洁服务', 'offline', 80.00, true);
```

---

## 三、页面测试用例

### 3.1 个人主页页面

#### 测试场景 1: 页面加载
**用例ID**: TC-PROFILE-001
**优先级**: P0 (最高)
**前置条件**: 用户已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入个人主页 `/user/profile` | 页面加载成功 | | ⬜ |
| 2 | 查看头部信息 | 显示头像、昵称、签名、居住地 | | ⬜ |
| 3 | 查看统计数据 | 显示关注数、粉丝数、获赞数 | | ⬜ |
| 4 | 查看默认Tab | 默认显示"动态"Tab | | ⬜ |
| 5 | 查看动态列表 | 显示用户发布的动态 | | ⬜ |

**测试数据**:
```json
{
  "expectedHeader": {
    "nickname": "测试用户A",
    "avatar": "https://cdn.example.com/avatar1.jpg",
    "stats": {
      "followingCount": 100,
      "fansCount": 500,
      "likesCount": 1000
    }
  }
}
```

#### 测试场景 2: Tab切换功能
**用例ID**: TC-PROFILE-002
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击"收藏"Tab | 切换到收藏列表 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/user/profile/favorites` | | ⬜ |
| 3 | 查看收藏内容 | 显示收藏的动态列表 | | ⬜ |
| 4 | 点击"点赞"Tab | 切换到点赞列表 | | ⬜ |
| 5 | 点击"资料"Tab | 显示个人资料信息 | | ⬜ |
| 6 | 验证Tab状态 | 当前Tab有紫色下划线 | | ⬜ |

#### 测试场景 3: 点赞/收藏操作
**用例ID**: TC-PROFILE-003
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击动态的点赞按钮 | 图标变红色，数量+1 | | ⬜ |
| 2 | 验证API调用 | 调用 `POST /api/moments/{momentId}/like` | | ⬜ |
| 3 | 再次点击点赞按钮 | 图标变灰色，数量-1 | | ⬜ |
| 4 | 点击收藏按钮 | 图标变黄色，数量+1 | | ⬜ |
| 5 | 切换到收藏Tab | 新收藏的动态出现在列表中 | | ⬜ |

#### 测试场景 4: 分页加载
**用例ID**: TC-PROFILE-004
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 滚动到列表底部 | 显示"加载中..." | | ⬜ |
| 2 | 等待加载完成 | 追加下一页数据 | | ⬜ |
| 3 | 继续滚动加载 | 持续加载直到无更多数据 | | ⬜ |
| 4 | 加载到最后一页 | 显示"没有更多了" | | ⬜ |
| 5 | 下拉刷新 | 重新加载第一页数据 | | ⬜ |

#### 测试场景 5: 空状态显示
**用例ID**: TC-PROFILE-005
**优先级**: P2

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 切换到动态Tab（无动态） | 显示"还没有发布任何动态" | | ⬜ |
| 2 | 查看"去发布"按钮 | 显示发布引导按钮 | | ⬜ |
| 3 | 切换到收藏Tab（无收藏） | 显示"还没有收藏任何内容" | | ⬜ |
| 4 | 切换到点赞Tab（无点赞） | 显示"还没有点赞任何内容" | | ⬜ |

---

### 3.2 编辑资料页面

#### 测试场景 1: 页面数据加载
**用例ID**: TC-EDIT-001
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入编辑资料页面 | 页面加载成功 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/user/profile/edit` | | ⬜ |
| 3 | 查看表单数据 | 所有字段填充用户当前数据 | | ⬜ |
| 4 | 检查必填项标识 | 带*的字段不能为空 | | ⬜ |

#### 测试场景 2: 头像上传
**用例ID**: TC-EDIT-002
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击头像区域 | 打开图片选择器 | | ⬜ |
| 2 | 选择JPG图片(2MB) | 开始上传，显示进度条 | | ⬜ |
| 3 | 等待上传完成 | 头像更新，显示Toast"头像更新成功" | | ⬜ |
| 4 | 验证API调用 | 调用 `POST /api/user/avatar/upload` | | ⬜ |
| 5 | 返回个人主页 | 头像已更新 | | ⬜ |

**边界测试**:

| 用例ID | 测试场景 | 操作 | 预期结果 | 状态 |
|--------|---------|------|---------|------|
| TC-EDIT-002-1 | 上传超大图片 | 选择6MB图片 | 提示"图片大小不能超过5MB" | ⬜ |
| TC-EDIT-002-2 | 上传错误格式 | 选择GIF图片 | 提示"仅支持JPG、PNG格式" | ⬜ |
| TC-EDIT-002-3 | 上传失败 | 模拟网络错误 | 显示错误提示，恢复原头像 | ⬜ |

#### 测试场景 3: 实时保存功能
**用例ID**: TC-EDIT-003
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 修改昵称为"新昵称" | 输入框显示新内容 | | ⬜ |
| 2 | 失去焦点 | 显示加载图标 | | ⬜ |
| 3 | 等待保存 | 调用 `PUT /api/user/profile/nickname` | | ⬜ |
| 4 | 保存成功 | 显示绿色✓，0.5秒后消失 | | ⬜ |
| 5 | 刷新页面 | 昵称已更新为"新昵称" | | ⬜ |

**所有字段实时保存测试**:

| 用例ID | 字段 | 测试值 | API端点 | 状态 |
|--------|------|--------|---------|------|
| TC-EDIT-003-1 | 昵称 | "测试昵称123" | PUT /api/user/profile/nickname | ⬜ |
| TC-EDIT-003-2 | 性别 | "male" | PUT /api/user/profile/gender | ⬜ |
| TC-EDIT-003-3 | 生日 | "1995-06-15" | PUT /api/user/profile/birthday | ⬜ |
| TC-EDIT-003-4 | 居住地 | "广东省广州市天河区" | PUT /api/user/profile/residence | ⬜ |
| TC-EDIT-003-5 | 身高 | 175 | PUT /api/user/profile/height | ⬜ |
| TC-EDIT-003-6 | 体重 | 65 | PUT /api/user/profile/weight | ⬜ |
| TC-EDIT-003-7 | 职业 | "软件工程师" | PUT /api/user/profile/occupation | ⬜ |
| TC-EDIT-003-8 | 微信号 | "wechat_test123" | PUT /api/user/profile/wechat | ⬜ |
| TC-EDIT-003-9 | 个性签名 | "这是我的测试签名" | PUT /api/user/profile/bio | ⬜ |

#### 测试场景 4: 字段验证
**用例ID**: TC-EDIT-004
**优先级**: P0

**昵称验证**:

| 子用例ID | 输入值 | 预期结果 | 状态 |
|---------|--------|---------|------|
| TC-EDIT-004-1 | "A" (1字符) | 错误提示"昵称长度为2-20字符" | ⬜ |
| TC-EDIT-004-2 | "AB" (2字符) | 保存成功✓ | ⬜ |
| TC-EDIT-004-3 | 20个字符 | 保存成功✓ | ⬜ |
| TC-EDIT-004-4 | 21个字符 | 错误提示"昵称长度为2-20字符" | ⬜ |
| TC-EDIT-004-5 | "测试<script>" | 错误提示"昵称不能包含特殊字符" | ⬜ |

**身高验证**:

| 子用例ID | 输入值 | 预期结果 | 状态 |
|---------|--------|---------|------|
| TC-EDIT-004-6 | 99 | 错误提示"身高范围为100-250cm" | ⬜ |
| TC-EDIT-004-7 | 100 | 保存成功✓ | ⬜ |
| TC-EDIT-004-8 | 175 | 保存成功✓ | ⬜ |
| TC-EDIT-004-9 | 250 | 保存成功✓ | ⬜ |
| TC-EDIT-004-10 | 251 | 错误提示"身高范围为100-250cm" | ⬜ |

**微信号验证**:

| 子用例ID | 输入值 | 预期结果 | 状态 |
|---------|--------|---------|------|
| TC-EDIT-004-11 | "abc" (3字符) | 错误提示"微信号长度为6-20字符" | ⬜ |
| TC-EDIT-004-12 | "abc123" (6字符) | 保存成功✓ | ⬜ |
| TC-EDIT-004-13 | "abc_123-test" | 保存成功✓ | ⬜ |
| TC-EDIT-004-14 | "abc@123" | 错误提示"微信号只能包含字母、数字、下划线和减号" | ⬜ |

---

### 3.3 技能管理页面

#### 测试场景 1: 技能列表加载
**用例ID**: TC-SKILL-001
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入技能管理页面 | 页面加载成功 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/user/skills` | | ⬜ |
| 3 | 查看默认Tab | 默认显示"线上技能" | | ⬜ |
| 4 | 查看技能列表 | 显示用户的线上技能 | | ⬜ |
| 5 | 点击"线下技能"Tab | 切换到线下技能列表 | | ⬜ |

#### 测试场景 2: 创建线上技能完整流程
**用例ID**: TC-SKILL-002
**优先级**: P0
**测试流程**: 完整的线上技能创建

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击"+ 发布"按钮 | 跳转到选择技能类型页面 | | ⬜ |
| 2 | 点击"线上技能"卡片 | 跳转到创建线上技能页面 | | ⬜ |
| 3 | 获取技能配置 | 调用 `GET /api/skills/config` | | ⬜ |
| 4 | 上传封面图 | 调用 `POST /api/skills/images/upload` | | ⬜ |
| 5 | 选择游戏"王者荣耀" | 下拉框显示游戏列表 | | ⬜ |
| 6 | 选择段位"王者" | 根据游戏显示段位列表 | | ⬜ |
| 7 | 输入技能名称 | "王者荣耀上分带练" | | ⬜ |
| 8 | 输入技能介绍 | 输入100字介绍 | | ⬜ |
| 9 | 设置价格 | 99元/局 | | ⬜ |
| 10 | 设置服务时长 | 1.5小时/局 | | ⬜ |
| 11 | 上传展示图 | 上传3张展示图 | | ⬜ |
| 12 | 选择服务承诺 | 勾选"准时开始"、"耐心指导" | | ⬜ |
| 13 | 开启"立即上架" | 切换开关为ON | | ⬜ |
| 14 | 点击"保存"按钮 | 调用 `POST /api/user/skills/online` | | ⬜ |
| 15 | 验证返回 | 显示Toast"发布成功" | | ⬜ |
| 16 | 返回管理页面 | 新技能出现在列表顶部 | | ⬜ |
| 17 | 验证技能状态 | 上架标签显示"上架" | | ⬜ |

**测试数据**:
```json
{
  "coverImage": "https://cdn.example.com/skill-cover.jpg",
  "gameName": "王者荣耀",
  "gameRank": "王者",
  "skillName": "王者荣耀上分带练",
  "description": "提供王者荣耀上分服务，拥有多年游戏经验，擅长打野和中单位置，可带新手快速上分...",
  "price": 99.00,
  "serviceHours": 1.5,
  "images": [
    "https://cdn.example.com/skill-img1.jpg",
    "https://cdn.example.com/skill-img2.jpg",
    "https://cdn.example.com/skill-img3.jpg"
  ],
  "promises": ["准时开始", "耐心指导", "友好交流"],
  "isOnline": true
}
```

#### 测试场景 3: 创建线下技能完整流程
**用例ID**: TC-SKILL-003
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击"+ 发布"按钮 | 跳转到选择类型页面 | | ⬜ |
| 2 | 点击"线下技能"卡片 | 跳转到创建线下技能页面 | | ⬜ |
| 3 | 上传封面图 | 成功上传 | | ⬜ |
| 4 | 选择服务类型"家政服务" | 下拉框选择 | | ⬜ |
| 5 | 输入技能名称 | "专业家庭清洁服务" | | ⬜ |
| 6 | 输入技能介绍 | 输入150字介绍 | | ⬜ |
| 7 | 设置价格 | 80元/小时 | | ⬜ |
| 8 | 选择服务地点 | 打开地图选择器，选择位置 | | ⬜ |
| 9 | 设置服务时间 | 周一到周五 9:00-18:00 | | ⬜ |
| 10 | 上传展示图 | 上传2张图片 | | ⬜ |
| 11 | 选择服务承诺 | 勾选"上门服务"、"工具齐全" | | ⬜ |
| 12 | 点击"保存"按钮 | 调用 `POST /api/user/skills/offline` | | ⬜ |
| 13 | 验证返回 | 显示Toast"发布成功" | | ⬜ |
| 14 | 返回管理页面 | 新技能出现在线下技能列表 | | ⬜ |

**测试数据**:
```json
{
  "coverImage": "https://cdn.example.com/cleaning-cover.jpg",
  "serviceType": "cleaning",
  "skillName": "专业家庭清洁服务",
  "description": "提供专业家庭清洁服务，包括日常保洁、深度清洁、开荒保洁等...",
  "price": 80.00,
  "location": {
    "address": "广东省广州市天河区珠江新城",
    "latitude": 23.1200,
    "longitude": 113.3240
  },
  "availableTimes": [
    {"dayOfWeek": 1, "startTime": "09:00", "endTime": "18:00", "enabled": true},
    {"dayOfWeek": 2, "startTime": "09:00", "endTime": "18:00", "enabled": true},
    {"dayOfWeek": 3, "startTime": "09:00", "endTime": "18:00", "enabled": true},
    {"dayOfWeek": 4, "startTime": "09:00", "endTime": "18:00", "enabled": true},
    {"dayOfWeek": 5, "startTime": "09:00", "endTime": "18:00", "enabled": true}
  ],
  "images": [
    "https://cdn.example.com/cleaning-img1.jpg",
    "https://cdn.example.com/cleaning-img2.jpg"
  ],
  "promises": ["上门服务", "工具齐全", "专业可靠"],
  "isOnline": false
}
```

#### 测试场景 4: 编辑技能
**用例ID**: TC-SKILL-004
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击技能卡片的"编辑"按钮 | 跳转到编辑页面 | | ⬜ |
| 2 | 验证数据加载 | 表单填充技能当前数据 | | ⬜ |
| 3 | 修改价格为120元 | 输入框显示新价格 | | ⬜ |
| 4 | 修改技能介绍 | 更新介绍内容 | | ⬜ |
| 5 | 点击"保存"按钮 | 调用对应的PUT接口 | | ⬜ |
| 6 | 返回管理页面 | 技能信息已更新 | | ⬜ |

#### 测试场景 5: 上下架切换
**用例ID**: TC-SKILL-005
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击技能的"上架"标签 | 标签立即变为"下架" | | ⬜ |
| 2 | 验证API调用 | 调用 `PUT /api/user/skills/{skillId}/status` | | ⬜ |
| 3 | 验证参数 | isOnline: false | | ⬜ |
| 4 | 显示Toast | "已下架" | | ⬜ |
| 5 | 再次点击标签 | 标签变为"上架" | | ⬜ |
| 6 | 显示Toast | "已上架" | | ⬜ |

#### 测试场景 6: 删除技能
**用例ID**: TC-SKILL-006
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击技能卡片的"•••"按钮 | 弹出操作菜单 | | ⬜ |
| 2 | 点击"删除"选项 | 弹出确认对话框 | | ⬜ |
| 3 | 查看对话框内容 | 标题"删除技能"，内容包含技能名称 | | ⬜ |
| 4 | 点击"取消"按钮 | 关闭对话框，不删除 | | ⬜ |
| 5 | 再次打开删除对话框 | 弹出确认对话框 | | ⬜ |
| 6 | 点击"确定删除"按钮 | 调用 `DELETE /api/user/skills/{skillId}` | | ⬜ |
| 7 | 验证返回 | 显示Toast"删除成功" | | ⬜ |
| 8 | 查看列表 | 技能从列表中移除 | | ⬜ |

#### 测试场景 7: 表单验证
**用例ID**: TC-SKILL-007
**优先级**: P0

**必填项验证**:

| 子用例ID | 场景 | 预期结果 | 状态 |
|---------|------|---------|------|
| TC-SKILL-007-1 | 不上传封面图直接保存 | 提示"请上传封面图" | ⬜ |
| TC-SKILL-007-2 | 不选择游戏名称 | 提示"请选择游戏" | ⬜ |
| TC-SKILL-007-3 | 技能名称为空 | 提示"技能名称不能为空" | ⬜ |
| TC-SKILL-007-4 | 技能介绍少于10字 | 提示"技能介绍长度为10-500字符" | ⬜ |
| TC-SKILL-007-5 | 价格为0 | 提示"价格必须大于0" | ⬜ |

---

### 3.4 粉丝列表页面

#### 测试场景 1: 列表加载与展示
**用例ID**: TC-FANS-001
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入粉丝列表页面 | 页面加载成功 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/users/fans?page=1` | | ⬜ |
| 3 | 查看列表内容 | 显示粉丝卡片列表 | | ⬜ |
| 4 | 验证卡片信息 | 包含头像、昵称、签名、居住地、身高 | | ⬜ |
| 5 | 验证关注状态 | 显示正确的关注按钮状态 | | ⬜ |

#### 测试场景 2: 搜索功能
**用例ID**: TC-FANS-002
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击搜索图标 | 展开搜索框 | | ⬜ |
| 2 | 输入"张三" | 防抖500ms后自动搜索 | | ⬜ |
| 3 | 验证API调用 | 调用 `GET /api/users/fans/search?keyword=张三` | | ⬜ |
| 4 | 查看搜索结果 | 显示匹配的粉丝列表 | | ⬜ |
| 5 | 点击清空按钮 | 清空搜索，显示完整列表 | | ⬜ |

#### 测试场景 3: 关注/取消关注
**用例ID**: TC-FANS-003
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 找到一个未关注的粉丝 | 按钮显示"关注" | | ⬜ |
| 2 | 点击"关注"按钮 | 按钮立即变为"已关注" | | ⬜ |
| 3 | 验证API调用 | 调用 `POST /api/users/follow` | | ⬜ |
| 4 | 点击"已关注"按钮 | 弹出确认对话框 | | ⬜ |
| 5 | 确认取消关注 | 按钮变为"关注" | | ⬜ |
| 6 | 验证API调用 | 调用 `DELETE /api/users/follow/{userId}` | | ⬜ |

#### 测试场景 4: 互相关注状态
**用例ID**: TC-FANS-004
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 关注一个粉丝 | 按钮显示"互相关注" | | ⬜ |
| 2 | 验证按钮样式 | 紫色边框按钮 | | ⬜ |
| 3 | 点击"互相关注"按钮 | 弹出确认对话框 | | ⬜ |
| 4 | 确认取消 | 按钮变为"关注" | | ⬜ |

---

### 3.5 关注列表页面

#### 测试场景 1: 列表加载
**用例ID**: TC-FOLLOWING-001
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入关注列表页面 | 页面加载成功 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/users/following` | | ⬜ |
| 3 | 查看列表 | 显示关注的用户列表 | | ⬜ |
| 4 | 验证关注状态 | 所有用户都显示"已关注"或"互相关注" | | ⬜ |

---

### 3.6 他人主页页面

#### 测试场景 1: 查看他人主页
**用例ID**: TC-OTHER-PROFILE-001
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 进入他人主页 `/users/{userId}/profile` | 页面加载成功 | | ⬜ |
| 2 | 验证API调用 | 调用 `GET /api/user/profile/other/{userId}` | | ⬜ |
| 3 | 查看用户信息 | 显示头像、昵称、签名、统计数据 | | ⬜ |
| 4 | 查看关注按钮 | 显示"关注"或"已关注"按钮 | | ⬜ |
| 5 | 查看距离信息 | 显示"距离你XX米"（如有位置权限） | | ⬜ |

#### 测试场景 2: 关注/举报/拉黑操作
**用例ID**: TC-OTHER-PROFILE-002
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|---------|---------|------|
| 1 | 点击"关注"按钮 | 按钮变为"已关注" | | ⬜ |
| 2 | 点击"•••"菜单 | 显示更多操作菜单 | | ⬜ |
| 3 | 查看菜单选项 | 包含"举报"、"拉黑"选项 | | ⬜ |
| 4 | 点击"举报" | 打开举报表单 | | ⬜ |
| 5 | 填写举报理由 | 输入举报原因和描述 | | ⬜ |
| 6 | 提交举报 | 调用 `POST /api/user/relation/report` | | ⬜ |
| 7 | 返回主页 | 显示Toast"举报成功" | | ⬜ |

---

## 四、API接口测试

### 4.1 用户资料接口测试

#### 接口: GET /api/user/profile/header
**测试用例ID**: API-001

| 测试项 | 测试内容 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 正常请求 | 带有效Token | 返回200，包含用户头部信息 | ⬜ |
| 无Token | 不带Authorization头 | 返回401，提示"未登录" | ⬜ |
| Token过期 | 使用过期Token | 返回401，提示"登录已过期" | ⬜ |
| 响应字段 | 验证返回字段完整性 | 包含userId, nickname, avatar, stats | ⬜ |
| 响应时间 | 测试响应速度 | P95 < 100ms | ⬜ |

**测试脚本 (Postman)**:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Response has user data", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData.data).to.have.property('userId');
    pm.expect(jsonData.data).to.have.property('nickname');
    pm.expect(jsonData.data).to.have.property('avatar');
    pm.expect(jsonData.data.stats).to.have.property('followingCount');
    pm.expect(jsonData.data.stats).to.have.property('fansCount');
    pm.expect(jsonData.data.stats).to.have.property('likesCount');
});

pm.test("Response time is less than 200ms", function () {
    pm.expect(pm.response.responseTime).to.be.below(200);
});
```

#### 接口: POST /api/user/avatar/upload
**测试用例ID**: API-002

| 测试项 | 测试内容 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 上传JPG | 2MB JPG文件 | 返回200，返回avatarUrl | ⬜ |
| 上传PNG | 3MB PNG文件 | 返回200，返回avatarUrl | ⬜ |
| 上传超大文件 | 6MB JPG文件 | 返回400，提示"图片大小不能超过5MB" | ⬜ |
| 上传错误格式 | GIF文件 | 返回400，提示"仅支持JPG、PNG格式" | ⬜ |
| 空文件 | 不上传文件 | 返回400，提示"图片不能为空" | ⬜ |

#### 接口: PUT /api/user/profile/nickname
**测试用例ID**: API-003

| 测试项 | 测试值 | 预期结果 | 状态 |
|-------|--------|---------|------|
| 正常昵称 | "测试昵称" | 返回200 | ⬜ |
| 最短昵称 | "AB" (2字符) | 返回200 | ⬜ |
| 最长昵称 | 20个字符 | 返回200 | ⬜ |
| 过短昵称 | "A" (1字符) | 返回400，提示长度错误 | ⬜ |
| 过长昵称 | 21个字符 | 返回400，提示长度错误 | ⬜ |
| 特殊字符 | "test<script>" | 返回400，提示包含特殊字符 | ⬜ |
| 敏感词 | "测试敏感词" | 返回400，提示包含敏感词 | ⬜ |

### 4.2 技能管理接口测试

#### 接口: GET /api/skills/config
**测试用例ID**: API-010

| 测试项 | 测试内容 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 获取配置 | 正常请求 | 返回200，包含games和serviceTypes | ⬜ |
| 验证游戏列表 | 检查games字段 | 包含王者荣耀、和平精英、英雄联盟、原神 | ⬜ |
| 验证段位 | 检查ranks字段 | 每个游戏有对应段位列表 | ⬜ |
| 验证服务类型 | 检查serviceTypes | 包含家政、维修、摄影等类型 | ⬜ |
| 缓存测试 | 连续请求3次 | 响应时间递减（缓存生效） | ⬜ |

#### 接口: POST /api/user/skills/online
**测试用例ID**: API-011

**正常情况测试**:

| 测试项 | 测试数据 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 完整数据 | 所有必填项+可选项 | 返回200，返回skillId | ⬜ |
| 仅必填项 | 仅必填项 | 返回200，返回skillId | ⬜ |
| 立即上架 | isOnline=true | 技能创建后isOnline=true | ⬜ |
| 暂不上架 | isOnline=false | 技能创建后isOnline=false | ⬜ |

**异常情况测试**:

| 测试项 | 缺失字段 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 缺少gameName | 不传gameName | 返回400，提示"游戏名称不能为空" | ⬜ |
| 缺少skillName | 不传skillName | 返回400，提示"技能名称不能为空" | ⬜ |
| 价格为0 | price=0 | 返回400，提示"价格必须大于0" | ⬜ |
| 介绍过短 | description="短" | 返回400，提示"技能介绍长度为10-500字符" | ⬜ |

#### 接口: POST /api/user/skills/offline
**测试用例ID**: API-012

**正常情况测试**:

| 测试项 | 测试数据 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 完整数据 | 所有必填项+可选项 | 返回200，返回skillId | ⬜ |
| 多个可用时间 | 7天可用时间 | 成功创建，保存所有时间段 | ⬜ |
| 单个可用时间 | 仅周一可用 | 成功创建 | ⬜ |

**异常情况测试**:

| 测试项 | 测试场景 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 缺少location | 不传location | 返回400，提示"服务地点不能为空" | ⬜ |
| 缺少availableTimes | 不传availableTimes | 返回400，提示"至少设置一个可用时间段" | ⬜ |
| 经纬度错误 | latitude=999 | 返回400，提示"经纬度格式错误" | ⬜ |

#### 接口: DELETE /api/user/skills/{skillId}
**测试用例ID**: API-013

| 测试项 | 测试场景 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 删除自己的技能 | 正常删除 | 返回200 | ⬜ |
| 删除他人技能 | 使用其他用户的skillId | 返回403，提示"无权操作" | ⬜ |
| 删除不存在的技能 | skillId=9999999 | 返回404，提示"技能不存在" | ⬜ |
| 数据库验证 | 删除后查询 | 技能记录被删除或标记为删除 | ⬜ |

### 4.3 关系管理接口测试

#### 接口: POST /api/user/relation/follow/{followingId}
**测试用例ID**: API-020

| 测试项 | 测试场景 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 关注其他用户 | 正常关注 | 返回200 | ⬜ |
| 重复关注 | 关注已关注的用户 | 返回400，提示"已经关注" | ⬜ |
| 关注自己 | followingId=当前用户 | 返回400，提示"不能关注自己" | ⬜ |
| 关注不存在的用户 | followingId=9999999 | 返回404，提示"用户不存在" | ⬜ |
| 统计更新 | 关注后查询统计 | followingCount+1 | ⬜ |

#### 接口: DELETE /api/user/relation/follow/{followingId}
**测试用例ID**: API-021

| 测试项 | 测试场景 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 取消关注 | 正常取消 | 返回200 | ⬜ |
| 取消未关注的用户 | 未关注就取消 | 返回400，提示"未关注该用户" | ⬜ |
| 统计更新 | 取消后查询统计 | followingCount-1 | ⬜ |

#### 接口: GET /api/user/relation/fans
**测试用例ID**: API-022

| 测试项 | 测试场景 | 预期结果 | 状态 |
|-------|---------|---------|------|
| 获取粉丝列表 | page=1, pageSize=20 | 返回200，包含fans数组 | ⬜ |
| 分页测试 | 请求多页 | 每页返回正确数量 | ⬜ |
| 关注状态正确 | 检查followStatus | none/following/mutual正确 | ⬜ |
| 空列表 | 无粉丝用户 | 返回200，fans=[]，total=0 | ⬜ |

---

## 五、完整流程测试

### 5.1 新用户完整注册流程

**流程ID**: FLOW-001
**测试目标**: 验证新用户从注册到完善资料的完整流程
**优先级**: P0

| 步骤 | 操作 | 接口/页面 | 预期结果 | 状态 |
|------|------|----------|---------|------|
| 1 | 打开APP | 登录页面 | 显示登录页面 | ⬜ |
| 2 | 输入新手机号 | - | 13800000099 | ⬜ |
| 3 | 获取验证码 | POST /api/auth/sms/send | 收到验证码 | ⬜ |
| 4 | 输入验证码 | - | 输入6位验证码 | ⬜ |
| 5 | 点击登录 | POST /api/auth/login | 自动创建用户，返回Token | ⬜ |
| 6 | 跳转个人主页 | /user/profile | 显示默认头像和昵称 | ⬜ |
| 7 | 点击编辑按钮 | - | 跳转到编辑资料页面 | ⬜ |
| 8 | 上传头像 | POST /api/user/avatar/upload | 头像上传成功 | ⬜ |
| 9 | 修改昵称 | PUT /api/user/profile/nickname | 昵称保存成功 | ⬜ |
| 10 | 选择性别 | PUT /api/user/profile/gender | 性别保存成功 | ⬜ |
| 11 | 选择生日 | PUT /api/user/profile/birthday | 生日保存成功 | ⬜ |
| 12 | 选择居住地 | PUT /api/user/profile/residence | 居住地保存成功 | ⬜ |
| 13 | 输入身高 | PUT /api/user/profile/height | 身高保存成功 | ⬜ |
| 14 | 返回主页 | /user/profile | 显示完整的个人信息 | ⬜ |

**测试数据**:
```json
{
  "phone": "13800000099",
  "nickname": "新用户测试",
  "gender": "male",
  "birthday": "1995-01-01",
  "residence": "广东省广州市",
  "height": 175
}
```

### 5.2 技能发布完整流程

**流程ID**: FLOW-002
**测试目标**: 验证从创建到上架技能的完整流程
**优先级**: P0

| 步骤 | 操作 | 接口/页面 | 预期结果 | 状态 |
|------|------|----------|---------|------|
| 1 | 进入技能管理页 | /user/skills | 显示技能列表 | ⬜ |
| 2 | 点击"+ 发布" | - | 跳转到选择类型页面 | ⬜ |
| 3 | 选择"线上技能" | - | 跳转到创建页面 | ⬜ |
| 4 | 获取配置数据 | GET /api/skills/config | 加载游戏和段位列表 | ⬜ |
| 5 | 上传封面图 | POST /api/skills/images/upload | 上传成功，返回URL | ⬜ |
| 6 | 选择游戏"王者荣耀" | - | 显示对应段位列表 | ⬜ |
| 7 | 选择段位"王者" | - | 段位选中 | ⬜ |
| 8 | 填写技能信息 | - | 表单填写完整 | ⬜ |
| 9 | 上传展示图 | POST /api/skills/images/upload | 3张图片上传成功 | ⬜ |
| 10 | 勾选服务承诺 | - | 选中2个承诺 | ⬜ |
| 11 | 开启"立即上架" | - | 开关打开 | ⬜ |
| 12 | 点击"保存" | POST /api/user/skills/online | 技能创建成功，返回skillId | ⬜ |
| 13 | 返回管理页 | /user/skills | 新技能出现在列表顶部 | ⬜ |
| 14 | 验证上架状态 | - | 显示"上架"标签 | ⬜ |
| 15 | 点击"查看详情" | /skills/{skillId} | 跳转到技能详情页 | ⬜ |
| 16 | 验证详情页 | - | 所有信息显示正确 | ⬜ |

### 5.3 用户社交互动完整流程

**流程ID**: FLOW-003
**测试目标**: 验证用户间的关注、互动流程
**优先级**: P0

| 步骤 | 操作 | 接口/页面 | 预期结果 | 状态 |
|------|------|----------|---------|------|
| 1 | 用户A登录 | - | 登录成功 | ⬜ |
| 2 | 搜索用户B | GET /api/users/search | 找到用户B | ⬜ |
| 3 | 进入用户B主页 | /users/{userId}/profile | 显示用户B资料 | ⬜ |
| 4 | 点击"关注"按钮 | POST /api/user/relation/follow/{userId} | 关注成功 | ⬜ |
| 5 | 验证按钮状态 | - | 显示"已关注" | ⬜ |
| 6 | 查看用户B的动态 | GET /api/users/{userId}/moments | 显示动态列表 | ⬜ |
| 7 | 点赞一条动态 | POST /api/moments/{momentId}/like | 点赞成功 | ⬜ |
| 8 | 查看用户B的技能 | GET /api/users/{userId}/skills | 显示技能列表 | ⬜ |
| 9 | 进入技能详情 | /skills/{skillId} | 显示技能详情 | ⬜ |
| 10 | 用户B登录 | - | 登录成功 | ⬜ |
| 11 | 查看粉丝列表 | GET /api/user/relation/fans | 用户A出现在列表中 | ⬜ |
| 12 | 关注用户A | POST /api/user/relation/follow/{userId} | 关注成功 | ⬜ |
| 13 | 用户A刷新粉丝列表 | - | 用户B显示"互相关注" | ⬜ |

### 5.4 技能管理完整生命周期

**流程ID**: FLOW-004
**测试目标**: 验证技能从创建到删除的完整生命周期
**优先级**: P1

| 步骤 | 操作 | 接口/页面 | 预期结果 | 状态 |
|------|------|----------|---------|------|
| 1 | 创建技能 | POST /api/user/skills/online | 技能创建成功 | ⬜ |
| 2 | 验证初始状态 | - | isOnline=false（暂不上架） | ⬜ |
| 3 | 点击上架 | PUT /api/user/skills/{skillId}/status | 上架成功 | ⬜ |
| 4 | 其他用户搜索 | GET /api/skills/available | 能搜索到该技能 | ⬜ |
| 5 | 编辑技能 | PUT /api/user/skills/online/{skillId} | 更新成功 | ⬜ |
| 6 | 验证更新 | GET /api/user/skills/{skillId} | 信息已更新 | ⬜ |
| 7 | 下架技能 | PUT /api/user/skills/{skillId}/status | 下架成功 | ⬜ |
| 8 | 其他用户搜索 | GET /api/skills/available | 搜索不到该技能 | ⬜ |
| 9 | 删除技能 | DELETE /api/user/skills/{skillId} | 删除成功 | ⬜ |
| 10 | 验证删除 | GET /api/user/skills | 列表中不再显示 | ⬜ |

### 5.5 编辑资料完整流程

**流程ID**: FLOW-005
**测试目标**: 验证编辑所有资料字段的完整流程
**优先级**: P1

| 步骤 | 字段 | 操作值 | API | 状态 |
|------|------|--------|-----|------|
| 1 | 头像 | 上传新头像 | POST /api/user/avatar/upload | ⬜ |
| 2 | 昵称 | "更新后的昵称" | PUT /api/user/profile/nickname | ⬜ |
| 3 | 性别 | "female" | PUT /api/user/profile/gender | ⬜ |
| 4 | 生日 | "1990-12-31" | PUT /api/user/profile/birthday | ⬜ |
| 5 | 居住地 | "北京市朝阳区" | PUT /api/user/profile/residence | ⬜ |
| 6 | 身高 | 165 | PUT /api/user/profile/height | ⬜ |
| 7 | 体重 | 50 | PUT /api/user/profile/weight | ⬜ |
| 8 | 职业 | "产品经理" | PUT /api/user/profile/occupation | ⬜ |
| 9 | 微信号 | "wechat_2025" | PUT /api/user/profile/wechat | ⬜ |
| 10 | 个性签名 | "新的签名..." | PUT /api/user/profile/bio | ⬜ |
| 11 | 返回主页 | - | 所有信息已更新 | ⬜ |

---

## 六、性能测试

### 6.1 接口性能测试

**测试工具**: JMeter
**测试目标**: 验证接口响应时间和并发能力

#### 测试场景 1: 获取用户信息性能测试
**接口**: GET /api/user/profile/header

| 并发数 | 请求总数 | P50响应时间 | P95响应时间 | P99响应时间 | 成功率 | 状态 |
|--------|---------|------------|------------|------------|--------|------|
| 10 | 1000 | < 50ms | < 100ms | < 150ms | > 99.9% | ⬜ |
| 50 | 5000 | < 80ms | < 150ms | < 200ms | > 99.5% | ⬜ |
| 100 | 10000 | < 100ms | < 200ms | < 300ms | > 99% | ⬜ |
| 500 | 50000 | < 150ms | < 300ms | < 500ms | > 98% | ⬜ |

#### 测试场景 2: 技能列表性能测试
**接口**: GET /api/user/skills

| 并发数 | 请求总数 | P95响应时间 | 成功率 | 状态 |
|--------|---------|------------|--------|------|
| 10 | 1000 | < 150ms | > 99.9% | ⬜ |
| 50 | 5000 | < 250ms | > 99% | ⬜ |
| 100 | 10000 | < 400ms | > 98% | ⬜ |

#### 测试场景 3: 关注操作性能测试
**接口**: POST /api/user/relation/follow/{userId}

| 并发数 | 请求总数 | P95响应时间 | 成功率 | 状态 |
|--------|---------|------------|--------|------|
| 10 | 500 | < 200ms | > 99.9% | ⬜ |
| 50 | 2500 | < 300ms | > 99% | ⬜ |
| 100 | 5000 | < 500ms | > 98% | ⬜ |

### 6.2 缓存性能测试

| 测试场景 | 测试方法 | 预期结果 | 状态 |
|---------|---------|---------|------|
| 用户信息缓存 | 连续请求同一用户信息 | 第2次起响应时间 < 20ms | ⬜ |
| 技能列表缓存 | 连续请求技能列表 | 缓存命中率 > 85% | ⬜ |
| 缓存失效 | 更新用户信息后再查询 | 返回最新数据 | ⬜ |

### 6.3 数据库性能测试

| 测试场景 | 数据量 | 查询时间要求 | 状态 |
|---------|--------|------------|------|
| 用户表查询 | 100万用户 | < 50ms | ⬜ |
| 技能列表查询 | 10万技能 | < 100ms | ⬜ |
| 关注关系查询 | 用户有1万关注 | < 150ms | ⬜ |
| 附近技能搜索 | 10万技能，半径10km | < 200ms | ⬜ |

---

## 七、安全测试

### 7.1 认证授权测试

| 测试场景 | 测试内容 | 预期结果 | 状态 |
|---------|---------|---------|------|
| 无Token访问 | 不带Token请求需认证接口 | 返回401 | ⬜ |
| Token过期 | 使用过期Token | 返回401，提示重新登录 | ⬜ |
| Token伪造 | 使用伪造的Token | 返回401，提示非法Token | ⬜ |
| 越权访问 | 用户A访问用户B的私有数据 | 返回403，提示无权限 | ⬜ |
| 删除他人技能 | 用户A删除用户B的技能 | 返回403，提示无权限 | ⬜ |

### 7.2 SQL注入测试

| 测试接口 | 注入尝试 | 预期结果 | 状态 |
|---------|---------|---------|------|
| GET /api/user/profile/header | userId=' OR '1'='1 | 参数验证失败或无注入 | ⬜ |
| GET /api/users/fans/search | keyword='; DROP TABLE users-- | 无注入，正常搜索 | ⬜ |
| PUT /api/user/profile/nickname | nickname="<script>alert(1)</script>" | XSS过滤，保存安全 | ⬜ |

### 7.3 文件上传安全测试

| 测试场景 | 测试文件 | 预期结果 | 状态 |
|---------|---------|---------|------|
| 上传脚本文件 | test.php | 拒绝上传，提示格式错误 | ⬜ |
| 上传超大文件 | 10MB图片 | 拒绝上传，提示文件过大 | ⬜ |
| 双重后缀 | test.jpg.php | 拒绝上传或正确处理 | ⬜ |
| 文件内容验证 | JPG头但是PHP内容 | 拒绝上传 | ⬜ |

### 7.4 敏感信息测试

| 测试场景 | 测试内容 | 预期结果 | 状态 |
|---------|---------|---------|------|
| 手机号脱敏 | 查询他人资料 | 手机号显示138****0001 | ⬜ |
| 生日脱敏 | 查询他人生日 | 仅显示年龄 | ⬜ |
| 微信号隐藏 | 非好友查看 | 不显示微信号 | ⬜ |
| 密码不返回 | 任何接口 | 不返回密码字段 | ⬜ |

---

## 八、兼容性测试

### 8.1 浏览器兼容性

| 浏览器 | 版本 | 测试结果 | 问题记录 | 状态 |
|--------|------|---------|---------|------|
| Chrome | 最新版 | ⬜ | | ⬜ |
| Safari | 最新版 | ⬜ | | ⬜ |
| Firefox | 最新版 | ⬜ | | ⬜ |
| Edge | 最新版 | ⬜ | | ⬜ |

### 8.2 移动端兼容性

| 设备 | 系统版本 | 测试结果 | 问题记录 | 状态 |
|------|---------|---------|---------|------|
| iPhone 15 | iOS 17 | ⬜ | | ⬜ |
| iPhone 12 | iOS 16 | ⬜ | | ⬜ |
| 华为 Mate 60 | HarmonyOS 4 | ⬜ | | ⬜ |
| 小米 14 | MIUI 15 | ⬜ | | ⬜ |
| OPPO Find X7 | ColorOS 14 | ⬜ | | ⬜ |

### 8.3 屏幕分辨率兼容性

| 分辨率 | 设备类型 | 测试结果 | 状态 |
|--------|---------|---------|------|
| 375x667 | iPhone SE | ⬜ | ⬜ |
| 390x844 | iPhone 14 | ⬜ | ⬜ |
| 414x896 | iPhone 11 Pro Max | ⬜ | ⬜ |
| 360x800 | Android 中低端 | ⬜ | ⬜ |
| 1080x2340 | Android 旗舰 | ⬜ | ⬜ |

---

## 九、测试总结

### 9.1 测试覆盖率

- **页面覆盖**: 7/7 (100%)
- **功能点覆盖**: 待统计
- **API覆盖**: 50+个接口
- **代码覆盖率**: 待统计

### 9.2 缺陷统计

| 严重等级 | 数量 | 描述 |
|---------|------|------|
| P0-阻塞 | 0 | 导致系统无法使用 |
| P1-严重 | 0 | 核心功能无法使用 |
| P2-一般 | 0 | 影响部分功能 |
| P3-轻微 | 0 | 界面或体验问题 |

### 9.3 测试建议

1. **优先级排序**: 建议按照P0 → P1 → P2 → P3的顺序执行测试
2. **自动化测试**: 对于回归测试频繁的功能，建议编写自动化测试脚本
3. **性能监控**: 上线后持续监控接口性能，及时发现性能问题
4. **安全审计**: 定期进行安全审计和渗透测试

---

**文档版本**: 1.0
**最后更新**: 2025-11-14
**测试负责人**: XiangYuPai QA Team

