# 接口文档编写模板与规范

## 一、文档目标

创建简洁、实用的接口文档，清晰定义：
1. **用户操作** → 触发哪个接口
2. **接口参数** → 前端需要发送什么数据
3. **前端验证** → 调用接口前需要做什么检查

**核心原则：**
- 一个文档 = 一个功能模块
- 只关注用户操作和前端需求
- 不涉及后端实现细节

---

## 二、标准提示词模板

```
请基于提供的UI界面截图，生成接口文档。

【分析要求】
1. 识别所有用户操作：
   - 点击按钮触发的操作
   - 输入完成后自动触发的操作
   - 页面跳转关系

2. 提取接口需求：
   - 哪个用户操作触发哪个接口
   - 接口需要哪些参数
   - 参数从哪里获取（输入框、选择器等）

3. 明确前端验证规则：
   - 调用接口前需要验证什么
   - 验证失败如何提示

【输出格式】
生成一份结构化文档，包含：

1. 概述 - 一句话说明文档范围

2. 功能模块（按业务流程组织）
   每个功能包含：
   - 用户操作步骤（标注哪步触发接口）
   - 接口定义（方法、路径、参数）
   - 前端验证规则
   - 前端行为说明

3. 接口汇总表 - 快速查找表

4. 通用验证规则 - 跨接口的共同规则

5. 非接口操作 - 列出纯前端交互

【格式要求】
- Markdown格式
- 中文编写
- TypeScript定义参数
- 简洁明了，每个功能控制在1页内
- 使用流程图说明复杂流程

【编写风格】
- 直接、简洁
- 突出"用户做什么 → 调用什么接口"
- 避免冗余描述
```

---

## 三、文档结构模板

```markdown
# [模块名称]接口文档

## 概述
本文档定义[模块名称]的所有接口，包括用户操作触发时机和前端参数要求。

---

## 一、[功能1名称]

### 用户操作
1. 第一步操作
2. 第二步操作
3. **触发接口的操作** → 触发接口

### 接口定义
**接口:** `[方法] [路径]`

**参数:**
```typescript
{
  param1: type;  // 说明和示例
  param2: type;  // 说明和示例
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    field1: type;
    field2: type;
  }
}
```

### 前端验证
- 验证规则1
- 验证规则2

### 前端行为
- 成功后：
  - 行为1
  - 行为2
- 失败后：显示错误提示

---

## 二、[功能2名称]

### 用户操作流程（如果流程复杂）
```
[步骤1] 
  ↓ 操作
  → 触发接口1
  ↓
[步骤2]
  ↓ 操作
  → 触发接口2
```

### 接口1：[子功能名称]

**接口:** `[方法] [路径]`

**参数:**
```typescript
{
  param1: type;  // 说明
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    result: type;
  }
}
```

### 接口2：[子功能名称]

**接口:** `[方法] [路径]`

[同上结构]

### 前端验证
- 验证规则1
- 验证规则2

### 前端行为
- 成功后：具体行为
- 失败后：错误处理

---

## 接口汇总

| # | 功能 | 用户操作 | 接口 | 方法 |
|---|------|---------|------|------|
| 1 | 功能1 | 点击XX按钮 | `/api/xxx/xxx` | GET |
| 2 | 功能2 | 点击完成按钮 | `/api/xxx/xxx` | POST |

---

## 通用验证规则

### 登录状态
- 所有接口都需要登录状态
- 未登录时跳转至登录页

### [数据类型1]（如：文本输入）
- 不能为空
- 长度限制：X-Y字符
- 显示字符计数

### [数据类型2]（如：图片上传）
- 格式：jpg, jpeg, png, webp
- 大小：≤ XMB
- 数量：最多X张

### [数据类型3]（如：数字输入）
- 范围：X-Y
- 必须为整数/小数

---

## 非接口操作

以下操作不触发接口调用（纯前端交互）：

- **操作1** - 说明（如：点击"取消"按钮 - 返回上一页，不保存）
- **操作2** - 说明（如：打开选择器 - 打开XX选择器面板）
- **操作3** - 说明（如：字符计数 - 实时显示输入字符数）

---

## 数据传递

### 跨页面传递
**从页面A → 页面B:**
- 传递：`param1`（参数说明）
- 方式：路由参数

**从页面B → 返回页面A:**
- 需同步状态：字段1、字段2
- 方式：全局状态管理或事件回调

### 状态同步
操作成功后需要同步到：
- 当前页面显示
- 相关列表显示
- 全局缓存

---

## 异常处理

| 场景 | 前端处理方式 |
|-----|------------|
| 权限不足（403） | 显示："提示文字" |
| 资源不存在（404） | 显示："提示文字" |
| 参数错误（400） | 显示："提示文字" |
| 网络错误 | 显示："网络异常，请稍后重试" + 重试按钮 |
| 未登录（401） | 跳转登录页 |
| 服务器错误（500） | 显示："服务异常，请稍后重试" |
```

---

## 四、响应数据标准格式

### 标准结构
所有接口响应必须包含以下三个字段：

```typescript
{
  code: number;      // 状态码（200=成功，其他=失败）
  message: string;   // 提示信息
  data: any;         // 业务数据（可以是对象、数组、null）
}
```

### 成功响应示例

**单个对象:**
```typescript
{
  code: 200,
  message: "获取成功",
  data: {
    userId: 123,
    nickname: "张三",
    avatar: "https://..."
  }
}
```

**列表数据:**
```typescript
{
  code: 200,
  message: "获取成功",
  data: {
    total: 100,
    list: [
      { id: 1, name: "项目1" },
      { id: 2, name: "项目2" }
    ]
  }
}
```

**操作成功（无返回数据）:**
```typescript
{
  code: 200,
  message: "删除成功",
  data: null
}
```

### 错误响应示例

**参数错误:**
```typescript
{
  code: 400,
  message: "昵称长度必须在1-20字符之间",
  data: null
}
```

**未登录:**
```typescript
{
  code: 401,
  message: "请先登录",
  data: null
}
```

**权限不足:**
```typescript
{
  code: 403,
  message: "该内容仅本人可见",
  data: null
}
```

**资源不存在:**
```typescript
{
  code: 404,
  message: "用户不存在或已注销",
  data: null
}
```

**服务器错误:**
```typescript
{
  code: 500,
  message: "服务异常，请稍后重试",
  data: null
}
```

### 常用状态码

| 状态码 | 含义 | 前端处理 |
|-------|------|---------|
| 200 | 成功 | 正常处理业务逻辑 |
| 400 | 参数错误 | 显示具体错误提示 |
| 401 | 未登录 | 跳转登录页 |
| 403 | 权限不足 | 显示权限提示 |
| 404 | 资源不存在 | 显示不存在提示 |
| 409 | 冲突（如重复） | 显示冲突提示 |
| 413 | 请求体过大 | 显示大小限制提示 |
| 500 | 服务器错误 | 显示通用错误提示 |

---

## 五、编写步骤

### 步骤1：分析UI截图（5分钟）
- 列出所有页面
- 标注所有输入元素
- 标注所有按钮/操作
- 画出页面跳转关系

### 步骤2：识别接口触发点（5分钟）
- 找出所有"提交"类操作
- 判断是否需要调用接口
- 确定触发时机

**判断标准：**
- 用户点击提交按钮 → 需要接口
- 输入完成自动提交 → 需要接口
- 页面跳转不提交数据 → 不需要接口
- UI状态切换 → 不需要接口

### 步骤3：提取接口参数（10分钟）
- 参数来自哪个输入框
- 参数的数据类型
- 参数的验证规则

### 步骤4：编写文档（15分钟）
- 按功能模块组织
- 每个接口包含：操作、定义、验证、行为
- 添加汇总表
- 列出非接口操作

### 步骤5：检查完整性（5分钟）
- [ ] 所有接口都已提取
- [ ] 所有参数都已定义
- [ ] 所有验证规则都已说明
- [ ] 触发时机明确
- [ ] 格式统一

---

## 六、文档大小控制

### 单个模块文档建议
- **简单模块**（1-5个接口）：300-400行
- **中等模块**（6-10个接口）：500-650行
- **复杂模块**（11+个接口）：650-800行或拆分

### 拆分原则
当模块超过800行时，按以下维度拆分：
- 按业务流程拆分（如：用户模块 → 用户主页、资料编辑、技能管理）
- 按用户角色拆分（如：用户端、管理端）
- 按功能类型拆分（如：查看功能、编辑功能、管理功能）

### 文件组织
```
Action-API/
├── Auth/
│   ├── 登录模块接口文档.md          (约400行，6个接口)
│   └── 忘记密码流程接口文档.md      (约300行，4个接口)
├── Users/
│   ├── 用户主页接口文档.md          (约600行，11个接口)
│   ├── 个人资料编辑接口文档.md      (约650行，12个接口)
│   └── 技能管理接口文档.md          (约700行，11个接口)
└── Content/
    ├── 动态发布接口文档.md          (约500行，8个接口)
    └── 评论管理接口文档.md          (约400行，6个接口)
```

---

## 七、质量标准

### 必须包含（9个核心部分）
- [ ] **概述** - 一句话说明文档范围
- [ ] **功能章节** - 每个功能独立成章（一、二、三...）
- [ ] **用户操作** - 明确的操作步骤和触发时机
- [ ] **接口定义** - 方法、路径、参数、响应
- [ ] **前端验证** - 完整的验证规则
- [ ] **前端行为** - 成功/失败后的行为
- [ ] **接口汇总表** - 完整的接口清单
- [ ] **通用验证规则** - 跨接口的共同规则
- [ ] **非接口操作** - 明确列出纯前端交互
- [ ] **数据传递** - 跨页面数据流说明（如需要）
- [ ] **异常处理** - 错误场景和处理方式

### 必须清晰
- [ ] 一眼看出哪个操作触发哪个接口
- [ ] 参数来源明确（来自哪个输入框/选择器）
- [ ] 响应数据结构完整（包含code/message/data）
- [ ] 数据传递清晰（跨页面的数据如何保存）
- [ ] 验证规则具体（不能为空/长度X-Y/格式要求）
- [ ] 非接口操作明确列出

### 必须规范
- [ ] TypeScript格式定义参数
- [ ] 响应数据包含标准结构（code, message, data）
- [ ] 接口路径格式：`/api/模块/资源/操作`
- [ ] 方法使用RESTful规范（GET/POST/PUT/DELETE）
- [ ] 成功/失败行为分别说明
- [ ] 字符计数格式：X/Y字
- [ ] 错误码格式：（400）、（401）、（403）等

---

## 八、常见问题

### Q1: 如何判断是否需要独立接口？
**A:** 
- 用户点击提交/确认按钮 → 需要
- 输入完成自动提交 → 需要
- 仅页面跳转 → 不需要
- UI状态切换（显示/隐藏） → 不需要

### Q2: 复杂流程如何组织？
**A:** 
1. 先画流程图
2. 按步骤编号
3. 每步明确标注是否触发接口
4. 说明数据如何在步骤间传递

### Q3: 参数定义到什么程度？
**A:** 
- 只定义前端发送给后端的数据
- 不定义前端临时状态
- 不定义UI显示状态

### Q4: 文档太长怎么办？
**A:** 
- 超过300行立即拆分
- 按业务流程拆分
- 保持每个文档2-3页

---

## 九、实际示例文档

### 示例1：用户主页接口文档
**位置:** `Action-API/Users/用户主页接口文档.md`

**特点:**
- ✅ 11个接口（查看为主）
- ✅ 清晰的Tab页结构（动态/收藏/点赞/资料）
- ✅ 完整的列表加载策略（分页、下拉刷新、上拉加载）
- ✅ 互动功能接口（关注、点赞、收藏、评论）
- ✅ 权限判断说明（隐私设置）
- ✅ 数据格式规范（时间、距离、计数）
- ✅ 总长度约580行

### 示例2：个人资料编辑接口文档
**位置:** `Action-API/Users/个人资料编辑接口文档.md`

**特点:**
- ✅ 12个接口（编辑为主）
- ✅ 丰富的输入类型（文本、选择器、图片上传）
- ✅ 详细的验证规则（字符长度、范围、格式）
- ✅ 两种保存策略说明（实时保存 vs 统一保存）
- ✅ 图片上传优化建议
- ✅ 离开确认交互
- ✅ 总长度约650行

### 示例3：技能管理接口文档
**位置:** `Action-API/Users/技能管理接口文档.md`

**特点:**
- ✅ 11个接口（CRUD完整）
- ✅ 两种技能类型（线上/线下）
- ✅ 复杂的用户操作流程（流程图）
- ✅ 多步骤表单（选择技能→填写信息→设置参数）
- ✅ 段位选择器、时间选择器等交互细节
- ✅ 比较表格（线上 vs 线下技能）
- ✅ 总长度约710行

### 共同点
所有示例都包含：
1. **明确的概述**
2. **完整的9-11个功能章节**
3. **详细的接口汇总表**
4. **通用验证规则**
5. **非接口操作清单**
6. **数据传递说明**
7. **异常处理表格**

---

## 十、文档命名与组织

### 命名规范
```
[功能模块]接口文档.md
```

### 目录结构
```
Action-API/
├── Auth/                          # 认证授权模块
│   ├── 登录模块接口文档.md
│   ├── 注册模块接口文档.md
│   └── 忘记密码流程接口文档.md
├── Users/                         # 用户相关模块
│   ├── 用户主页接口文档.md
│   ├── 个人资料编辑接口文档.md
│   ├── 技能管理接口文档.md
│   └── 关注粉丝接口文档.md
├── Content/                       # 内容相关模块
│   ├── 动态发布接口文档.md
│   ├── 评论管理接口文档.md
│   └── 搜索功能接口文档.md
├── Trade/                         # 交易相关模块
│   ├── 订单管理接口文档.md
│   ├── 支付流程接口文档.md
│   └── 钱包管理接口文档.md
└── Message/                       # 消息相关模块
    ├── 聊天功能接口文档.md
    └── 通知管理接口文档.md
```

### 命名示例
- ✅ `用户主页接口文档.md` - 清晰明确
- ✅ `个人资料编辑接口文档.md` - 功能明确
- ✅ `技能管理接口文档.md` - 简洁直接
- ❌ `用户相关的一些接口.md` - 过于模糊
- ❌ `API文档v1.md` - 无具体功能

### 版本控制
- 日常更新：直接修改原文档
- 重大变更：使用Git提交记录变更
- 如需保留旧版：创建 `archive/` 目录存档

---

## 十一、总结与检查清单

### 核心要点
1. **一个功能模块 = 一个文档** - 独立完整，便于管理
2. **用户操作驱动** - 清晰的"操作 → 接口"映射
3. **结构完整统一** - 9个核心部分全部包含
4. **验证规则详细** - 具体到字符数、格式、范围
5. **响应结构规范** - 统一使用code/message/data
6. **异常处理完善** - 覆盖所有错误场景
7. **实际可落地** - 前端可直接按文档开发

### 文档完成度检查清单

#### 基础结构（必须）
- [ ] 标题格式：`# [模块名称]接口文档`
- [ ] 概述部分：一句话说明文档范围
- [ ] 功能章节：使用"一、二、三..."编号
- [ ] 接口汇总表：包含所有接口
- [ ] 通用验证规则：至少3-5条
- [ ] 非接口操作：明确列出
- [ ] 数据传递：说明跨页面数据流
- [ ] 异常处理表：覆盖常见错误

#### 每个功能章节（必须）
- [ ] 用户操作：步骤清晰，标注触发点
- [ ] 接口定义：方法+路径完整
- [ ] 参数定义：TypeScript格式
- [ ] 响应数据：包含code/message/data
- [ ] 前端验证：具体规则（不能为空/长度/格式）
- [ ] 前端行为：成功/失败分别说明

#### 验证规则细节（推荐）
- [ ] 文本输入：长度限制（X-Y字符）
- [ ] 图片上传：格式+大小+数量限制
- [ ] 数字输入：范围+整数/小数要求
- [ ] 选择器：选项来源+是否必选
- [ ] 日期时间：范围限制+格式要求
- [ ] 显示字符计数：X/Y字格式

#### 交互细节（推荐）
- [ ] 列表加载：首屏+下拉刷新+上拉加载
- [ ] 防抖处理：点赞/收藏等操作
- [ ] 确认对话框：删除/离开未保存等
- [ ] 进度显示：上传/加载过程
- [ ] Toast提示：成功/失败消息

#### 质量保证
- [ ] 文档长度：300-800行（单个模块）
- [ ] 接口数量：合理拆分（每个文档11个接口左右）
- [ ] 无冗余重复内容
- [ ] 错别字检查
- [ ] 格式统一（缩进、空行、标点）

### 文档价值
- ✅ **前端开发** - 快速查找接口，直接开发
- ✅ **后端开发** - 明确接口需求，减少沟通
- ✅ **新成员** - 快速了解系统功能
- ✅ **产品经理** - 验证功能实现是否完整
- ✅ **测试人员** - 编写测试用例的依据
- ✅ **项目管理** - 评估开发工作量

### 持续改进
- 定期review已完成的文档
- 根据实际开发反馈优化模板
- 补充新的最佳实践案例
- 保持文档与代码同步更新

