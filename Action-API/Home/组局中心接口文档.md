# 组局中心接口文档

## 概述
本文档定义组局中心功能的所有接口,包括活动列表、筛选、发布组局、报名参与、支付流程等用户操作触发时机和前端参数要求。组局中心是用户组织和参与线上线下活动的核心功能模块。

---

## 一、打开组局中心

### 用户操作
1. 用户在首页点击"组局中心"入口
2. **系统打开组局中心列表页** → 触发接口

### 接口定义
**接口:** `GET /api/activity/list`

**参数:**
```typescript
{
  pageNum: number;              // 页码(从1开始)
  pageSize: number;             // 每页数量(建议10)
  sortBy?: string;              // 排序方式(默认'smart')
  filters?: {
    gender?: 'all' | 'male' | 'female';     // 性别筛选
    memberCount?: string;       // 成员筛选
    activityType?: string[];    // 活动类型(探店、私影、台球等)
    cityCode?: string;          // 城市代码
    districtCode?: string;      // 区域代码
  };
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    total: number;
    hasMore: boolean;
    filters: {
      sortOptions: Array<{
        value: string;
        label: string;          // 如:'智能排序','最新发布','报名人数'
      }>;
      genderOptions: Array<{
        value: string;
        label: string;          // '不限性别','男','女'
      }>;
      memberOptions: Array<{
        value: string;
        label: string;          // '成员','2-5人','6-10人'等
      }>;
      activityTypes: Array<{
        value: string;
        label: string;          // '探店','私影','台球','K歌'等
        icon: string;           // 图标URL
      }>;
    };
    list: Array<{
      activityId: number;
      organizer: {
        userId: number;
        avatar: string;
        nickname: string;       // 如:'×购寿小时'
      };
      title?: string;           // 活动标题(可选)
      description?: string;     // 活动描述
      activityType: {
        type: string;           // 'explore','movie','billiards','ktv'等
        label: string;          // '探店','私影','台球','K歌'
        icon: string;
      };
      tags: Array<{
        text: string;           // 如:'可线上','2元'
        type: 'feature' | 'price';
        color?: string;
      }>;
      price: {
        amount: number;
        unit: 'per_person' | 'per_hour';
        displayText: string;    // 如:'300人/时'
      };
      schedule: {
        startTime: string;      // ISO时间格式
        displayText: string;    // 如:'6月09日08:00'
      };
      location: {
        address: string;        // 如:'××区黄精路×号6层蓝影·2 Room'
        district?: string;
        coordinates?: {
          latitude: number;
          longitude: number;
        };
      };
      participants: {
        registered: number;     // 已报名人数
        limit: number;          // 人数限制
        displayText: string;    // 如:'2人'
      };
      status: 'open' | 'full' | 'closed';  // 活动状态
      registrationDeadline: string;        // 报名截止时间
    }>;
  }
}
```

### 前端验证
- pageNum ≥ 1
- pageSize 范围:5-20

### 前端行为
- 显示组局中心标题和"发布组局"按钮
- 显示三个筛选下拉框(排序/性别/成员)
- 垂直列表展示活动卡片
- 每个活动卡片显示:
  - 组织者头像+昵称
  - 标签行
  - 价格(红色)
  - 时间
  - 地点
  - 参与人数
- 支持下拉刷新和上拉加载
- 点击活动卡片:跳转活动详情页

---

## 二、打开筛选页面

### 用户操作
1. 用户点击"成员"筛选按钮或筛选图标
2. **系统打开筛选面板** → 不触发接口,使用已有的filters数据

### 前端行为
- 显示筛选面板(底部弹出或全屏)
- 显示活动类型选项网格:
  - 变剧、密室、私影
  - 台球、K歌、唱歌
  - 嗨唱、K歌、唱吧
  - 按摩
- 每个选项显示为圆角矩形按钮
- 选中状态:紫色背景
- 未选中状态:灰色背景
- 支持多选
- 底部显示"重置"和"完成"按钮

---

## 三、应用筛选条件

### 用户操作
1. 用户在筛选面板选择活动类型
2. 用户点击"完成"按钮
3. **系统应用筛选并刷新列表** → 触发接口

### 接口定义
**接口:** `GET /api/activity/list`

**参数:**
```typescript
{
  pageNum: number;        // 重置为1
  pageSize: number;
  sortBy?: string;
  filters: {
    activityType: string[];   // 选中的活动类型数组
    gender?: string;
    memberCount?: string;
    // ... 其他筛选条件
  };
}
```

**响应数据:**
```typescript
{
  // 同"打开组局中心"接口
}
```

### 前端行为
- 关闭筛选面板
- 清空当前列表
- 重置pageNum=1
- 调用列表接口获取筛选后的数据
- 在筛选按钮上显示筛选数量角标(如:"3")
- 如果无结果:显示"暂无符合条件的活动"

---

## 四、打开发布组局页面

### 用户操作
1. 用户点击"发布组局"按钮
2. **系统打开发布组局页面** → 触发接口获取配置

### 接口定义
**接口:** `GET /api/activity/publish/config`

**参数:**
```typescript
{
  // 无参数
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    activityTypes: Array<{
      value: string;
      label: string;          // '探店','私影','台球','K歌','喝酒','按摩'
      icon: string;           // 图标URL
    }>;
    priceUnit: {
      options: Array<{
        value: string;
        label: string;        // '金币/小时','金币/人'等
      }>;
    };
    memberCountOptions: Array<{
      value: number;
      label: string;          // '2人','3人','4人'等
    }>;
    platformFee: {
      rate: number;           // 平台费率(如:0.05表示5%)
      description: string;    // 说明文字
    };
    depositRules: {
      depositAmount: number;  // 保证金金额
      description: string;    // 保证金说明
    };
  }
}
```

### 前端行为
- 显示"发布组局"标题和"取消"按钮
- 显示活动类型图标选择器(6种类型)
- 显示表单字段:
  - 添加标题(输入框)
  - 添加正文(多行文本+图片上传,字数:0/200)
  - 时间(选择器)
  - 地点(选择器)
  - 定价(选择器,显示"0金币/小时")
  - 人数(选择器)
  - 报名截止时间(选择器)
- 底部显示平台规则说明:
  - "发布后团局,平台会收取一定的下单费"
  - "组队成团后,因您的问题临时取消,则要扣除保证金"
  - "组队成团后,因达人爽约,则补偿您一定的保证金"
- 显示紫色"发布"按钮

---

## 五、上传活动图片

### 用户操作
1. 用户在发布页面点击图片上传区域的"+"按钮
2. **系统打开图片选择器** → 用户选择图片后上传

### 接口定义
**接口:** `POST /api/common/upload/image`

**参数:**
```typescript
{
  file: File;                 // 图片文件
  type: 'activity';           // 上传类型
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    imageUrl: string;         // 图片URL
    thumbnailUrl?: string;    // 缩略图URL(可选)
  }
}
```

### 前端验证
- 图片格式:jpg, jpeg, png, webp
- 图片大小:≤ 5MB
- 最多上传9张图片

### 前端行为
- 打开系统图片选择器
- 选择图片后显示上传进度
- 上传成功后显示图片缩略图
- 图片可删除和重新排序
- 达到9张时隐藏"+"按钮

---

## 六、发布组局(无需支付)

### 用户操作
1. 用户填写完所有必填信息
2. 用户点击"发布"按钮
3. **系统创建活动** → 触发接口

### 接口定义
**接口:** `POST /api/activity/publish`

**参数:**
```typescript
{
  activityType: string;       // 活动类型
  title: string;              // 活动标题
  content: string;            // 活动内容描述
  images?: string[];          // 图片URL数组(可选)
  schedule: {
    startTime: string;        // 活动开始时间(ISO格式)
    endTime?: string;         // 活动结束时间(可选)
  };
  location: {
    address: string;          // 地址
    coordinates?: {
      latitude: number;
      longitude: number;
    };
  };
  price: {
    amount: number;           // 价格
    unit: 'per_person' | 'per_hour';
  };
  memberLimit: number;        // 人数限制
  registrationDeadline: string;  // 报名截止时间
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    activityId: number;
    needPayment: boolean;     // 是否需要支付平台费
    paymentInfo?: {
      amount: number;         // 需支付金额
      platformFee: number;    // 平台费用
      deposit: number;        // 保证金
    };
  }
}
```

### 前端验证
- activityType:必选
- title:1-50字符
- content:0-200字符
- startTime:必须晚于当前时间
- location.address:必填
- price.amount:≥ 0
- memberLimit:2-100人
- registrationDeadline:必须早于startTime

### 前端行为
- 验证所有必填字段
- 如果needPayment=false:
  - 显示"发布成功"提示
  - 关闭发布页面
  - 跳转到活动详情页
- 如果needPayment=true:
  - 显示支付弹窗(见下一节)

---

## 七、发布组局-支付平台费

### 用户操作
1. 发布活动后系统显示支付弹窗
2. 用户查看支付金额和余额
3. 用户点击"立即支付"按钮
4. **系统执行支付** → 触发接口

### 接口定义
**接口:** `POST /api/activity/publish/pay`

**参数:**
```typescript
{
  activityId: number;         // 活动ID
  paymentMethod: 'balance' | 'alipay' | 'wechat';  // 支付方式
  amount: number;             // 支付金额
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    orderId: string;          // 订单ID
    paymentStatus: 'success' | 'pending' | 'failed';
    activityId: number;
    balance?: number;         // 支付后余额(如使用余额支付)
  }
}
```

### 前端验证
- 余额充足:balance ≥ amount
- 需要用户同意支付条款

### 前端行为
- **支付弹窗显示**:
  - 标题:"确认支付"
  - 支付金额(大号显示):"200金币"
  - 支付方式:金币(显示剩余余额:"剩余: 300")
  - 同意条款:复选框 + "我同意支付以下所示的总金额（含服务费）"
  - "立即支付"按钮(紫色)
- 点击支付:
  - 显示加载动画
  - 支付成功:
    - 显示"发布成功"提示
    - 关闭支付弹窗和发布页面
    - 跳转到活动详情页
  - 支付失败:
    - 显示错误提示
    - 保持在支付弹窗
- 余额不足:
  - 提示"余额不足,请先充值"
  - 提供充值入口

---

## 八、获取活动详情

### 用户操作
1. 用户在列表中点击活动卡片
2. **系统打开活动详情页** → 触发接口

### 接口定义
**接口:** `GET /api/activity/detail`

**参数:**
```typescript
{
  activityId: number;         // 活动ID
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    activityId: number;
    status: 'open' | 'full' | 'closed' | 'cancelled';
    organizer: {
      userId: number;
      avatar: string;
      nickname: string;       // 如:'昵称123'
      tags?: string[];        // 用户标签
      isVerified: boolean;
    };
    activityType: {
      type: string;
      label: string;
      icon: string;
    };
    title?: string;
    description: string;      // 活动描述
    images?: string[];        // 活动图片
    bannerImage?: string;     // 头图/封面图
    schedule: {
      startTime: string;
      endTime?: string;
      displayText: string;    // 如:'6月09日08:00'
    };
    location: {
      address: string;        // 如:'地址国号下东×路×号顶楼·CNE通影·2.3km'
      district?: string;
      coordinates?: {
        latitude: number;
        longitude: number;
      };
    };
    price: {
      amount: number;
      unit: string;
      displayText: string;    // 如:'30金币/人/小时'
    };
    participants: {
      registered: number;     // 已报名人数
      limit: number;          // 人数限制
      displayText: string;    // 如:'2人'
      list: Array<{           // 已报名用户列表
        userId: number;
        avatar: string;
        nickname: string;
        status: 'pending' | 'approved' | 'rejected';  // 报名状态
        statusLabel: string;  // '等待审核','报名成功','已拒绝'
      }>;
      waitingText?: string;   // 如:'等0名人报名...'
    };
    registrationDeadline: string;
    userStatus?: {            // 当前用户的状态(如已登录)
      isOrganizer: boolean;   // 是否是组织者
      hasRegistered: boolean; // 是否已报名
      registrationStatus?: 'pending' | 'approved' | 'rejected';
      canRegister: boolean;   // 是否可以报名
    };
  }
}
```

### 前端行为
- 显示活动详情页
- 顶部显示封面图/Banner
- 显示组织者信息(头像+昵称+标签)
- 显示活动描述
- 显示活动详细信息:
  - 时间
  - 地点
  - 价格
  - 人数限制
- 显示已报名用户头像列表
- 底部显示操作按钮:
  - 左侧:"☐ 贴贴"按钮(白色边框)
  - 右侧:根据状态显示不同按钮
    - 未报名:"☐ 报名"(紫色)
    - 报名审核中:"等待审核"(灰色)
    - 报名成功:"报名成功"(紫色)
    - 已满员:"已满员"(灰色,不可点击)

---

## 九、报名参加活动

### 用户操作
1. 用户在活动详情页点击"报名"按钮
2. **系统发起报名请求** → 触发接口

### 接口定义
**接口:** `POST /api/activity/register`

**参数:**
```typescript
{
  activityId: number;         // 活动ID
  message?: string;           // 报名留言(可选)
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    registrationId: number;
    status: 'pending' | 'approved';  // 报名状态
    needPayment: boolean;     // 是否需要支付
    paymentInfo?: {
      amount: number;         // 需支付金额
      description: string;    // 支付说明
    };
    approvalRequired: boolean;  // 是否需要组织者审核
  }
}
```

### 前端验证
- 需要登录状态
- 不能报名自己组织的活动
- 活动状态必须为'open'
- 未超过报名截止时间
- 未达到人数上限

### 前端行为
- 如果needPayment=false 且 approvalRequired=false:
  - 显示"报名成功"提示
  - 更新按钮状态为"报名成功"
  - 刷新已报名用户列表
- 如果needPayment=true:
  - 显示支付弹窗(见下一节)
- 如果approvalRequired=true:
  - 显示"等待队长是否通过你的报名申请"提示
  - 更新按钮状态为"等待审核"

---

## 十、报名支付

### 用户操作
1. 报名后系统显示支付弹窗
2. 用户查看支付金额和余额
3. 用户点击"立即支付"按钮
4. **系统执行报名支付** → 触发接口

### 接口定义
**接口:** `POST /api/activity/register/pay`

**参数:**
```typescript
{
  activityId: number;
  registrationId: number;     // 报名ID
  paymentMethod: 'balance' | 'alipay' | 'wechat';
  amount: number;
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    orderId: string;
    paymentStatus: 'success' | 'pending' | 'failed';
    registrationStatus: 'pending' | 'approved';
    balance?: number;         // 支付后余额
  }
}
```

### 前端验证
- 余额充足:balance ≥ amount
- 需要用户同意支付条款

### 前端行为
- **支付弹窗**:
  - 标题:"确认支付"
  - 显示支付金额:"200金币"
  - 显示余额:"剩余: 300"
  - 同意条款复选框
  - "立即支付"按钮
- 支付成功:
  - 显示"支付成功"提示
  - 关闭支付弹窗
  - 如果需要审核:显示"等待审核"
  - 如果自动通过:显示"报名成功"
  - 刷新活动详情
- 支付失败:
  - 显示错误提示
  - 保持在支付弹窗

---

## 十一、查看报名状态(组织者)

### 用户操作
1. 组织者打开自己发布的活动详情页
2. **系统显示报名用户列表** → 已在详情接口中返回

### 前端行为
- 显示已报名用户列表
- 每个用户显示:
  - 头像
  - 昵称
  - 报名状态标签:
    - "等待审核":灰色
    - "报名成功":紫色
    - "已拒绝":红色
- 组织者可以看到所有报名用户
- 普通用户只能看到已通过审核的用户

---

## 十二、审核报名(组织者)

### 用户操作
1. 组织者在报名用户列表中选择操作
2. 组织者点击"通过"或"拒绝"按钮
3. **系统处理审核** → 触发接口

### 接口定义
**接口:** `POST /api/activity/registration/approve`

**参数:**
```typescript
{
  activityId: number;
  registrationId: number;     // 报名ID
  action: 'approve' | 'reject';  // 审核操作
  reason?: string;            // 拒绝原因(如果action='reject')
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    registrationId: number;
    status: 'approved' | 'rejected';
    success: boolean;
  }
}
```

### 前端验证
- 只有组织者可以审核
- 只能审核'pending'状态的报名

### 前端行为
- 审核通过:
  - 更新用户状态标签为"报名成功"
  - 发送通知给报名用户
- 审核拒绝:
  - 更新用户状态标签为"已拒绝"
  - 发送通知给报名用户(包含拒绝原因)
- 实时更新已报名人数

---

## 十三、取消报名

### 用户操作
1. 用户在活动详情页点击"取消报名"按钮
2. **系统取消报名** → 触发接口

### 接口定义
**接口:** `POST /api/activity/register/cancel`

**参数:**
```typescript
{
  activityId: number;
  registrationId: number;
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    success: boolean;
    refundAmount?: number;    // 退款金额(如有支付)
    cancelPolicy: string;     // 取消政策说明
  }
}
```

### 前端验证
- 只能取消自己的报名
- 活动未开始
- 未超过取消截止时间

### 前端行为
- 显示取消确认对话框:
  - 标题:"确认取消报名?"
  - 说明:取消政策和可能的退款信息
  - 按钮:"取消" | "确定"
- 取消成功:
  - 显示"取消成功"提示
  - 更新按钮状态为"报名"
  - 刷新活动详情
  - 如果有退款:显示退款金额

---

## 十四、分享活动

### 用户操作
1. 用户在活动详情页点击"分享"按钮
2. **系统显示分享面板** → 可能触发接口生成分享链接

### 接口定义
**接口:** `POST /api/activity/share`

**参数:**
```typescript
{
  activityId: number;
  shareType: 'link' | 'image' | 'miniprogram';  // 分享类型
}
```

**响应数据:**
```typescript
{
  code: number;
  message: string;
  data: {
    shareUrl: string;         // 分享链接
    shareImage?: string;      // 分享图片(可选)
    shareText: string;        // 分享文案
    qrCode?: string;          // 二维码(可选)
  }
}
```

### 前端行为
- 显示分享面板
- 提供分享选项:
  - 复制链接
  - 分享到微信
  - 分享到朋友圈
  - 生成海报
- 记录分享事件(用于统计)

---

## 接口汇总

| # | 功能 | 用户操作 | 接口 | 方法 |
|---|------|---------|------|------|
| 1 | 获取活动列表 | 打开组局中心 | `/api/activity/list` | GET |
| 2 | 获取发布配置 | 打开发布页面 | `/api/activity/publish/config` | GET |
| 3 | 上传图片 | 上传活动图片 | `/api/common/upload/image` | POST |
| 4 | 发布活动 | 点击发布按钮 | `/api/activity/publish` | POST |
| 5 | 支付平台费 | 发布后支付 | `/api/activity/publish/pay` | POST |
| 6 | 获取活动详情 | 点击活动卡片 | `/api/activity/detail` | GET |
| 7 | 报名参加 | 点击报名按钮 | `/api/activity/register` | POST |
| 8 | 报名支付 | 报名后支付 | `/api/activity/register/pay` | POST |
| 9 | 审核报名 | 通过/拒绝报名 | `/api/activity/registration/approve` | POST |
| 10 | 取消报名 | 点击取消报名 | `/api/activity/register/cancel` | POST |
| 11 | 分享活动 | 点击分享按钮 | `/api/activity/share` | POST |

---

## 通用验证规则

### 登录状态
- 所有操作都需要登录状态
- 未登录时跳转登录页

### 活动发布
- 活动类型:必选(探店、私影、台球、K歌、喝酒、按摩)
- 标题:1-50字符
- 内容:0-200字符
- 图片:最多9张,单张≤5MB
- 开始时间:必须晚于当前时间至少1小时
- 报名截止时间:必须早于开始时间至少30分钟
- 人数限制:2-100人
- 价格:≥0金币

### 活动报名
- 不能报名自己组织的活动
- 活动状态为'open'
- 未超过报名截止时间
- 未达到人数上限
- 有足够余额(如需支付)

### 活动审核
- 只有组织者可以审核
- 只能审核'pending'状态的报名
- 审核决定不可撤销

### 取消报名
- 只能取消自己的报名
- 活动未开始
- 未超过取消截止时间(通常为活动开始前24小时)

### 支付规则
- 支付方式:余额、支付宝、微信
- 余额支付:余额必须充足
- 支付超时时间:5分钟
- 平台费用:发布活动时收取
- 保证金:发布活动时冻结,活动完成后退还

---

## 非接口操作

以下操作不触发接口调用(纯前端交互):

### 列表页面
- **下拉框展开/收起** - 点击筛选下拉框显示/隐藏选项
- **活动卡片显示** - 渲染活动信息
- **滚动加载** - 列表滚动交互

### 筛选页面
- **选项选择** - 点击活动类型切换选中状态
- **重置按钮** - 清空所有筛选条件
- **选中状态高亮** - 选中项显示紫色背景

### 发布页面
- **活动类型选择** - 点击图标选择活动类型
- **表单输入** - 输入标题、内容等
- **字符计数** - 实时显示输入字符数(0/200)
- **打开选择器** - 点击时间、地点等打开对应选择器
- **图片预览** - 显示已上传的图片缩略图
- **删除图片** - 删除已上传的图片

### 详情页面
- **图片轮播** - 活动图片轮播展示
- **地图显示** - 显示活动地点(如果有地图功能)
- **参与者头像滚动** - 横向滚动显示已报名用户头像
- **按钮状态切换** - 根据用户状态显示不同按钮

### 支付弹窗
- **显示/隐藏** - 支付弹窗的打开和关闭动画
- **同意条款** - 复选框状态切换
- **金额显示** - 格式化显示金额和余额

---

## 数据传递

### 列表页 → 详情页
**点击活动卡片传递:**
- activityId(活动ID)
- 方式:路由参数

### 发布页 → 支付弹窗 → 详情页
**发布流程传递:**
- activityId(创建的活动ID)
- paymentAmount(支付金额)
- 方式:状态管理

**支付成功后跳转:**
- activityId(活动ID)
- 方式:路由跳转

### 详情页 → 支付弹窗
**报名支付传递:**
- activityId(活动ID)
- registrationId(报名ID)
- paymentAmount(支付金额)
- 方式:组件props或状态管理

### 本地缓存
**需要缓存的数据:**
- 活动列表 - 会话级缓存,退出页面清除
- 筛选条件 - 会话级缓存,退出App清除
- 发布草稿 - 本地缓存7天,避免数据丢失
- 已查看的活动ID - 本地缓存30天,用于标记"已读"

### 状态同步
**操作后需要同步:**
- 发布活动:列表页新增活动
- 报名成功:详情页更新报名人数和状态
- 取消报名:详情页更新报名人数和状态
- 审核报名:详情页更新用户状态标签
- 支付成功:更新余额显示

---

## 异常处理

| 场景 | 前端处理方式 |
|-----|------------|
| 网络错误 | 显示:"网络异常,请稍后重试" + 重试按钮 |
| 服务器错误(500) | 显示:"服务异常,请稍后重试" |
| 接口超时 | 显示:"请求超时,请重试" |
| 未登录 | 提示:"请先登录" + 跳转登录页 |
| 活动已满员 | 提示:"活动已满员,报名已关闭" |
| 报名已截止 | 提示:"报名已截止,无法报名" |
| 余额不足 | 提示:"余额不足,请先充值" + 充值入口 |
| 支付失败 | 显示具体错误信息 + 重试按钮 |
| 活动已取消 | 提示:"该活动已被取消" |
| 发布失败 | 显示错误信息,保留已填写内容 |
| 图片上传失败 | 提示:"图片上传失败,请重试" |
| 审核失败 | 提示:"操作失败,请重试" |
| 重复报名 | 提示:"您已报名该活动" |
| 不能报名自己的活动 | 提示:"不能报名自己发布的活动" |

---

## 组局中心列表页详细说明

### 页面结构
- **顶部**: 返回按钮 + "组局中心"标题 + "发布组局"按钮(紫色文字)
- **筛选栏**: 三个下拉框(智能排序 | 不限性别 | 成员)
- **内容区**: 垂直滚动的活动卡片列表

### 活动卡片
**布局**:
- 左侧:组织者头像(圆形,约50x50)
- 右侧:活动信息

**活动信息**:
- **第一行**: 组织者昵称(如:"×购寿小时")
- **第二行**: 标签行(横向排列)
  - 特性标签(如:"可线上") - 绿色背景
  - 价格标签(如:"2元") - 橙色背景
- **第三行**: 价格(红色加粗,右对齐,如:"300 人/时")
- **第四行**: 时间图标 + 时间(如:"6月09日08:00 10-20岁限男性...")
- **第五行**: 地点图标 + 地点(如:"地址国号下东×路×号6层蓝影·2 Room")
- **第六行**: 参与人数(如:"2人")

### 交互
- 点击卡片:跳转活动详情页
- 下拉刷新:刷新列表
- 上拉加载:加载更多活动

---

## 筛选页面详细说明

### 页面结构
- 半屏或全屏弹窗
- 显示活动类型网格(3列布局)

### 活动类型选项
- **第一行**: 变剧, 密室, 私影
- **第二行**: 台球, K歌, 唱歌
- **第三行**: 嗨唱, K歌, 唱吧
- **第四行**: 按摩

### 按钮样式
- 未选中:浅灰色背景 + 黑色文字
- 选中:紫色背景 + 白色文字
- 圆角矩形

### 底部按钮
- **重置**: 白色背景 + 灰色边框
- **完成**: 紫色背景 + 白色文字

---

## 发布组局页面详细说明

### 页面结构
- **顶部**: "取消"按钮 + "发布组局"标题
- **活动类型区**: 6种类型图标网格(2行3列)
- **表单区**: 输入字段列表
- **底部**: 规则说明 + "发布"按钮

### 活动类型图标
- **探店**: 搜索/放大镜图标
- **私影**: 电影胶片图标
- **台球**: 台球杆和球图标
- **K歌**: 麦克风图标
- **喝酒**: 酒瓶图标
- **按摩**: 手掌图标

### 表单字段
1. **添加标题**:
   - 单行输入框
   - 占位符:"添加标题"
   - 最多50字符

2. **添加正文**:
   - 多行文本输入框
   - 图片上传区(+号按钮)
   - 字符计数:0/200
   - 支持换行

3. **时间**:
   - 点击打开时间选择器
   - 显示:"选择 >"
   - 选择后显示具体时间

4. **地点**:
   - 点击打开地点选择器
   - 显示:"选择 >"
   - 支持搜索和地图选择

5. **定价**:
   - 点击打开价格设置
   - 显示:"0金币/小时 >"
   - 可选单位:金币/小时、金币/人

6. **人数**:
   - 点击打开人数选择器
   - 显示:"选择 >"
   - 选项:2-100人

7. **报名截止时间**:
   - 点击打开时间选择器
   - 显示:"选择 >"
   - 必须早于活动开始时间

### 规则说明
- "发布后团局,平台会收取一定的下单费"
- "组队成团后,因您的问题临时取消,则要扣除保证金"
- "组队成团后,因达人爽约,则补偿您一定的保证金"

### 发布按钮
- 紫色渐变背景
- 白色文字:"发布"
- 图标:纸飞机/发送图标

---

## 支付弹窗详细说明

### 弹窗结构
- 从底部弹出或居中显示
- 圆角白色背景
- 右上角关闭按钮(×)

### 内容
1. **标题**: "确认支付"(居中,加粗)

2. **支付金额**:
   - 大号字体显示:"200金币"
   - 右对齐

3. **支付方式**:
   - 左侧:金币图标
   - 中间:"金币" + "剩余: 300"(灰色)
   - 右侧:紫色对勾(选中状态)

4. **同意条款**:
   - 紫色文字(可点击)
   - "我同意支付以下所示的总金额（含服务费）"

5. **支付按钮**:
   - 紫色渐变背景
   - 白色文字:"立即支付"
   - 全宽按钮

### 交互
- 点击关闭:取消支付,关闭弹窗
- 余额不足:支付按钮禁用,显示"余额不足"
- 未同意条款:支付按钮禁用
- 点击支付:显示加载动画,执行支付

---

## 活动详情页详细说明

### 页面结构
- **顶部**: 返回按钮 + "详情"标题
- **Hero区**: 活动封面图/Banner
- **组织者区**: 组织者信息
- **内容区**: 活动描述和详细信息
- **参与者区**: 已报名用户列表
- **底部**: 操作按钮

### Hero区
- 显示活动封面图或默认游戏图片
- 图片比例:16:9或类似
- 可能有轮播功能(如果有多张图片)

### 组织者区
- 头像(圆形) + 昵称
- 用户标签(如果有)
- 可点击跳转用户主页

### 内容区
- **活动描述**:
  - 多行文本显示
  - 支持展开/收起(如果文字过长)

- **活动详情**:
  - 时间图标 + 时间
  - 地点图标 + 地址
  - 价格图标 + 价格
  - 人数图标 + 人数限制

### 参与者区
- 标题:"等0名人报名..."或"已报名X人"
- 用户头像横向排列(圆形)
- 点击头像:查看用户信息或跳转用户主页

### 底部操作按钮
- **左侧按钮**: "☐ 贴贴"
  - 白色背景 + 紫色边框
  - 可能是收藏/关注功能

- **右侧按钮**(根据状态变化):
  - **未报名**: "☐ 报名"(紫色填充)
  - **审核中**: "等待审核"(灰色,不可点击)
  - **报名成功**: "报名成功"(紫色填充)
  - **已满员**: "已满员"(灰色,不可点击)

### 不同状态的详情页

**1. 默认状态(未报名)**:
- 显示"等0名人报名..."
- 按钮:"☐ 贴贴" | "☐ 报名"

**2. 等待审核状态**:
- 显示"等待队长是否通过你的报名申请"
- 按钮:"☐ 贴贴" | "等待审核"(灰色)

**3. 报名未成功(被拒绝)**:
- 显示已报名用户列表,包含被拒绝的用户
- 用户头像下显示状态标签
- 按钮:"☐ 贴贴" | "报名审核中"(灰色)

**4. 报名成功**:
- 显示已报名用户列表
- 自己的头像在列表中,显示"报名成功"标签
- 按钮:"☐ 贴贴" | "报名成功"(紫色)

---

## 性能优化建议

### 列表加载
- 分页加载:每页10-15条
- 图片懒加载:仅加载可见区域
- 图片压缩:缩略图使用小尺寸
- 骨架屏:加载时显示占位UI

### 发布功能
- 草稿保存:自动保存未发布的内容
- 图片压缩:上传前压缩图片
- 断点续传:大图片支持断点续传
- 表单验证:实时验证,减少提交失败

### 支付流程
- 支付状态轮询:定时查询支付结果
- 支付超时处理:5分钟超时自动取消
- 支付失败重试:提供重试入口

### 状态管理
- 活动详情缓存:缓存5分钟,减少重复请求
- 用户关系缓存:全局缓存关注状态
- 实时更新:报名人数实时更新

---

## 业务规则说明

### 活动发布规则
- 发布需要支付平台费用(金币)
- 平台费率:5-10%(根据活动类型)
- 需要缴纳保证金(金币)
- 保证金在活动完成后退还
- 活动取消:根据取消时间扣除相应费用

### 报名规则
- 报名可能需要支付费用
- 报名可能需要组织者审核
- 报名截止时间前可以报名
- 人数未满时可以报名
- 不能报名自己发布的活动

### 审核规则
- 组织者可以审核报名
- 审核通过:用户正式加入活动
- 审核拒绝:用户无法参加,费用退还
- 审核决定不可撤销

### 取消规则
- 用户取消报名:
  - 距离活动开始≥24小时:全额退款
  - 距离活动开始<24小时:扣除50%费用
  - 活动开始后:不可取消
- 组织者取消活动:
  - 提前24小时:全额退款给所有报名用户,扣除组织者保证金
  - 未提前24小时:全额退款+补偿,扣除组织者全部保证金

### 保证金规则
- 发布活动时冻结保证金
- 活动正常完成:保证金退还
- 组织者违约:扣除保证金,补偿给报名用户
- 参与者违约:无影响

---

## 测试要点

### 列表功能
- [ ] 组局中心列表正常显示
- [ ] 筛选功能正常工作
- [ ] 分页加载正常
- [ ] 点击活动跳转详情页

### 发布功能
- [ ] 发布页面正常打开
- [ ] 活动类型选择正常
- [ ] 表单填写和验证正常
- [ ] 图片上传功能正常
- [ ] 发布成功并显示支付弹窗
- [ ] 支付流程正常完成

### 报名功能
- [ ] 报名按钮正常显示
- [ ] 点击报名触发正确流程
- [ ] 需要支付时显示支付弹窗
- [ ] 需要审核时显示等待状态
- [ ] 报名成功后状态更新

### 审核功能
- [ ] 组织者可以看到所有报名
- [ ] 审核通过/拒绝正常工作
- [ ] 审核后状态正确更新
- [ ] 报名用户收到通知

### 支付功能
- [ ] 支付弹窗正确显示
- [ ] 余额显示正确
- [ ] 余额不足时提示充值
- [ ] 支付成功后状态更新
- [ ] 支付失败时可重试

### 边界测试
- [ ] 未登录时提示登录
- [ ] 余额不足时的处理
- [ ] 活动已满员时的提示
- [ ] 报名已截止时的提示
- [ ] 重复报名的处理
- [ ] 网络异常的错误处理

### 兼容性测试
- [ ] 不同活动类型正常显示
- [ ] 不同状态的详情页正确显示
- [ ] 图片上传和显示正常
- [ ] 支付流程在不同场景下正常工作

---
