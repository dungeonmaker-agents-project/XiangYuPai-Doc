# 人气推荐功能 - 简化版

## 功能概述
简单的人气用户标记功能，允许管理员快速将用户设置为"人气用户"并添加推荐标签，用于前端推荐展示。

## 更新日期
2025-11-12

## 功能特性

### 1. 快速操作按钮
- **位置**：用户列表操作列最前面
- **图标**：⭐ StarFilled（红色星星）
- **功能**：点击打开人气推荐设置弹窗

### 2. 简化设置弹窗

**包含字段：**
1. **用户信息展示**
   - 头像
   - 昵称
   - 用户ID

2. **设为人气用户**
   - 开关按钮（是/否）
   - 红色高亮

3. **推荐标签**（仅当开启人气用户时显示）
   - 多选下拉框
   - 最多3个标签
   - 预设选项：
     - 热门推荐
     - 精选达人
     - 品质保证
     - 人气王
     - 新星推荐
   - 支持自定义输入
   - 可搜索筛选

### 3. 列表展示

**昵称列：**
```
张三 [🌟 人气]
```
- 人气用户显示红色徽章

**认证状态列：**
```
[实名] [大神] [VIP3] [人气]
```

**搜索筛选：**
- 新增"人气用户"筛选条件
- 选项：是/否/全部

### 4. 操作列布局

**宽度：** 240px

**按钮顺序：**
```
[⭐人气推荐] [👁查看] [✏编辑] [🗑删除]
```

## 数据存储

### 存储字段
- `isPopular` (Boolean) - 是否人气用户
- `certificationTags` (Array) - 认证标签数组（包含推荐标签）

### 示例数据
```json
{
  "userId": 1987741160776421378,
  "nickname": "张三",
  "isPopular": true,
  "certificationTags": ["热门推荐", "精选达人"]
}
```

## 使用流程

### 设置人气用户
1. 在用户列表中找到目标用户
2. 点击操作列的"⭐人气推荐"按钮
3. 在弹窗中：
   - 开启"设为人气用户"开关
   - 选择1-3个推荐标签（可选）
4. 点击"确定"保存

### 取消人气用户
1. 点击"⭐人气推荐"按钮
2. 关闭"设为人气用户"开关
3. 点击"确定"保存

### 筛选人气用户
1. 在搜索表单中
2. 选择"人气用户" = "是"
3. 点击"搜索"

## API接口

### 更新用户
**端点：** `PUT /xypai-user/api/v1/user/{userId}`

**请求：**
```json
{
  "userId": 1987741160776421378,
  "isPopular": true,
  "certificationTags": ["热门推荐", "精选达人"]
}
```

**响应：**
```json
{
  "code": 200,
  "message": "人气推荐设置成功"
}
```

### 查询人气用户
**端点：** `GET /xypai-user/api/v1/user/list?isPopular=true`

## 前端使用

### 获取人气用户列表
```typescript
// 查询参数
const queryParams = {
  isPopular: true,
  pageNum: 1,
  pageSize: 10
};

// 调用API
const result = await api.listUserProfile(queryParams);
```

### 显示推荐标签
```vue
<template>
  <div v-if="user.isPopular">
    <el-tag 
      v-for="tag in user.certificationTags" 
      :key="tag"
      type="danger"
      size="small"
    >
      {{ tag }}
    </el-tag>
  </div>
</template>
```

## 后续扩展

当需要更多功能时，可以添加：
- 推荐优先级（排序权重）
- 特惠折扣设置
- 限时推荐（时间范围）
- 推荐理由文本
- 推荐位置设置

## 技术实现

### 前端文件
- `XiangYuPai-Admin/src/views/xypai/user-profile/index.vue`
- `XiangYuPai-Admin/src/api/xypai/user-profile/types.ts`

### 后端文件
- `UserQueryDTO.java` - 添加 isPopular 查询参数
- `UserUpdateDTO.java` - 支持更新 isPopular 和 certificationTags
- `UserServiceImpl.java` - 添加 isPopular 过滤条件

### 数据库字段
- `user.is_popular` (TINYINT) - 是否人气用户
- `user.certification_tags` (JSON) - 认证标签数组

## 注意事项

1. **标签数量限制**：最多3个，避免前端显示混乱
2. **标签存储**：使用 certificationTags 字段，与其他认证标签共用
3. **前端展示**：人气用户在推荐位置优先展示
4. **权限控制**：需要相应的管理权限才能设置

## 相关文档
- [用户身份信息编辑功能增强](./用户身份信息编辑功能增强.md)
- [用户不存在问题修复](./用户不存在问题修复.md)
