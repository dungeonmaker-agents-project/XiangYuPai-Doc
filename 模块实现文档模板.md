# 模块实现文档模板 v2.1

> **文档定位**: 通用模板，适用于任何项目
> **使用方式**: 先生成「项目实现文档」，再用于代码生成

---

## 目录

- [如何使用本模板](#如何使用本模板)
- [第一部分：项目适配](#第一部分项目适配)
- [第二部分：文档规范](#第二部分文档规范)
- [第三部分：前端实现](#第三部分前端实现)
- [第四部分：后端实现](#第四部分后端实现)

---

# 如何使用本模板

## 使用前必须确认

在使用本模板生成模块代码前，请先回答以下问题：

```
┌─────────────────────────────────────────────────────────────────────┐
│  请选择生成模式：                                                     │
│                                                                     │
│  [A] 依赖现有项目                                                    │
│      - 模块将集成到现有项目中                                         │
│      - 需要继承项目的基类、复用公共组件                                 │
│      - 需要符合项目的命名规范和API规范                                 │
│                                                                     │
│  [B] 独立生成                                                        │
│      - 模块独立生成在根目录                                           │
│      - 不依赖任何现有项目                                             │
│      - 使用标准/自定义规范                                            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 模式A：依赖现有项目

需要提供以下信息：

| 必填信息 | 说明 | 示例 |
|---------|------|------|
| 前端项目路径 | 前端代码根目录 | `E:/Projects/MyApp-Frontend` |
| 后端项目路径 | 后端代码根目录 | `E:/Projects/MyApp-Backend` |
| 参考模块 | 1-2个现有模块用于分析规范 | `Homepage`, `User` |

**流程**：分析现有模块 → 生成项目实现文档 → 生成模块代码

### 模式B：独立生成

需要提供以下信息：

| 必填信息 | 说明 | 示例 |
|---------|------|------|
| 输出根目录 | 代码生成位置 | `E:/Output/MyModule` |
| 技术栈选择 | 前后端技术栈 | 前端RN/后端Spring Boot |

**流程**：确认技术栈 → 使用默认规范生成项目实现文档 → 生成模块代码

---

## 生成流程

```
┌─────────────────────────────────────────────────────────────────────┐
│  STEP 0: 确认生成模式                                                │
│  ─────────────────────                                              │
│                                                                     │
│  问题1: 是否需要集成到现有项目？                                       │
│         [A] 是 - 提供项目路径和参考模块                                │
│         [B] 否 - 独立生成到指定目录                                   │
│                                                                     │
│  问题2: (模式A) 请提供项目信息                                        │
│         - 前端项目路径: _______________                               │
│         - 后端项目路径: _______________                               │
│         - 参考模块名称: _______________                               │
│                                                                     │
│  问题2: (模式B) 请提供输出信息                                        │
│         - 输出根目录: _______________                                 │
│         - 前端技术栈: _______________                                 │
│         - 后端技术栈: _______________                                 │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
                                 ↓
┌─────────────────────────────────────────────────────────────────────┐
│  STEP 1: 生成「项目实现文档」                                         │
│  ─────────────────────────────                                      │
│                                                                     │
│  模式A: 分析现有模块，提取规范，填充第一部分占位符                       │
│  模式B: 使用默认规范或用户指定规范，填充第一部分占位符                    │
│                                                                     │
│  输出: {项目名}_实现文档.md                                           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
                                 ↓
┌─────────────────────────────────────────────────────────────────────┐
│  STEP 2: 生成模块代码                                                │
│  ─────────────────────                                              │
│                                                                     │
│  输入:                                                               │
│  ├── {项目名}_实现文档.md                                             │
│  └── UI结构文档 (STEP 1-6)                                           │
│                                                                     │
│  输出:                                                               │
│  ├── 模式A: 集成到项目的 src/modules/ 或 src/main/java/               │
│  └── 模式B: 输出到 {根目录}/src-frontend/ 和 {根目录}/src-backend/    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 提示词模板

### STEP 0 提示词（启动）

```
我需要使用《模块实现文档模板》生成模块代码。

请先确认：
1. 是否需要集成到现有项目？
2. 如需集成，请提供项目路径和参考模块
3. 如独立生成，请提供输出目录和技术栈偏好
```

### STEP 1 提示词（模式A - 依赖项目）

```
请分析以下现有项目，生成项目实现文档：

前端项目路径：{path}
后端项目路径：{path}
参考模块：{module1}, {module2}

请基于《模块实现文档模板 v2.1》，填充第一部分「项目适配」，
输出「{项目名}_实现文档.md」。

重点提取：
1. 技术栈及版本（从 package.json / pom.xml）
2. 公共基类/组件的具体名称和用法
3. 命名规范（从现有代码推断）
4. API路径规范
5. 数据库字段规范
```

### STEP 1 提示词（模式B - 独立生成）

```
请生成独立的项目实现文档：

输出根目录：{path}
前端技术栈：{React Native + Expo / Vue / React / ...}
后端技术栈：{Spring Boot / NestJS / ...}

请基于《模块实现文档模板 v2.1》，使用标准规范填充第一部分，
输出「{项目名}_实现文档.md」。
```

### STEP 2 提示词

```
请根据以下文档生成模块代码：

项目实现文档：{项目名}_实现文档.md
UI结构文档：{页面}_结构文档.md

生成模式：{A-集成到项目 / B-独立生成}
输出位置：{项目路径 / 根目录}

输出要求：
1. 前端代码放在 {前端目录}
2. 后端代码放在 {后端目录}
3. 必须生成快速理解.md、gateway配置、对接文档
4. 代码必须继承/使用实现文档中指定的基类和组件
```

---

# 第一部分：项目适配

> **说明**: 以下为占位符，需根据现有模块填充具体值

## 1.1 技术栈版本

### 前端
| 技术 | 版本 | 用途 |
|------|------|------|
| {框架} | {version} | 跨平台框架 |
| {构建工具} | {version} | 开发工具链 |
| {路由库} | {version} | 路由导航 |
| {类型系统} | {version} | 类型检查 |
| {状态管理} | {version} | 状态管理 |
| {列表组件} | {version} | 高性能列表 |

### 后端
| 技术 | 版本 | 用途 |
|------|------|------|
| {语言} | {version} | 运行时 |
| {框架} | {version} | 应用框架 |
| {ORM} | {version} | 数据访问 |
| {RPC框架} | {version} | 服务调用 |
| {数据库} | {version} | 数据存储 |
| {缓存} | {version} | 缓存服务 |
| {网关} | {version} | API网关 |
| {配置中心} | {version} | 配置管理 |

## 1.2 公共组件

### 前端公共组件
| 组件/工具 | 路径 | 用途 | 使用方式 |
|----------|------|------|---------|
| {通用组件} | `{path}` | {用途} | `{import语句}` |
| {通用Hooks} | `{path}` | {用途} | `{import语句}` |
| {工具函数} | `{path}` | {用途} | `{import语句}` |
| {API封装} | `{path}` | {用途} | `{import语句}` |

### 后端公共组件
| 组件 | 所在模块 | 用途 | 使用方式 |
|------|---------|------|---------|
| {实体基类} | `{module}` | 实体基类 | `extends {ClassName}` |
| {控制器基类} | `{module}` | 控制器基类 | `extends {ClassName}` |
| {响应包装} | `{module}` | 统一响应 | `{ClassName}.ok(data)` |
| {分页查询} | `{module}` | 分页参数 | `extends {ClassName}` |
| {分页响应} | `{module}` | 分页响应 | `{ClassName}` |
| {安全工具} | `{module}` | 获取用户 | `{ClassName}.getUserId()` |
| {日志注解} | `{module}` | 操作日志 | `@{AnnotationName}` |

## 1.3 命名规范

### 前端命名
| 类型 | 规范 | 示例 |
|------|------|------|
| 模块目录 | {规范} | `{示例}` |
| 组件文件 | {规范} | `{示例}` |
| Store文件 | {规范} | `{示例}` |
| 类型文件 | {规范} | `{示例}` |
| Hook文件 | {规范} | `{示例}` |

### 后端命名
| 类型 | 规范 | 示例 |
|------|------|------|
| 模块目录 | {规范} | `{示例}` |
| Entity | {规范} | `{示例}` |
| DTO | {规范} | `{示例}` |
| VO | {规范} | `{示例}` |
| Service接口 | {规范} | `{示例}` |
| Service实现 | {规范} | `{示例}` |
| Controller | {规范} | `{示例}` |
| Mapper | {规范} | `{示例}` |

### 数据库命名
| 类型 | 规范 | 示例 |
|------|------|------|
| 表名 | {规范} | `{示例}` |
| 字段名 | {规范} | `{示例}` |
| 主键 | {规范} | `{示例}` |
| 外键字段 | {规范} | `{示例}` |

## 1.4 API路径规范

| 操作 | 方法 | 路径模式 | 示例 |
|------|------|---------|------|
| 列表查询 | {METHOD} | `{pattern}` | `{示例}` |
| 详情查询 | {METHOD} | `{pattern}` | `{示例}` |
| 新增 | {METHOD} | `{pattern}` | `{示例}` |
| 修改 | {METHOD} | `{pattern}` | `{示例}` |
| 删除 | {METHOD} | `{pattern}` | `{示例}` |
| 特殊操作 | {METHOD} | `{pattern}` | `{示例}` |

## 1.5 数据库字段规范

| 字段 | 类型 | 说明 | 必须 |
|------|------|------|------|
| `{主键字段}` | {类型} | 主键 | ✅ |
| `{创建时间}` | {类型} | 创建时间 | ✅ |
| `{更新时间}` | {类型} | 更新时间 | ✅ |
| `{逻辑删除}` | {类型} | 逻辑删除 | {是否必须} |
| `{乐观锁}` | {类型} | 乐观锁 | {是否必须} |
| `{租户ID}` | {类型} | 租户ID | {是否必须} |

## 1.6 数据源配置

> {描述数据源配置方式，如：由Nacos配置、独立数据库、多数据源等}

## 1.7 Gateway配置模板

```yaml
# {说明}
{gateway配置模板，从现有配置提取}
```

---

# 第二部分：文档规范

## 2.1 必须输出的文档

| 文档 | 位置 | 说明 |
|------|------|------|
| 前端快速理解.md | `src-frontend/modules/{Module}/` | 模块说明 |
| 后端快速理解.md | `src-backend/{module}/` | 模块说明 |
| 对接文档.md | 根目录 | 集成指南 |
| gateway配置 | `src-backend/{module}/config/` | 网关路由 |

## 2.2 快速理解文档章节

### 前端
| 章节 | 内容 |
|------|------|
| 核心定位 | 模块职责 |
| 主要功能 | 功能列表 |
| 技术栈 | 库和版本 |
| 目录结构 | 文件组织 |
| 页面导航 | 路由 + 跳转图 |
| **已对接API** | 前端方法 ↔ 后端接口 |
| 架构设计 | 数据流图 |
| 快速启动 | 导入 + 依赖 |

### 后端
| 章节 | 内容 |
|------|------|
| 核心定位 | 服务职责 |
| 主要功能 | 功能列表 |
| 技术栈 | 框架和中间件 |
| 目录结构 | 文件组织 |
| **已对接API** | REST API 定义 |
| 数据库设计 | 表关系 + 核心表 |
| **POM依赖** | 额外Maven依赖 |
| Gateway配置 | 路由说明 |
| 快速启动 | 部署步骤 |

## 2.3 对接文档章节

| 章节 | 说明 |
|------|------|
| 项目结构总览 | 前后端目录树 |
| 前端集成指南 | 依赖、代码、路由、环境 |
| 后端集成指南 | 模块、SQL、RPC、Gateway |
| API接口对照表 | 完整对应关系 |
| Gateway配置 | 可复制的配置 |
| 常见问题 | FAQ |

---

# 第三部分：前端实现

## 3.1 实现流程

```
Phase 1: 分析
├── 阅读 UI 结构文档 STEP 1-6
├── 提取数据模型
└── 确认 API 接口

Phase 2: 实现
├── types/index.ts
├── stores/{module}Store.ts
├── api/index.ts (已对接 + Mock)
├── components/
├── {PageName}/index.tsx
├── utils/index.ts
└── index.ts

Phase 3: 文档
└── 快速理解.md
```

## 3.2 目录结构

```
src-frontend/modules/{Module}/
├── index.ts                  # 模块入口
├── 快速理解.md                # ⭐ 必须
├── types/index.ts
├── api/index.ts              # ⭐ 已对接API
├── stores/{module}Store.ts
├── utils/index.ts
├── components/
│   ├── index.ts
│   ├── {Component}/index.tsx
│   ├── Skeleton/index.tsx
│   ├── EmptyState/index.tsx
│   └── ErrorBoundary/index.tsx
└── {PageName}/index.tsx
```

## 3.3 实现要求

| 要求 | 说明 |
|------|------|
| 复用公共组件 | 使用 1.2 中定义的组件 |
| 遵循命名规范 | 使用 1.3 中定义的规范 |
| API已对接 | 真实API + Mock，非占位 |
| 接口注释 | 标注对应后端路径 |

## 3.4 质量检查

- [ ] 类型与 STEP 1 数据模型对应
- [ ] 复用了公共组件（1.2）
- [ ] 命名符合规范（1.3）
- [ ] API 已对接后端
- [ ] API 包含 Mock 数据
- [ ] 已生成快速理解.md

---

# 第四部分：后端实现

## 4.1 实现流程

```
Phase 1: 分析
├── 阅读 UI 结构文档 STEP 1-6
├── 提取数据模型
└── 确认 API 接口

Phase 2: 实现
├── domain/entity/
├── domain/dto/
├── domain/vo/
├── mapper/
├── service/
├── controller/
└── sql/schema.sql

Phase 3: 配置
└── config/gateway.yml

Phase 4: 文档
└── 快速理解.md
```

## 4.2 目录结构

```
src-backend/{module}/
├── 快速理解.md                # ⭐ 必须
├── controller/
│   └── {Module}Controller.java
├── service/
│   ├── I{Module}Service.java
│   └── impl/
│       └── {Module}ServiceImpl.java
├── mapper/
│   └── {Entity}Mapper.java
├── domain/
│   ├── entity/{Entity}.java
│   ├── dto/{Query}DTO.java
│   └── vo/{Item}VO.java
├── sql/
│   └── schema.sql
└── config/
    └── gateway.yml            # ⭐ 网关配置
```

## 4.3 实现要求

| 层级 | 要求 |
|------|------|
| Entity | 继承 1.2 中的实体基类，字段与 STEP 6 表结构一致 |
| DTO | 分页查询继承 1.2 中的分页基类 |
| Controller | 继承 1.2 中的控制器基类，使用响应包装 |
| Service | 按 1.2 中的RPC方式暴露（如有） |
| Mapper | 使用条件构造器 |
| SQL | 包含 1.5 中的系统字段 |
| Gateway | 使用 1.7 中的配置模板 |

## 4.4 质量检查

- [ ] Entity 继承基类（1.2）
- [ ] Controller 继承基类，使用响应包装（1.2）
- [ ] Entity 字段与 STEP 6 表结构一致
- [ ] DTO/VO 与 STEP 6 接口定义对应
- [ ] API路径符合规范（1.4）
- [ ] SQL包含系统字段（1.5）
- [ ] Service 按规范暴露
- [ ] 已生成 gateway 配置
- [ ] 快速理解.md 包含 POM 依赖
- [ ] 已生成快速理解.md

---

# 附录：生成场景

## 场景A：新模块

```
输入: UI结构文档 + 本项目实现文档
输出: 符合规范的可移植模块代码
```

## 场景B：旧模块标准化

```
输入: 现有模块代码 + 本项目实现文档
输出: 标准化代码 + 补充文档 + 迁移说明(如有)

步骤:
1. 对比现有代码与规范的差异
2. 补充缺失的快速理解.md
3. 补充缺失的 gateway 配置
4. 调整不符合规范的部分（评估影响）
5. 输出迁移说明（如有破坏性变更）
```

---

*模板版本: v2.1 | 更新日期: 2025-12-01*
